[0m15:15:04.153250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e808ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52cd11630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52cd115d0>]}


============================== 15:15:04.157310 | c777b3d6-ec87-49ed-96ff-3fe3843a3280 ==============================
[0m15:15:04.157310 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:15:04.158972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:15:04.531722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd529a94be0>]}
[0m15:15:04.598354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd529a31c60>]}
[0m15:15:04.611855 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:15:04.629064 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:15:04.632368 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:15:04.633280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd521b5c310>]}
[0m15:15:05.744564 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'load_taxi_trips' in the 'models' section of file 'models/01. sources/schema.yml'
[0m15:15:05.921286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:15:05.934817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52d908790>]}
[0m15:15:06.058429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5201608e0>]}
[0m15:15:06.059332 [info ] [MainThread]: Found 1 model, 1 source, 408 macros
[0m15:15:06.060071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd520162c20>]}
[0m15:15:06.062074 [info ] [MainThread]: 
[0m15:15:06.063317 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:15:06.064753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:15:06.117201 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:15:06.118687 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:15:06.119734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:06.141366 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:15:06.143667 [debug] [ThreadPool]: On list_dev: Close
[0m15:15:06.149060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:15:06.150637 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:15:06.159167 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:06.160800 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:15:06.161868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:06.174239 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:15:06.176285 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:06.177291 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:15:06.178494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:15:06.179438 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:06.180154 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:15:06.181756 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:15:06.182958 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:15:06.183886 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:06.184700 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:15:06.185569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:15:06.186215 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:15:06.190299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:15:06.196928 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:15:06.198342 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:15:06.199435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:06.210643 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:15:06.211839 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:15:06.212773 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:15:06.231013 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:15:06.233252 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:15:06.235265 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:15:06.236158 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:15:06.240258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5134fcf40>]}
[0m15:15:06.241696 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:06.243024 [debug] [MainThread]: On master: BEGIN
[0m15:15:06.243928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:06.254287 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m15:15:06.255337 [debug] [MainThread]: On master: COMMIT
[0m15:15:06.256025 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:06.256570 [debug] [MainThread]: On master: COMMIT
[0m15:15:06.257363 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:15:06.257888 [debug] [MainThread]: On master: Close
[0m15:15:06.260532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:06.261498 [info ] [MainThread]: 
[0m15:15:06.265601 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:15:06.266491 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:15:06.267578 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:15:06.268218 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:15:06.277866 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:15:06.293267 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:15:06.331099 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:15:06.345952 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:15:06.346901 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:15:06.347485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:06.361186 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:15:06.362891 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:15:06.364298 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
"dev"."raw_data"."taxi_trips"
  );

[0m15:15:06.401787 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
"dev"."raw_data"."taxi_trips"
  );

[0m15:15:06.403211 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:15:06.404321 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: ROLLBACK
[0m15:15:06.411950 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.load_bike_trips'
[0m15:15:06.413163 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:15:06.419593 [debug] [Thread-1 (]: Runtime Error in model load_bike_trips (models/01. sources/load_bike_trips.sql)
  Catalog Error: Table with name taxi_trips does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 33: "dev"."raw_data"."taxi_trips"
           ^
[0m15:15:06.422545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c777b3d6-ec87-49ed-96ff-3fe3843a3280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52ccd5660>]}
[0m15:15:06.424471 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.load_bike_trips ...................... [[31mERROR[0m in 0.15s]
[0m15:15:06.425968 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:15:06.428887 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:06.430423 [debug] [MainThread]: On master: BEGIN
[0m15:15:06.431403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:06.443278 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m15:15:06.444923 [debug] [MainThread]: On master: COMMIT
[0m15:15:06.445791 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:06.446569 [debug] [MainThread]: On master: COMMIT
[0m15:15:06.447861 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:15:06.448914 [debug] [MainThread]: On master: Close
[0m15:15:06.453307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:06.455999 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:15:06.457592 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:15:06.458630 [info ] [MainThread]: 
[0m15:15:06.459522 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:15:06.460655 [debug] [MainThread]: Command end result
[0m15:15:06.516350 [info ] [MainThread]: 
[0m15:15:06.518017 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:06.518878 [info ] [MainThread]: 
[0m15:15:06.519738 [error] [MainThread]:   Runtime Error in model load_bike_trips (models/01. sources/load_bike_trips.sql)
  Catalog Error: Table with name taxi_trips does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 33: "dev"."raw_data"."taxi_trips"
           ^
[0m15:15:06.520446 [info ] [MainThread]: 
[0m15:15:06.521137 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:06.522564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4363434, "process_user_time": 2.934173, "process_kernel_time": 0.139722, "process_mem_max_rss": "165880", "process_in_blocks": "80288", "process_out_blocks": "32", "command_success": false}
[0m15:15:06.523628 [debug] [MainThread]: Command `dbt run` failed at 15:15:06.523521 after 2.44 seconds
[0m15:15:06.524350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52e808ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52d90b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5134386d0>]}
[0m15:15:06.525208 [debug] [MainThread]: Flushing usage events
[0m15:16:12.940837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0876d2cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08751ad660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08751ad600>]}


============================== 15:16:12.943626 | 449d73ad-76c2-4f1a-9c8c-b82f3b9e192e ==============================
[0m15:16:12.943626 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:16:12.944763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:13.146109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0876b61ed0>]}
[0m15:16:13.205459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08753a5d80>]}
[0m15:16:13.207546 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:16:13.217742 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:16:13.400685 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:16:13.402708 [debug] [MainThread]: Partial parsing: added file: taxis_chicago://models/01. sources/sources.yml
[0m15:16:13.741012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:16:13.754940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0863993fa0>]}
[0m15:16:13.860535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0869d3f160>]}
[0m15:16:13.861537 [info ] [MainThread]: Found 1 model, 1 source, 408 macros
[0m15:16:13.862459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0869d3e860>]}
[0m15:16:13.864925 [info ] [MainThread]: 
[0m15:16:13.866159 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:16:13.867588 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:16:14.025363 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:16:14.026941 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:16:14.028159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:14.041810 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:16:14.044850 [debug] [ThreadPool]: On list_dev: Close
[0m15:16:14.051083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:16:14.052625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:16:14.061128 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:16:14.062502 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:16:14.063319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:14.076702 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:16:14.079243 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:16:14.080538 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:16:14.081967 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:16:14.083033 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:16:14.083746 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:16:14.084682 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:16:14.086087 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:16:14.087024 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:16:14.087824 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:16:14.088687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:16:14.089578 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:16:14.094583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:16:14.102006 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:16:14.103288 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:16:14.105190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:14.118916 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:16:14.120503 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:16:14.121574 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:16:14.137499 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:16:14.140251 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:16:14.141607 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:16:14.142781 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:16:14.148568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0869da8520>]}
[0m15:16:14.150495 [debug] [MainThread]: Using duckdb connection "master"
[0m15:16:14.151296 [debug] [MainThread]: On master: BEGIN
[0m15:16:14.151989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:14.165565 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m15:16:14.167290 [debug] [MainThread]: On master: COMMIT
[0m15:16:14.168381 [debug] [MainThread]: Using duckdb connection "master"
[0m15:16:14.169213 [debug] [MainThread]: On master: COMMIT
[0m15:16:14.170197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:16:14.171126 [debug] [MainThread]: On master: Close
[0m15:16:14.174478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:14.176038 [info ] [MainThread]: 
[0m15:16:14.179752 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:16:14.181357 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:16:14.182421 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:16:14.183088 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:16:14.194560 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:16:14.203146 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:16:14.242342 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:16:14.251788 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:16:14.253562 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:16:14.254628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:16:14.267417 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m15:16:14.269513 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:16:14.270853 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
"dev"."raw_data"."taxi_trips"
  );

[0m15:16:14.284834 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
"dev"."raw_data"."taxi_trips"
  );

[0m15:16:14.286548 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:16:14.287956 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: ROLLBACK
[0m15:16:14.290698 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.load_bike_trips'
[0m15:16:14.291826 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:16:14.297796 [debug] [Thread-1 (]: Runtime Error in model load_bike_trips (models/01. sources/load_bike_trips.sql)
  Catalog Error: Table with name taxi_trips does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 33: "dev"."raw_data"."taxi_trips"
           ^
[0m15:16:14.300838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '449d73ad-76c2-4f1a-9c8c-b82f3b9e192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0876da18a0>]}
[0m15:16:14.302525 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.load_bike_trips ...................... [[31mERROR[0m in 0.12s]
[0m15:16:14.304096 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:16:14.307211 [debug] [MainThread]: Using duckdb connection "master"
[0m15:16:14.308530 [debug] [MainThread]: On master: BEGIN
[0m15:16:14.309460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:14.322109 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m15:16:14.324009 [debug] [MainThread]: On master: COMMIT
[0m15:16:14.324953 [debug] [MainThread]: Using duckdb connection "master"
[0m15:16:14.325690 [debug] [MainThread]: On master: COMMIT
[0m15:16:14.326686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:16:14.327480 [debug] [MainThread]: On master: Close
[0m15:16:14.333494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:14.334916 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:16:14.336014 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:16:14.336880 [info ] [MainThread]: 
[0m15:16:14.338025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:16:14.339498 [debug] [MainThread]: Command end result
[0m15:16:14.397449 [info ] [MainThread]: 
[0m15:16:14.398996 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:16:14.399717 [info ] [MainThread]: 
[0m15:16:14.400640 [error] [MainThread]:   Runtime Error in model load_bike_trips (models/01. sources/load_bike_trips.sql)
  Catalog Error: Table with name taxi_trips does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 33: "dev"."raw_data"."taxi_trips"
           ^
[0m15:16:14.401298 [info ] [MainThread]: 
[0m15:16:14.402055 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:16:14.403541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5240304, "process_user_time": 2.26907, "process_kernel_time": 0.100847, "process_mem_max_rss": "166328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:16:14.404544 [debug] [MainThread]: Command `dbt run` failed at 15:16:14.404445 after 1.53 seconds
[0m15:16:14.405579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0876d2cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0876bccfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0869d3e920>]}
[0m15:16:14.406570 [debug] [MainThread]: Flushing usage events
[0m15:17:43.791313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246cff8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246b4c16c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246b4c1660>]}


============================== 15:17:43.794195 | f25574d2-1e41-40fd-baf4-27e46ed4a4be ==============================
[0m15:17:43.794195 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:17:43.794939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:17:43.994659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246ce85f30>]}
[0m15:17:44.060657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2468292500>]}
[0m15:17:44.062249 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:17:44.072616 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:17:44.233301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:44.235188 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/01. sources/sources.yml
[0m15:17:44.595154 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:17:44.609073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245de6c0a0>]}
[0m15:17:44.710904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246004aec0>]}
[0m15:17:44.711911 [info ] [MainThread]: Found 1 model, 1 source, 408 macros
[0m15:17:44.712846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2460048be0>]}
[0m15:17:44.715211 [info ] [MainThread]: 
[0m15:17:44.716529 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:17:44.718031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:17:44.818383 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:17:44.819803 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:17:44.820678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:44.836136 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:17:44.838880 [debug] [ThreadPool]: On list_dev: Close
[0m15:17:44.843949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:17:44.845219 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:17:44.852942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:44.854315 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:17:44.855440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:44.867525 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:17:44.870344 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:44.871551 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:17:44.872945 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:44.873669 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:44.874382 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:17:44.875609 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:17:44.876741 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:17:44.877406 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:44.877959 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:17:44.879158 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:44.879837 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:17:44.883374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:17:44.889480 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:17:44.891024 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:17:44.892286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:44.904268 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:17:44.905617 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:17:44.906659 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:17:44.922864 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:17:44.925275 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:17:44.926728 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:17:44.927723 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:17:44.932133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245df20e20>]}
[0m15:17:44.933839 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:44.936221 [debug] [MainThread]: On master: BEGIN
[0m15:17:44.937264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:44.948588 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m15:17:44.950204 [debug] [MainThread]: On master: COMMIT
[0m15:17:44.951468 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:44.952354 [debug] [MainThread]: On master: COMMIT
[0m15:17:44.953169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:17:44.953801 [debug] [MainThread]: On master: Close
[0m15:17:44.956770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:44.957768 [info ] [MainThread]: 
[0m15:17:44.961054 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:17:44.962490 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:17:44.963856 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:17:44.964634 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:17:44.973041 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:17:44.979801 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:17:45.018859 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:17:45.027987 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:17:45.028763 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:17:45.029763 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:45.040693 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:17:45.041931 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:17:45.042613 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
"dev"."dev"."taxi_trips"
  );

[0m15:17:45.056202 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
"dev"."dev"."taxi_trips"
  );

[0m15:17:45.058183 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:17:45.059340 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: ROLLBACK
[0m15:17:45.061548 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.load_bike_trips'
[0m15:17:45.062671 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:17:45.068016 [debug] [Thread-1 (]: Runtime Error in model load_bike_trips (models/01. sources/load_bike_trips.sql)
  Catalog Error: Table with name taxi_trips does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 33: "dev"."dev"."taxi_trips"
           ^
[0m15:17:45.071448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f25574d2-1e41-40fd-baf4-27e46ed4a4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24600a82e0>]}
[0m15:17:45.072776 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.load_bike_trips ...................... [[31mERROR[0m in 0.11s]
[0m15:17:45.073896 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:17:45.076679 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:45.077410 [debug] [MainThread]: On master: BEGIN
[0m15:17:45.078060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:45.087397 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m15:17:45.088735 [debug] [MainThread]: On master: COMMIT
[0m15:17:45.089772 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:45.090443 [debug] [MainThread]: On master: COMMIT
[0m15:17:45.091172 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:17:45.091700 [debug] [MainThread]: On master: Close
[0m15:17:45.094488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:45.095213 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:17:45.096309 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:17:45.097053 [info ] [MainThread]: 
[0m15:17:45.097899 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:17:45.098933 [debug] [MainThread]: Command end result
[0m15:17:45.146203 [info ] [MainThread]: 
[0m15:17:45.147781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:17:45.148568 [info ] [MainThread]: 
[0m15:17:45.149326 [error] [MainThread]:   Runtime Error in model load_bike_trips (models/01. sources/load_bike_trips.sql)
  Catalog Error: Table with name taxi_trips does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 33: "dev"."dev"."taxi_trips"
           ^
[0m15:17:45.149930 [info ] [MainThread]: 
[0m15:17:45.150564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:17:45.151655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.422242, "process_user_time": 2.331103, "process_kernel_time": 0.11853, "process_mem_max_rss": "168632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:45.152398 [debug] [MainThread]: Command `dbt run` failed at 15:17:45.152312 after 1.42 seconds
[0m15:17:45.153068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f246cff8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245deb0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245de415a0>]}
[0m15:17:45.154079 [debug] [MainThread]: Flushing usage events
[0m15:21:08.442453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ae7f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8accf96f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8accf9690>]}


============================== 15:21:08.446023 | 4aa3fb33-e534-4d54-8f98-d7f690658d53 ==============================
[0m15:21:08.446023 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:21:08.447571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:21:08.661786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a9a422f0>]}
[0m15:21:08.725990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a9a1b220>]}
[0m15:21:08.728264 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:21:08.740767 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:21:08.924086 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m15:21:08.926269 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/01. sources/load_bike_trips.sql
[0m15:21:09.157358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:21:09.164768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a175e380>]}
[0m15:21:09.254238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a1746b00>]}
[0m15:21:09.255150 [info ] [MainThread]: Found 1 model, 408 macros
[0m15:21:09.255817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a1746c80>]}
[0m15:21:09.257634 [info ] [MainThread]: 
[0m15:21:09.258535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:09.260076 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:21:09.291815 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:21:09.294582 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:21:09.295945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:09.308510 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:21:09.311065 [debug] [ThreadPool]: On list_dev: Close
[0m15:21:09.316083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:21:09.317211 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:21:09.382054 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:09.383586 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:21:09.384599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:09.396131 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:21:09.398298 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:09.399113 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:21:09.400446 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:09.401105 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:09.401783 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:21:09.403307 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:21:09.404474 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:21:09.405044 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:09.405875 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:21:09.406722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:09.407648 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:21:09.411978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:21:09.417950 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:21:09.419029 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:21:09.420132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:09.430858 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:21:09.431919 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:21:09.432932 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:21:09.450417 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:21:09.452679 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:21:09.454192 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:21:09.455192 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:21:09.460211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a19b9e40>]}
[0m15:21:09.461794 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:09.462508 [debug] [MainThread]: On master: BEGIN
[0m15:21:09.463394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:09.472392 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m15:21:09.473820 [debug] [MainThread]: On master: COMMIT
[0m15:21:09.474894 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:09.475442 [debug] [MainThread]: On master: COMMIT
[0m15:21:09.476255 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:21:09.476856 [debug] [MainThread]: On master: Close
[0m15:21:09.479613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:09.480488 [info ] [MainThread]: 
[0m15:21:09.482805 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:21:09.483611 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:21:09.484690 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:21:09.485427 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:21:09.492792 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:21:09.499785 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:21:09.534950 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:21:09.543167 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:09.544149 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:21:09.544875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:09.559796 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:21:09.561829 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:09.562819 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
read_csv_auto('./bronze/chicago_taxi/taxi_trips/2023-01-01/chicago_taxi_data_20230101.csv')
  );

[0m15:21:09.611751 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m15:21:09.620281 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:09.621706 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m15:21:09.623102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:21:09.636875 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:21:09.638247 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:09.639446 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:21:09.656300 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:21:09.665552 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:09.667223 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m15:21:09.669159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:21:09.672639 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:21:09.685142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aa3fb33-e534-4d54-8f98-d7f690658d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ae68a620>]}
[0m15:21:09.686943 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.20s]
[0m15:21:09.688574 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:21:09.690862 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:09.691603 [debug] [MainThread]: On master: BEGIN
[0m15:21:09.692211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:09.705695 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m15:21:09.707178 [debug] [MainThread]: On master: COMMIT
[0m15:21:09.708121 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:09.709074 [debug] [MainThread]: On master: COMMIT
[0m15:21:09.712682 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:21:09.713585 [debug] [MainThread]: On master: Close
[0m15:21:09.717969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:09.719125 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:21:09.720182 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:21:09.721233 [info ] [MainThread]: 
[0m15:21:09.722156 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m15:21:09.723534 [debug] [MainThread]: Command end result
[0m15:21:09.780881 [info ] [MainThread]: 
[0m15:21:09.782548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:09.783738 [info ] [MainThread]: 
[0m15:21:09.784470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:09.785845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4064097, "process_user_time": 2.126609, "process_kernel_time": 0.149761, "process_mem_max_rss": "175792", "process_in_blocks": "1120", "process_out_blocks": "0"}
[0m15:21:09.786735 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:09.786623 after 1.41 seconds
[0m15:21:09.787549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ae7f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8af2f9f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a9a1b220>]}
[0m15:21:09.788349 [debug] [MainThread]: Flushing usage events
[0m15:21:53.537023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c673ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c4c2bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c4c2bbb0>]}


============================== 15:21:53.540628 | 664fb457-b896-4834-96e1-cdd27f08852e ==============================
[0m15:21:53.540628 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:21:53.542040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:21:53.764210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c610b400>]}
[0m15:21:53.827917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9b78460>]}
[0m15:21:53.830735 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:21:53.844878 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:21:54.008241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:54.010024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:54.017172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:21:54.046335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b988dff0>]}
[0m15:21:54.158283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9888a30>]}
[0m15:21:54.159144 [info ] [MainThread]: Found 1 model, 408 macros
[0m15:21:54.160193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9888be0>]}
[0m15:21:54.162143 [info ] [MainThread]: 
[0m15:21:54.163118 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:54.164561 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:21:54.198370 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:21:54.200850 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:21:54.201679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:54.225081 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m15:21:54.228736 [debug] [ThreadPool]: On list_dev: Close
[0m15:21:54.237807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:21:54.240319 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:21:54.248419 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:54.250086 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:21:54.251289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:54.260984 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m15:21:54.263083 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:54.263674 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:21:54.264491 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:54.265036 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:54.265564 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:21:54.266430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:54.267454 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:21:54.267976 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:54.268679 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:21:54.269621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:54.270231 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:21:54.273328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:21:54.280546 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:21:54.281865 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:21:54.282738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:54.294285 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:21:54.295376 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:21:54.296127 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:21:54.311668 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:21:54.314231 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:21:54.315729 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:21:54.317143 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:21:54.322536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b8c93c40>]}
[0m15:21:54.324390 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:54.325685 [debug] [MainThread]: On master: BEGIN
[0m15:21:54.326719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:54.339629 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m15:21:54.341183 [debug] [MainThread]: On master: COMMIT
[0m15:21:54.342532 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:54.343696 [debug] [MainThread]: On master: COMMIT
[0m15:21:54.345245 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:21:54.346164 [debug] [MainThread]: On master: Close
[0m15:21:54.350503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:54.351844 [info ] [MainThread]: 
[0m15:21:54.356780 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:21:54.358240 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:21:54.359606 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:21:54.360288 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:21:54.368638 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:21:54.374470 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:21:54.411424 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:21:54.419021 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:54.419817 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:21:54.420501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:54.431399 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:21:54.432429 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:54.433178 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
read_csv_auto('./bronze/chicago_taxi/taxi_trips/2023-01-01/chicago_taxi_data_20230101.csv')
  );

[0m15:21:54.464495 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m15:21:54.473788 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:54.475004 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m15:21:54.476364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:21:54.490375 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:21:54.491537 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:54.492493 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:21:54.508129 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:21:54.515271 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:21:54.516304 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m15:21:54.517748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:21:54.521212 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:21:54.534117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '664fb457-b896-4834-96e1-cdd27f08852e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b8c85a80>]}
[0m15:21:54.536230 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.17s]
[0m15:21:54.537640 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:21:54.540591 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:54.541622 [debug] [MainThread]: On master: BEGIN
[0m15:21:54.542497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:54.557508 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m15:21:54.558937 [debug] [MainThread]: On master: COMMIT
[0m15:21:54.559708 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:54.560374 [debug] [MainThread]: On master: COMMIT
[0m15:21:54.561769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:21:54.562742 [debug] [MainThread]: On master: Close
[0m15:21:54.567248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:54.569943 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:21:54.570575 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:21:54.571152 [info ] [MainThread]: 
[0m15:21:54.571854 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:21:54.573043 [debug] [MainThread]: Command end result
[0m15:21:54.618251 [info ] [MainThread]: 
[0m15:21:54.619523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:54.620717 [info ] [MainThread]: 
[0m15:21:54.621430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:54.622481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1492453, "process_user_time": 1.921711, "process_kernel_time": 0.162684, "process_mem_max_rss": "159900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:54.623292 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:54.623181 after 1.15 seconds
[0m15:21:54.623974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c673ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c5f81540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b98a70a0>]}
[0m15:21:54.624836 [debug] [MainThread]: Flushing usage events
[0m15:22:37.939536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d69e0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4ee1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4ee1630>]}


============================== 15:22:37.943711 | 67d9d06c-e579-4571-9299-848e7bc58c96 ==============================
[0m15:22:37.943711 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:22:37.945342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:38.170367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9d99210>]}
[0m15:22:38.233916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d4ee18a0>]}
[0m15:22:38.236457 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:22:38.248698 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:22:38.413736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:38.415639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:38.422920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:22:38.446685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9aa6050>]}
[0m15:22:38.558916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9d2b700>]}
[0m15:22:38.560125 [info ] [MainThread]: Found 1 model, 408 macros
[0m15:22:38.561046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9d2a260>]}
[0m15:22:38.563527 [info ] [MainThread]: 
[0m15:22:38.565098 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:22:38.566729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:22:38.609502 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:22:38.611431 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:22:38.612528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:38.639333 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m15:22:38.642468 [debug] [ThreadPool]: On list_dev: Close
[0m15:22:38.648959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:22:38.650624 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:22:38.659886 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:22:38.661475 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:22:38.662796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:38.677126 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:22:38.680553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:22:38.681513 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:22:38.682871 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:22:38.683726 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:22:38.684505 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:22:38.685541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:22:38.687212 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:22:38.688275 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:22:38.689378 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:22:38.690507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:22:38.691404 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:22:38.696768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:22:38.703936 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:22:38.705456 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:22:38.706727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:38.719402 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:22:38.720884 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:22:38.722337 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:22:38.742244 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:22:38.745421 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:22:38.746923 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:22:38.748000 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:22:38.753403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c9acfd90>]}
[0m15:22:38.755349 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:38.756207 [debug] [MainThread]: On master: BEGIN
[0m15:22:38.757007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:38.769335 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m15:22:38.770911 [debug] [MainThread]: On master: COMMIT
[0m15:22:38.771876 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:38.772579 [debug] [MainThread]: On master: COMMIT
[0m15:22:38.773786 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:22:38.774460 [debug] [MainThread]: On master: Close
[0m15:22:38.779414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:38.780841 [info ] [MainThread]: 
[0m15:22:38.784683 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:22:38.786011 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:22:38.787164 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:22:38.788155 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:22:38.799205 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:22:38.808238 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:22:38.850388 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:22:38.860377 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:22:38.861462 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:22:38.862703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:38.876814 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:22:38.878769 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:22:38.880040 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location

FROM 
read_csv_auto('./bronze/chicago_taxi/taxi_trips/2023-01-01/chicago_taxi_data_20230101.csv')
  );

[0m15:22:38.912030 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m15:22:38.921843 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:22:38.923454 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m15:22:38.925203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:22:38.940022 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:22:38.941439 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:22:38.942522 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:22:38.960004 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:22:38.966920 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:22:38.968234 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m15:22:38.969822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:22:38.973590 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:22:38.986963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67d9d06c-e579-4571-9299-848e7bc58c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98c8d325f0>]}
[0m15:22:38.988932 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.20s]
[0m15:22:38.990531 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:22:38.992823 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:38.993627 [debug] [MainThread]: On master: BEGIN
[0m15:22:38.994302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:39.009021 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m15:22:39.010661 [debug] [MainThread]: On master: COMMIT
[0m15:22:39.013421 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:39.014217 [debug] [MainThread]: On master: COMMIT
[0m15:22:39.015803 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:22:39.016542 [debug] [MainThread]: On master: Close
[0m15:22:39.021154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:39.023002 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:22:39.024055 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:22:39.025309 [info ] [MainThread]: 
[0m15:22:39.026482 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m15:22:39.027729 [debug] [MainThread]: Command end result
[0m15:22:39.086326 [info ] [MainThread]: 
[0m15:22:39.088009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:39.089615 [info ] [MainThread]: 
[0m15:22:39.090754 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:39.092338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2140751, "process_user_time": 1.946461, "process_kernel_time": 0.168825, "process_mem_max_rss": "165856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:39.093378 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:39.093269 after 1.22 seconds
[0m15:22:39.094308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d69e0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d67ca770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d5ad9060>]}
[0m15:22:39.095111 [debug] [MainThread]: Flushing usage events
[0m15:29:54.848152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0513ea4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05123a1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05123a1630>]}


============================== 15:29:54.852001 | ca31c9da-bf69-4fa2-9491-cd52883f7105 ==============================
[0m15:29:54.852001 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:29:54.852845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:55.120277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f050f109210>]}
[0m15:29:55.185426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05123a18a0>]}
[0m15:29:55.198127 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:29:55.215160 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:29:55.400051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:55.401650 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/01. sources/load_bike_trips.sql
[0m15:29:55.624117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:29:55.629225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0504d31c30>]}
[0m15:29:55.735098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0506f42bc0>]}
[0m15:29:55.735972 [info ] [MainThread]: Found 1 model, 408 macros
[0m15:29:55.736676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0506f42a70>]}
[0m15:29:55.738769 [info ] [MainThread]: 
[0m15:29:55.739896 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:29:55.741184 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:29:55.782767 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:29:55.784429 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:29:55.785592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:55.811301 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:29:55.814180 [debug] [ThreadPool]: On list_dev: Close
[0m15:29:55.822885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:29:55.824737 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:29:56.003080 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:56.005302 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:29:56.006369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:56.032534 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:29:56.035353 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:56.036880 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:29:56.038169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:29:56.039152 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:56.039854 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:29:56.041898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:29:56.044119 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:29:56.045144 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:56.046356 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:29:56.047570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:29:56.048562 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:29:56.054661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:29:56.062255 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:29:56.063762 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:29:56.064742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:56.077780 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:29:56.079469 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:29:56.080578 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:29:56.101018 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:29:56.103946 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:29:56.106486 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:29:56.107735 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:29:56.113894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0506f9d570>]}
[0m15:29:56.115573 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:56.116439 [debug] [MainThread]: On master: BEGIN
[0m15:29:56.117536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:56.127704 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m15:29:56.129076 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.130009 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:56.130621 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.131382 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:29:56.131917 [debug] [MainThread]: On master: Close
[0m15:29:56.135032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:56.136194 [info ] [MainThread]: 
[0m15:29:56.138771 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:29:56.139956 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:29:56.141046 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:29:56.141744 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:29:56.149388 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:29:56.156791 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:29:56.194576 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:29:56.204376 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:29:56.205729 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:29:56.206382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:56.220270 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:29:56.222044 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:29:56.222967 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m15:29:56.305932 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m15:29:56.314827 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:29:56.316260 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m15:29:56.317944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:29:56.332799 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:29:56.334690 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:29:56.335962 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:29:56.354154 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m15:29:56.363264 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:29:56.364801 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m15:29:56.366677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:29:56.370949 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:29:56.383557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca31c9da-bf69-4fa2-9491-cd52883f7105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0513d365c0>]}
[0m15:29:56.386037 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.24s]
[0m15:29:56.387609 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:29:56.390218 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:56.390879 [debug] [MainThread]: On master: BEGIN
[0m15:29:56.391621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:56.406134 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m15:29:56.408200 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.409362 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:56.410153 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.411426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:29:56.412311 [debug] [MainThread]: On master: Close
[0m15:29:56.417092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:56.417873 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:29:56.418577 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:29:56.419700 [info ] [MainThread]: 
[0m15:29:56.420698 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m15:29:56.421894 [debug] [MainThread]: Command end result
[0m15:29:56.479473 [info ] [MainThread]: 
[0m15:29:56.480781 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:56.481568 [info ] [MainThread]: 
[0m15:29:56.482314 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:29:56.483784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6958916, "process_user_time": 2.217221, "process_kernel_time": 0.267254, "process_mem_max_rss": "166976", "process_in_blocks": "11376", "process_out_blocks": "0"}
[0m15:29:56.484838 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:56.484701 after 1.70 seconds
[0m15:29:56.485653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0513ea4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0506fa3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0506ff6c50>]}
[0m15:29:56.486434 [debug] [MainThread]: Flushing usage events
[0m15:33:46.989254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5adb00ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5abf8d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5abf8d600>]}


============================== 15:33:46.993532 | ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e ==============================
[0m15:33:46.993532 [info ] [MainThread]: Running with dbt=1.8.4
[0m15:33:46.994838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:33:47.264113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5ad941ed0>]}
[0m15:33:47.325883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5ac185d80>]}
[0m15:33:47.338913 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m15:33:47.353819 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m15:33:47.548271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:47.549999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:47.557205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m15:33:47.581942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a0b96020>]}
[0m15:33:47.705818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a0b93760>]}
[0m15:33:47.706742 [info ] [MainThread]: Found 1 model, 408 macros
[0m15:33:47.707584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a0b90af0>]}
[0m15:33:47.709694 [info ] [MainThread]: 
[0m15:33:47.710845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:33:47.712452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:33:47.752746 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:33:47.754265 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:33:47.755208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:47.776138 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:33:47.778044 [debug] [ThreadPool]: On list_dev: Close
[0m15:33:47.781711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:33:47.782536 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:33:47.790022 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:47.791142 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:33:47.792448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:47.804880 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:33:47.807200 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:47.808507 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:33:47.810153 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:33:47.811047 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:47.812068 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:33:47.813638 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:47.815079 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:33:47.815922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:33:47.816914 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:33:47.817947 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:33:47.818888 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:33:47.822962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:33:47.829074 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:33:47.830368 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:33:47.831459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:47.842444 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:33:47.843634 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:33:47.844610 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:33:47.864562 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:33:47.867147 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:33:47.869164 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:33:47.870011 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:33:47.874463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe59bea3c40>]}
[0m15:33:47.875817 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:47.876947 [debug] [MainThread]: On master: BEGIN
[0m15:33:47.877951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:47.890302 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m15:33:47.891447 [debug] [MainThread]: On master: COMMIT
[0m15:33:47.892300 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:47.892891 [debug] [MainThread]: On master: COMMIT
[0m15:33:47.893650 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:33:47.894362 [debug] [MainThread]: On master: Close
[0m15:33:47.897173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:47.898218 [info ] [MainThread]: 
[0m15:33:47.901677 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m15:33:47.902915 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m15:33:47.904192 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m15:33:47.904962 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m15:33:47.913413 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m15:33:47.923290 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m15:33:47.962163 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m15:33:47.970999 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:33:47.972064 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m15:33:47.973048 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:47.988337 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:33:47.990517 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:33:47.991747 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m15:33:48.097233 [debug] [Thread-1 (]: SQL status: OK in 0.104 seconds
[0m15:33:48.105818 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:33:48.107318 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips" rename to "load_bike_trips__dbt_backup"
[0m15:33:48.109105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:33:48.113475 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:33:48.114888 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m15:33:48.116171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:33:48.131749 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:33:48.133529 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:33:48.134747 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m15:33:48.152194 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:33:48.159469 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m15:33:48.160692 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m15:33:48.163975 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:33:48.167088 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m15:33:48.179293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae201fb2-0aa4-43dd-b4e2-0b9fb96f919e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5ad942590>]}
[0m15:33:48.180859 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.27s]
[0m15:33:48.182272 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m15:33:48.184050 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:48.184613 [debug] [MainThread]: On master: BEGIN
[0m15:33:48.185138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:48.196946 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m15:33:48.198300 [debug] [MainThread]: On master: COMMIT
[0m15:33:48.199452 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:48.200440 [debug] [MainThread]: On master: COMMIT
[0m15:33:48.201539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:33:48.202189 [debug] [MainThread]: On master: Close
[0m15:33:48.208190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:48.209855 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:33:48.210998 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m15:33:48.212163 [info ] [MainThread]: 
[0m15:33:48.213684 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:33:48.215439 [debug] [MainThread]: Command end result
[0m15:33:48.377324 [info ] [MainThread]: 
[0m15:33:48.378608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:48.379465 [info ] [MainThread]: 
[0m15:33:48.380640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:33:48.381974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4577872, "process_user_time": 2.031321, "process_kernel_time": 0.147911, "process_mem_max_rss": "161844", "process_in_blocks": "11032", "process_out_blocks": "0"}
[0m15:33:48.382827 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:48.382733 after 1.46 seconds
[0m15:33:48.383665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5adb00ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a0d55db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a0baf9a0>]}
[0m15:33:48.384353 [debug] [MainThread]: Flushing usage events
[0m12:33:41.029800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a9504b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a79b56f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a79b5690>]}


============================== 12:33:41.033368 | f8eb2805-ca71-4d0e-b1cb-95ae56920e92 ==============================
[0m12:33:41.033368 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:33:41.034178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:41.332359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c9262f0>]}
[0m12:33:41.390894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c8ff220>]}
[0m12:33:41.403214 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:33:41.414503 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:33:41.608413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:41.610352 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/01. sources/load_bike_trips.sql
[0m12:33:41.846204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:33:41.851691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039a439c90>]}
[0m12:33:41.950435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c6647f0>]}
[0m12:33:41.951569 [info ] [MainThread]: Found 1 model, 408 macros
[0m12:33:41.952506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c667a30>]}
[0m12:33:41.954396 [info ] [MainThread]: 
[0m12:33:41.955250 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:33:41.956524 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:33:42.007558 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:33:42.008996 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:33:42.010230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:42.031740 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:33:42.034900 [debug] [ThreadPool]: On list_dev: Close
[0m12:33:42.039731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:33:42.040659 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:33:42.107259 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:33:42.109102 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:33:42.110164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.130569 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:33:42.132728 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:33:42.133675 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:33:42.134808 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:33:42.135600 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:33:42.136238 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:33:42.138012 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:33:42.139501 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:33:42.140408 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:33:42.141045 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:33:42.141678 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:33:42.142228 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:33:42.148025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:33:42.153998 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:33:42.154805 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:33:42.155433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.163281 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:33:42.163898 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:33:42.164556 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m12:33:42.182611 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:33:42.184726 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:33:42.186710 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:33:42.187344 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:33:42.190475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c6a0f40>]}
[0m12:33:42.191795 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:42.192786 [debug] [MainThread]: On master: BEGIN
[0m12:33:42.193398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:42.202328 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m12:33:42.203425 [debug] [MainThread]: On master: COMMIT
[0m12:33:42.204061 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:42.204735 [debug] [MainThread]: On master: COMMIT
[0m12:33:42.205471 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:33:42.205992 [debug] [MainThread]: On master: Close
[0m12:33:42.208587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:42.209210 [info ] [MainThread]: 
[0m12:33:42.222538 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m12:33:42.223922 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m12:33:42.225082 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m12:33:42.225737 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m12:33:42.232818 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m12:33:42.239898 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m12:33:42.279209 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m12:33:42.287699 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:33:42.288729 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m12:33:42.289577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:33:42.301121 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:33:42.302126 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:33:42.302710 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:33:42.361145 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m12:33:42.367591 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:33:42.368350 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m12:33:42.369598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:33:42.382591 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:33:42.383912 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:33:42.385095 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:33:42.400093 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:33:42.406657 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:33:42.407835 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m12:33:42.409119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:33:42.411520 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m12:33:42.420912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8eb2805-ca71-4d0e-b1cb-95ae56920e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a9396620>]}
[0m12:33:42.422467 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.19s]
[0m12:33:42.423764 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m12:33:42.425584 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:42.426173 [debug] [MainThread]: On master: BEGIN
[0m12:33:42.426692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:42.438547 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m12:33:42.439483 [debug] [MainThread]: On master: COMMIT
[0m12:33:42.440071 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:42.440687 [debug] [MainThread]: On master: COMMIT
[0m12:33:42.441555 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:33:42.442177 [debug] [MainThread]: On master: Close
[0m12:33:42.445056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:42.445675 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:33:42.446328 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m12:33:42.447257 [info ] [MainThread]: 
[0m12:33:42.447938 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:33:42.449048 [debug] [MainThread]: Command end result
[0m12:33:42.494039 [info ] [MainThread]: 
[0m12:33:42.495076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:42.495807 [info ] [MainThread]: 
[0m12:33:42.496524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:33:42.508631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.537732, "process_user_time": 2.11977, "process_kernel_time": 0.209977, "process_mem_max_rss": "173584", "process_in_blocks": "142552", "process_out_blocks": "0"}
[0m12:33:42.509798 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:42.509677 after 1.54 seconds
[0m12:33:42.510798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a9504b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c6455a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039c646110>]}
[0m12:33:42.511653 [debug] [MainThread]: Flushing usage events
[0m12:34:46.596056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa428428ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa426929660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa426929600>]}


============================== 12:34:46.599571 | 4632d926-329c-4f75-9fbf-af829971ade8 ==============================
[0m12:34:46.599571 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:34:46.600392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:34:46.796132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4282b9ed0>]}
[0m12:34:46.854241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa426b21d80>]}
[0m12:34:46.856072 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:34:46.865540 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:34:47.011779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:47.014255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:47.020805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:34:47.041522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41b5a6020>]}
[0m12:34:47.131196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41b5a3760>]}
[0m12:34:47.132447 [info ] [MainThread]: Found 1 model, 408 macros
[0m12:34:47.133162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41b5a0af0>]}
[0m12:34:47.135750 [info ] [MainThread]: 
[0m12:34:47.136763 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:34:47.138050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:34:47.171588 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:34:47.172667 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:34:47.173563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:47.199027 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m12:34:47.201676 [debug] [ThreadPool]: On list_dev: Close
[0m12:34:47.206085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:34:47.206836 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:34:47.213388 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:34:47.214151 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:34:47.214934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:47.223717 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:34:47.225403 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:34:47.226050 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:34:47.227427 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:34:47.228186 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:34:47.228741 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:34:47.229838 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:34:47.230980 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:34:47.231644 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:34:47.232189 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:34:47.233034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:34:47.233745 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:34:47.237501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:34:47.243141 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:34:47.243967 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:34:47.244631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:47.252926 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:34:47.253722 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:34:47.254427 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m12:34:47.270753 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:34:47.273023 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:34:47.274214 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:34:47.275147 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:34:47.280853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a957c40>]}
[0m12:34:47.282267 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:47.282951 [debug] [MainThread]: On master: BEGIN
[0m12:34:47.283524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:47.292056 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m12:34:47.292851 [debug] [MainThread]: On master: COMMIT
[0m12:34:47.293423 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:47.293974 [debug] [MainThread]: On master: COMMIT
[0m12:34:47.294715 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:34:47.295563 [debug] [MainThread]: On master: Close
[0m12:34:47.298427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:47.299005 [info ] [MainThread]: 
[0m12:34:47.301724 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m12:34:47.302594 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m12:34:47.303556 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m12:34:47.304214 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m12:34:47.311559 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m12:34:47.317212 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m12:34:47.350638 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m12:34:47.357703 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:34:47.358312 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m12:34:47.358866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:34:47.372340 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:34:47.374106 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:34:47.375130 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:34:47.423281 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:34:47.432505 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:34:47.433608 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m12:34:47.434685 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:34:47.447685 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:34:47.448840 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:34:47.450010 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:34:47.465720 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:34:47.471345 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:34:47.472422 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m12:34:47.474357 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:34:47.477098 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m12:34:47.487358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4632d926-329c-4f75-9fbf-af829971ade8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41a8325c0>]}
[0m12:34:47.488834 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.18s]
[0m12:34:47.489910 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m12:34:47.491600 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:47.492184 [debug] [MainThread]: On master: BEGIN
[0m12:34:47.492686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:47.501615 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m12:34:47.502297 [debug] [MainThread]: On master: COMMIT
[0m12:34:47.502920 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:47.503453 [debug] [MainThread]: On master: COMMIT
[0m12:34:47.504090 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:34:47.504734 [debug] [MainThread]: On master: Close
[0m12:34:47.508861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:47.509650 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:34:47.510243 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m12:34:47.510870 [info ] [MainThread]: 
[0m12:34:47.511526 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:34:47.512740 [debug] [MainThread]: Command end result
[0m12:34:47.558704 [info ] [MainThread]: 
[0m12:34:47.559834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:47.561119 [info ] [MainThread]: 
[0m12:34:47.561821 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:34:47.562911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0239317, "process_user_time": 1.726623, "process_kernel_time": 0.090874, "process_mem_max_rss": "175076", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:47.563653 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:47.563562 after 1.02 seconds
[0m12:34:47.564239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa428428ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4236a07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa427547b20>]}
[0m12:34:47.564904 [debug] [MainThread]: Flushing usage events
[0m12:35:05.339952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef59c48af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef58149690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef58149630>]}


============================== 12:35:05.342593 | 9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b ==============================
[0m12:35:05.342593 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:35:05.343540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:05.544807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54f070d0>]}
[0m12:35:05.604411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef581498a0>]}
[0m12:35:05.606265 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:35:05.616620 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:35:05.763681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:05.765144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:05.772840 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:35:05.793849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4cda6050>]}
[0m12:35:05.893295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54e93700>]}
[0m12:35:05.894629 [info ] [MainThread]: Found 1 model, 408 macros
[0m12:35:05.895503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54e92260>]}
[0m12:35:05.897380 [info ] [MainThread]: 
[0m12:35:05.898340 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:35:05.899614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:35:05.936818 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:35:05.938230 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:35:05.939188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:05.964888 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m12:35:05.967421 [debug] [ThreadPool]: On list_dev: Close
[0m12:35:05.971158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:35:05.971822 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:35:05.979238 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:05.980265 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:35:05.981641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:05.993099 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:35:05.995551 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:05.996252 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:35:05.997417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:05.997933 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:05.998437 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:35:05.999429 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:06.000514 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:35:06.001143 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:06.001761 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:35:06.002847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:06.003626 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:35:06.007873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:35:06.013752 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:35:06.014627 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:35:06.015501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:06.023996 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:35:06.025034 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:35:06.025900 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m12:35:06.041203 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:35:06.043446 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:35:06.044529 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:35:06.045605 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:35:06.048861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4cdcfd90>]}
[0m12:35:06.050276 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:06.051096 [debug] [MainThread]: On master: BEGIN
[0m12:35:06.051700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:06.061858 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m12:35:06.062782 [debug] [MainThread]: On master: COMMIT
[0m12:35:06.063482 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:06.064134 [debug] [MainThread]: On master: COMMIT
[0m12:35:06.064884 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:06.065421 [debug] [MainThread]: On master: Close
[0m12:35:06.067795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:06.068659 [info ] [MainThread]: 
[0m12:35:06.071966 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m12:35:06.072862 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m12:35:06.074352 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m12:35:06.074980 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m12:35:06.084397 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m12:35:06.090508 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m12:35:06.129635 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m12:35:06.136147 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:06.136879 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m12:35:06.137448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:06.148307 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:35:06.149360 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:06.149978 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:35:06.195102 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m12:35:06.201684 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:06.202692 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m12:35:06.204017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:06.217565 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:35:06.218752 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:06.220057 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:35:06.236538 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:35:06.241948 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:06.242907 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m12:35:06.244119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:06.246743 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m12:35:06.255978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9922cee5-4fad-43ef-b5b8-4bdcf2cdc77b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef47f425f0>]}
[0m12:35:06.257318 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.18s]
[0m12:35:06.258808 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m12:35:06.260516 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:06.261116 [debug] [MainThread]: On master: BEGIN
[0m12:35:06.261651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:06.273189 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m12:35:06.274028 [debug] [MainThread]: On master: COMMIT
[0m12:35:06.274722 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:06.275284 [debug] [MainThread]: On master: COMMIT
[0m12:35:06.276106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:06.276642 [debug] [MainThread]: On master: Close
[0m12:35:06.279645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:06.280479 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:35:06.282225 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m12:35:06.283101 [info ] [MainThread]: 
[0m12:35:06.283902 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m12:35:06.285316 [debug] [MainThread]: Command end result
[0m12:35:06.332110 [info ] [MainThread]: 
[0m12:35:06.332985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:06.333705 [info ] [MainThread]: 
[0m12:35:06.334582 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:35:06.335644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0557281, "process_user_time": 1.693065, "process_kernel_time": 0.120933, "process_mem_max_rss": "165644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:06.336388 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:06.336300 after 1.06 seconds
[0m12:35:06.336968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef59c48af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef59a2e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef58d3d060>]}
[0m12:35:06.337643 [debug] [MainThread]: Flushing usage events
[0m12:35:29.182968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e87888a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e85d0bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e85d0bc40>]}


============================== 12:35:29.186487 | ff382c92-a36a-4d76-a4b2-47e2a2aa1258 ==============================
[0m12:35:29.186487 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:35:29.187725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:35:29.376534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e82ac6320>]}
[0m12:35:29.433606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e85db3e80>]}
[0m12:35:29.435253 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:35:29.444888 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:35:29.590323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:29.591818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:29.598194 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:35:29.620061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7a995f60>]}
[0m12:35:29.706758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7a990b80>]}
[0m12:35:29.707520 [info ] [MainThread]: Found 1 model, 408 macros
[0m12:35:29.708224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7a992590>]}
[0m12:35:29.710563 [info ] [MainThread]: 
[0m12:35:29.711407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:35:29.712609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:35:29.748471 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:35:29.750476 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:35:29.751380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:29.775384 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:35:29.777510 [debug] [ThreadPool]: On list_dev: Close
[0m12:35:29.781487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:35:29.782126 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:35:29.788741 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:29.789701 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:35:29.790480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:29.798859 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:35:29.800991 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:29.801950 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:35:29.802975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:29.803710 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:29.804210 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:35:29.804962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:35:29.806106 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:35:29.806642 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:35:29.807137 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:35:29.808483 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:35:29.809316 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:35:29.813091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:35:29.819987 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:35:29.820961 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:35:29.821693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:29.830171 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:35:29.831194 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:35:29.831887 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m12:35:29.846656 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:35:29.848664 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:35:29.850027 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:35:29.850980 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:35:29.854251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e79d93c40>]}
[0m12:35:29.854993 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:29.855557 [debug] [MainThread]: On master: BEGIN
[0m12:35:29.856233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:29.864826 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m12:35:29.865646 [debug] [MainThread]: On master: COMMIT
[0m12:35:29.866315 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:29.866803 [debug] [MainThread]: On master: COMMIT
[0m12:35:29.867579 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:35:29.868210 [debug] [MainThread]: On master: Close
[0m12:35:29.870747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:29.871542 [info ] [MainThread]: 
[0m12:35:29.873767 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_bike_trips
[0m12:35:29.874481 [info ] [Thread-1 (]: 1 of 1 START sql view model main.load_bike_trips ............................... [RUN]
[0m12:35:29.875839 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_bike_trips'
[0m12:35:29.876376 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_bike_trips
[0m12:35:29.884365 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_bike_trips"
[0m12:35:29.890000 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_bike_trips
[0m12:35:29.925439 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_bike_trips"
[0m12:35:29.932618 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:29.933364 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: BEGIN
[0m12:35:29.934074 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:29.945545 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m12:35:29.946766 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:29.947485 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */

  
  create view "dev"."main"."load_bike_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:35:29.992715 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m12:35:29.999117 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:30.000000 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
alter view "dev"."main"."load_bike_trips__dbt_tmp" rename to "load_bike_trips"
[0m12:35:30.001181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:30.014307 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:35:30.015336 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:30.016027 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: COMMIT
[0m12:35:30.019789 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:35:30.024709 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_bike_trips"
[0m12:35:30.025410 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "dev", "node_id": "model.taxis_chicago.load_bike_trips"} */
drop view if exists "dev"."main"."load_bike_trips__dbt_backup" cascade
[0m12:35:30.026446 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:35:30.028821 [debug] [Thread-1 (]: On model.taxis_chicago.load_bike_trips: Close
[0m12:35:30.038358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff382c92-a36a-4d76-a4b2-47e2a2aa1258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e79d65b10>]}
[0m12:35:30.039935 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.load_bike_trips .......................... [[32mOK[0m in 0.16s]
[0m12:35:30.041128 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_bike_trips
[0m12:35:30.043222 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:30.043822 [debug] [MainThread]: On master: BEGIN
[0m12:35:30.044380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:30.054209 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m12:35:30.055263 [debug] [MainThread]: On master: COMMIT
[0m12:35:30.055975 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:30.056502 [debug] [MainThread]: On master: COMMIT
[0m12:35:30.057906 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:35:30.058558 [debug] [MainThread]: On master: Close
[0m12:35:30.062949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:30.063626 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:35:30.064297 [debug] [MainThread]: Connection 'model.taxis_chicago.load_bike_trips' was properly closed.
[0m12:35:30.064853 [info ] [MainThread]: 
[0m12:35:30.065652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m12:35:30.066732 [debug] [MainThread]: Command end result
[0m12:35:30.111290 [info ] [MainThread]: 
[0m12:35:30.112257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:30.112896 [info ] [MainThread]: 
[0m12:35:30.113560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:35:30.114995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9898128, "process_user_time": 1.621511, "process_kernel_time": 0.132576, "process_mem_max_rss": "172376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:30.115891 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:30.115792 after 0.99 seconds
[0m12:35:30.116742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e87888a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e86912e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e85db3e80>]}
[0m12:35:30.117621 [debug] [MainThread]: Flushing usage events
[0m09:21:38.947568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5695fcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa567afd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa567afd6c0>]}


============================== 09:21:38.952998 | 737073ae-a842-4f79-b3ce-332b186ae784 ==============================
[0m09:21:38.952998 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:21:38.954335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:21:38.962702 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'taxis_chicago'
[0m09:21:38.964805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.105642, "process_user_time": 1.620524, "process_kernel_time": 0.079534, "process_mem_max_rss": "89920", "process_in_blocks": "184", "command_success": false, "process_out_blocks": "0"}
[0m09:21:38.966142 [debug] [MainThread]: Command `dbt run` failed at 09:21:38.966003 after 0.11 seconds
[0m09:21:38.967104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5695fcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa567afd930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa567affcd0>]}
[0m09:21:38.967961 [debug] [MainThread]: Flushing usage events
[0m09:21:44.595261 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:22:04.477481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd6f8cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd5499630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd54995d0>]}


============================== 09:22:04.481334 | b8797312-111a-4d1e-970e-2b305f93e01f ==============================
[0m09:22:04.481334 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:22:04.482704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m09:22:04.913123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8797312-111a-4d1e-970e-2b305f93e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fca32a530>]}
[0m09:22:05.011072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8797312-111a-4d1e-970e-2b305f93e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fca301c60>]}
[0m09:22:05.014636 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:22:05.034523 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:22:05.150732 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:22:05.152091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8797312-111a-4d1e-970e-2b305f93e01f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd60b0460>]}
[0m09:22:06.859555 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.taxis_chicago.fact_taxi_trips' (models/99. datamart/fact_taxi_trips.sql) depends on a node named 'structural_bike_trips' which was not found
[0m09:22:06.862003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5028708, "process_user_time": 3.483746, "process_kernel_time": 0.197379, "process_mem_max_rss": "135080", "process_in_blocks": "56864", "process_out_blocks": "16", "command_success": false}
[0m09:22:06.863343 [debug] [MainThread]: Command `dbt run` failed at 09:22:06.863197 after 2.50 seconds
[0m09:22:06.864394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd6f8cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fca275450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fc9fcb610>]}
[0m09:22:06.865385 [debug] [MainThread]: Flushing usage events
[0m09:22:12.268369 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:22:46.497521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e677ecb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e65ccd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e65ccd690>]}


============================== 09:22:46.500960 | fdd97829-ed76-4ded-a8b8-b4235a7977a5 ==============================
[0m09:22:46.500960 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:22:46.502241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:22:46.785889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5ab7d4b0>]}
[0m09:22:46.876106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e65d73220>]}
[0m09:22:46.878223 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:22:46.893008 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:22:47.007206 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:22:47.008776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e668e0b80>]}
[0m09:22:48.752094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:22:48.763469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5a98f880>]}
[0m09:22:48.904910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5a72dfc0>]}
[0m09:22:48.906377 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:22:48.907939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5a72c9a0>]}
[0m09:22:48.911904 [info ] [MainThread]: 
[0m09:22:48.913623 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:22:48.921662 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:22:48.992177 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:22:48.994021 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:22:48.995174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:49.017256 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m09:22:49.019755 [debug] [ThreadPool]: On list_dev: Close
[0m09:22:49.025290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:22:49.026664 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:22:49.037902 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:22:49.038832 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:22:49.039685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:49.050775 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m09:22:49.052811 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:22:49.053588 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:22:49.055142 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:22:49.055952 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:22:49.056735 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:22:49.058920 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:22:49.060325 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:22:49.061073 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:22:49.061786 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:22:49.066112 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:22:49.066931 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:22:49.078263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:22:49.087364 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:22:49.089567 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:22:49.090319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:49.102147 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:22:49.103065 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:22:49.103938 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:22:49.131984 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m09:22:49.135047 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:22:49.136892 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:22:49.137711 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:22:49.142255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e65c98970>]}
[0m09:22:49.143340 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:49.144083 [debug] [MainThread]: On master: BEGIN
[0m09:22:49.144928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:22:49.160405 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m09:22:49.161578 [debug] [MainThread]: On master: COMMIT
[0m09:22:49.162421 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:49.163117 [debug] [MainThread]: On master: COMMIT
[0m09:22:49.164175 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:22:49.164939 [debug] [MainThread]: On master: Close
[0m09:22:49.168257 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:22:49.169321 [info ] [MainThread]: 
[0m09:22:49.178460 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:22:49.179594 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:22:49.180744 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:22:49.181536 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:22:49.193366 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.204683 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:22:49.248973 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.256827 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.257979 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:22:49.258947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:22:49.272107 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m09:22:49.273139 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.274000 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:22:49.345300 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m09:22:49.359376 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.360739 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:22:49.362669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:22:49.383724 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:22:49.387063 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.388406 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:22:49.393737 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:22:49.401848 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:22:49.402845 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:22:49.404346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:49.407760 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:22:49.421108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e17f13a90>]}
[0m09:22:49.422656 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.24s]
[0m09:22:49.424232 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:22:49.426583 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:22:49.427846 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:22:49.429220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:22:49.430226 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:22:49.441571 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.453814 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:22:49.461775 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.476149 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.477557 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:22:49.478666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:49.495820 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:22:49.497428 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.498502 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as ride_id,
    cast(taxi_id as VARCHAR) as rideable_type,
    cast(trip_start_timestamp as TIMESTAMP) as trip_start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as ended_at,
    cast(trip_seconds as VARCHAR) as trip_seconds,
    cast(trip_miles as VARCHAR) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:22:49.559379 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m09:22:49.565140 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.566731 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:22:49.568473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:49.570641 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:22:49.571497 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.572320 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:22:49.576422 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:22:49.579906 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:22:49.580783 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:22:49.582059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:22:49.583949 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:22:49.593064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e58199a50>]}
[0m09:22:49.594221 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.16s]
[0m09:22:49.595755 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:22:49.597211 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:22:49.598507 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:22:49.599648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:22:49.600446 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:22:49.605631 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:22:49.618583 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:22:49.625341 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:22:49.637729 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:22:49.638751 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:22:49.639639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:49.657705 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:22:49.659261 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:22:49.660182 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    trip_start_timestamp as start_timestamp ,
    trip_end_timestamp as end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude as 0.0) as start_lat,
    coalesce(pickup_centroid_longitude as 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude as 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude as 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:22:49.669678 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    trip_start_timestamp as start_timestamp ,
    trip_end_timestamp as end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude as 0.0) as start_lat,
    coalesce(pickup_centroid_longitude as 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude as 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude as 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:22:49.670775 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:22:49.672141 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: ROLLBACK
[0m09:22:49.679299 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.cleaned_taxi_trips'
[0m09:22:49.680136 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:22:49.687678 [debug] [Thread-1 (]: Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Parser Error: syntax error at or near "as"
[0m09:22:49.689014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd97829-ed76-4ded-a8b8-b4235a7977a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e58103640>]}
[0m09:22:49.690598 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt_blue.cleaned_taxi_trips ............... [[31mERROR[0m in 0.09s]
[0m09:22:49.692105 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:22:49.695335 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:22:49.696455 [info ] [Thread-1 (]: 4 of 6 SKIP relation dbt_blue.enriched_taxi_trips .............................. [[33mSKIP[0m]
[0m09:22:49.697750 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:22:49.699440 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:22:49.700401 [info ] [Thread-1 (]: 5 of 6 SKIP relation dbt_blue.structural_taxi_trips ............................ [[33mSKIP[0m]
[0m09:22:49.701591 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:22:49.703296 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:22:49.704310 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_blue.fact_taxi_trips .................................. [[33mSKIP[0m]
[0m09:22:49.705387 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:22:49.708118 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:49.709221 [debug] [MainThread]: On master: BEGIN
[0m09:22:49.710175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:22:49.730810 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m09:22:49.732176 [debug] [MainThread]: On master: COMMIT
[0m09:22:49.733513 [debug] [MainThread]: Using duckdb connection "master"
[0m09:22:49.734299 [debug] [MainThread]: On master: COMMIT
[0m09:22:49.735489 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:22:49.736617 [debug] [MainThread]: On master: Close
[0m09:22:49.741364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:49.742343 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:22:49.743261 [debug] [MainThread]: Connection 'model.taxis_chicago.cleaned_taxi_trips' was properly closed.
[0m09:22:49.744191 [info ] [MainThread]: 
[0m09:22:49.745006 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m09:22:49.747042 [debug] [MainThread]: Command end result
[0m09:22:49.818204 [info ] [MainThread]: 
[0m09:22:49.820370 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:22:49.822297 [info ] [MainThread]: 
[0m09:22:49.823668 [error] [MainThread]:   Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Parser Error: syntax error at or near "as"
[0m09:22:49.824657 [info ] [MainThread]: 
[0m09:22:49.825578 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m09:22:49.827746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4251962, "process_user_time": 4.221106, "process_kernel_time": 0.218504, "process_mem_max_rss": "184036", "process_in_blocks": "14104", "process_out_blocks": "72", "command_success": false}
[0m09:22:49.828944 [debug] [MainThread]: Command `dbt run` failed at 09:22:49.828802 after 3.43 seconds
[0m09:22:49.829827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e677ecb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6758cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e17f37d90>]}
[0m09:22:49.830788 [debug] [MainThread]: Flushing usage events
[0m09:22:56.573917 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:23:30.863486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c7df4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c62756f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c6275690>]}


============================== 09:23:30.867028 | 860837db-9b16-4943-b2b7-91ccd274c179 ==============================
[0m09:23:30.867028 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:23:30.868622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:23:31.178275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bb18ae90>]}
[0m09:23:31.268388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c631f220>]}
[0m09:23:31.269945 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:23:31.286647 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:23:31.610602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:31.611794 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/03. cleaning/cleaned_taxi_trips.sql
[0m09:23:31.954296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:23:31.964309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10baec6d10>]}
[0m09:23:32.112135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b8c3b490>]}
[0m09:23:32.113918 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:23:32.115361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10b8c3a8f0>]}
[0m09:23:32.119432 [info ] [MainThread]: 
[0m09:23:32.121168 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:23:32.132509 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:23:32.258280 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:23:32.259777 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:23:32.260528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:32.276664 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:23:32.279170 [debug] [ThreadPool]: On list_dev: Close
[0m09:23:32.285622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:23:32.286726 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:23:32.299188 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:23:32.300539 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:23:32.301396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:32.314976 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:23:32.317047 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:23:32.317906 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:23:32.319325 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:32.320149 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:23:32.320899 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:23:32.322237 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:32.323696 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:23:32.324423 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:23:32.325144 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:23:32.326516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:23:32.327315 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:23:32.332112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:23:32.339542 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:23:32.340675 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:23:32.341471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:32.354422 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m09:23:32.355512 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:23:32.356383 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:23:32.382329 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m09:23:32.385327 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:23:32.386375 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:23:32.387229 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:23:32.391875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c7e64e50>]}
[0m09:23:32.393260 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:32.394157 [debug] [MainThread]: On master: BEGIN
[0m09:23:32.394890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:32.408371 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m09:23:32.409311 [debug] [MainThread]: On master: COMMIT
[0m09:23:32.410116 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:32.410828 [debug] [MainThread]: On master: COMMIT
[0m09:23:32.411817 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:23:32.412591 [debug] [MainThread]: On master: Close
[0m09:23:32.416066 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:23:32.417141 [info ] [MainThread]: 
[0m09:23:32.420525 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:23:32.421623 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:23:32.423217 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:23:32.424245 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:23:32.437723 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.449625 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:23:32.501008 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.512449 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.514704 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:23:32.515894 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:23:32.534577 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:23:32.536123 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.537079 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:23:32.602972 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m09:23:32.613719 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.614833 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m09:23:32.616781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:32.621217 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.622086 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:23:32.623445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:32.645256 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:23:32.646461 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.647306 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:23:32.652516 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:23:32.659466 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:23:32.660737 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:23:32.665341 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:23:32.668674 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:23:32.679410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10baebac20>]}
[0m09:23:32.680706 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.26s]
[0m09:23:32.682033 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:23:32.684022 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:23:32.684980 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:23:32.686224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:23:32.687056 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:23:32.691657 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.699094 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:23:32.706697 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.716260 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.717832 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:23:32.719288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:32.738873 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:23:32.740327 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.741397 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as ride_id,
    cast(taxi_id as VARCHAR) as rideable_type,
    cast(trip_start_timestamp as TIMESTAMP) as trip_start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as ended_at,
    cast(trip_seconds as VARCHAR) as trip_seconds,
    cast(trip_miles as VARCHAR) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:23:32.805662 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m09:23:32.810490 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.811489 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m09:23:32.813038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:32.817604 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.821726 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:23:32.823262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:23:32.825254 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:23:32.826164 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.827004 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:23:32.831143 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:23:32.834583 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:23:32.835520 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:23:32.838271 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:23:32.840814 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:23:32.853856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bad4a6b0>]}
[0m09:23:32.855661 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.17s]
[0m09:23:32.857106 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:23:32.858788 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:23:32.860140 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:23:32.861686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:23:32.862914 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:23:32.870273 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:23:32.879046 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:23:32.886845 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:23:32.895072 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:23:32.896861 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:23:32.897954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:32.916828 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:23:32.918668 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:23:32.919710 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    trip_start_timestamp as start_timestamp ,
    trip_end_timestamp as end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:23:32.987081 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    trip_start_timestamp as start_timestamp ,
    trip_end_timestamp as end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:23:32.988117 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:23:32.989065 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: ROLLBACK
[0m09:23:32.991527 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.cleaned_taxi_trips'
[0m09:23:32.992541 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:23:32.998527 [debug] [Thread-1 (]: Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Binder Error: Referenced column "trip_id" not found in FROM clause!
  Candidate bindings: "stg_taxi_trips.ride_id", "stg_taxi_trips.tips", "stg_taxi_trips.trip_miles"
  LINE 8:     trip_id,
              ^
[0m09:23:32.999811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '860837db-9b16-4943-b2b7-91ccd274c179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1073f84610>]}
[0m09:23:33.001338 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt_blue.cleaned_taxi_trips ............... [[31mERROR[0m in 0.14s]
[0m09:23:33.003188 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:23:33.006325 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:23:33.007476 [info ] [Thread-1 (]: 4 of 6 SKIP relation dbt_blue.enriched_taxi_trips .............................. [[33mSKIP[0m]
[0m09:23:33.008695 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:23:33.010659 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:23:33.011753 [info ] [Thread-1 (]: 5 of 6 SKIP relation dbt_blue.structural_taxi_trips ............................ [[33mSKIP[0m]
[0m09:23:33.013069 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:23:33.014707 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:23:33.015742 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_blue.fact_taxi_trips .................................. [[33mSKIP[0m]
[0m09:23:33.017186 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:23:33.020074 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:33.021065 [debug] [MainThread]: On master: BEGIN
[0m09:23:33.021855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:23:33.043929 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m09:23:33.046173 [debug] [MainThread]: On master: COMMIT
[0m09:23:33.047478 [debug] [MainThread]: Using duckdb connection "master"
[0m09:23:33.048420 [debug] [MainThread]: On master: COMMIT
[0m09:23:33.049759 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:23:33.050694 [debug] [MainThread]: On master: Close
[0m09:23:33.058254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:33.059590 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:23:33.060511 [debug] [MainThread]: Connection 'model.taxis_chicago.cleaned_taxi_trips' was properly closed.
[0m09:23:33.061716 [info ] [MainThread]: 
[0m09:23:33.064674 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m09:23:33.068878 [debug] [MainThread]: Command end result
[0m09:23:33.139096 [info ] [MainThread]: 
[0m09:23:33.140560 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:33.141634 [info ] [MainThread]: 
[0m09:23:33.143079 [error] [MainThread]:   Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Binder Error: Referenced column "trip_id" not found in FROM clause!
  Candidate bindings: "stg_taxi_trips.ride_id", "stg_taxi_trips.tips", "stg_taxi_trips.trip_miles"
  LINE 8:     trip_id,
              ^
[0m09:23:33.144272 [info ] [MainThread]: 
[0m09:23:33.145532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m09:23:33.148385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3798149, "process_user_time": 3.214902, "process_kernel_time": 0.212304, "process_mem_max_rss": "191732", "process_in_blocks": "2192", "command_success": false, "process_out_blocks": "0"}
[0m09:23:33.149686 [debug] [MainThread]: Command `dbt run` failed at 09:23:33.149562 after 2.38 seconds
[0m09:23:33.150528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c7df4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c631f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10bb155ba0>]}
[0m09:23:33.151483 [debug] [MainThread]: Flushing usage events
[0m09:25:16.466637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3415680af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3413b63af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3413b63b50>]}


============================== 09:25:16.471459 | 50957641-a635-4ce1-948e-6f4dd07adbf8 ==============================
[0m09:25:16.471459 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:25:16.473236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:25:16.786337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f341550df00>]}
[0m09:25:16.876462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3413d5b100>]}
[0m09:25:16.878332 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:25:16.892950 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:25:17.253994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:25:17.255547 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/03. cleaning/cleaned_taxi_trips.sql
[0m09:25:17.256531 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/04. enrichment/enriched_taxi_trips.sql
[0m09:25:17.257408 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/02. staging/stg_taxi_trips.sql
[0m09:25:17.613225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:25:17.622504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3408154130>]}
[0m09:25:17.764170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3408157370>]}
[0m09:25:17.765550 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:25:17.766773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3408156860>]}
[0m09:25:17.770704 [info ] [MainThread]: 
[0m09:25:17.772446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:25:17.784390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:25:17.911927 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:25:17.913116 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:25:17.913996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:17.932023 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m09:25:17.934218 [debug] [ThreadPool]: On list_dev: Close
[0m09:25:17.937729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:25:17.939022 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:25:17.949842 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:25:17.950836 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:25:17.951642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:17.967239 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:25:17.970434 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:25:17.971493 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:25:17.973247 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:25:17.974025 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:25:17.974767 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:25:17.976105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:25:17.977597 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:25:17.978342 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:25:17.979047 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:25:17.980319 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:25:17.981088 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:25:17.986371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:25:17.994147 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:25:17.995072 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:25:17.995842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:18.009655 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:25:18.011114 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:25:18.012047 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:25:18.035892 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m09:25:18.038692 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:25:18.039890 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:25:18.041246 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:25:18.047027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34157518d0>]}
[0m09:25:18.048047 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:18.048743 [debug] [MainThread]: On master: BEGIN
[0m09:25:18.049452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:25:18.063867 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m09:25:18.065356 [debug] [MainThread]: On master: COMMIT
[0m09:25:18.066187 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:18.066966 [debug] [MainThread]: On master: COMMIT
[0m09:25:18.068117 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:25:18.068891 [debug] [MainThread]: On master: Close
[0m09:25:18.074554 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:25:18.075703 [info ] [MainThread]: 
[0m09:25:18.080552 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:25:18.081794 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:25:18.083311 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:25:18.084375 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:25:18.099339 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.108291 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:25:18.159544 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.167511 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.168516 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:25:18.169384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:25:18.183832 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:25:18.185037 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.185957 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:25:18.247996 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:25:18.262610 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.263807 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m09:25:18.265297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:25:18.270352 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.271271 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:25:18.272881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:18.295999 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:25:18.296842 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.297752 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:25:18.312563 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m09:25:18.319701 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:25:18.320538 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:25:18.323614 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:25:18.326874 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:25:18.337321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3408156710>]}
[0m09:25:18.338751 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.25s]
[0m09:25:18.340290 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:25:18.342993 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:25:18.345919 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:25:18.347188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:25:18.348370 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:25:18.356037 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.365829 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:25:18.376661 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.385550 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.386614 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:25:18.387596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:18.406783 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:25:18.409142 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.410489 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as ride_id,
    cast(taxi_id as VARCHAR) as rideable_type,
    cast(trip_start_timestamp as TIMESTAMP) as trip_start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as ended_at,
    cast(trip_seconds as VARCHAR) as trip_seconds,
    cast(trip_miles as VARCHAR) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:25:18.473824 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m09:25:18.479133 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.480144 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m09:25:18.481513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:25:18.485564 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.489234 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:25:18.490521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:25:18.492571 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:25:18.493454 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.494385 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:25:18.498741 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:25:18.502373 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:25:18.503256 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:25:18.505728 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:25:18.507610 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:25:18.516195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3414771270>]}
[0m09:25:18.517481 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.17s]
[0m09:25:18.519112 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:25:18.522272 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:25:18.523451 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:25:18.524724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:25:18.525707 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:25:18.531425 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:25:18.541480 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:25:18.550523 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:25:18.561712 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:25:18.563175 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:25:18.564674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:25:18.582551 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:25:18.584215 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:25:18.585297 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    trip_start_timestamp as start_timestamp,
    trip_end_timestamp as end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:25:18.655297 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    trip_start_timestamp as start_timestamp,
    trip_end_timestamp as end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:25:18.657264 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:25:18.658960 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: ROLLBACK
[0m09:25:18.662519 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.cleaned_taxi_trips'
[0m09:25:18.663753 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:25:18.672426 [debug] [Thread-1 (]: Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Binder Error: Referenced column "trip_id" not found in FROM clause!
  Candidate bindings: "stg_taxi_trips.ride_id", "stg_taxi_trips.tips", "stg_taxi_trips.trip_miles"
  LINE 8:     trip_id,
              ^
[0m09:25:18.673660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50957641-a635-4ce1-948e-6f4dd07adbf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34087a3be0>]}
[0m09:25:18.674987 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt_blue.cleaned_taxi_trips ............... [[31mERROR[0m in 0.15s]
[0m09:25:18.676554 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:25:18.679102 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:25:18.680292 [info ] [Thread-1 (]: 4 of 6 SKIP relation dbt_blue.enriched_taxi_trips .............................. [[33mSKIP[0m]
[0m09:25:18.681543 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:25:18.683597 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:25:18.684739 [info ] [Thread-1 (]: 5 of 6 SKIP relation dbt_blue.structural_taxi_trips ............................ [[33mSKIP[0m]
[0m09:25:18.686049 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:25:18.688523 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:25:18.690376 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_blue.fact_taxi_trips .................................. [[33mSKIP[0m]
[0m09:25:18.692157 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:25:18.695434 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:18.696556 [debug] [MainThread]: On master: BEGIN
[0m09:25:18.697591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:25:18.716325 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m09:25:18.717564 [debug] [MainThread]: On master: COMMIT
[0m09:25:18.718438 [debug] [MainThread]: Using duckdb connection "master"
[0m09:25:18.719176 [debug] [MainThread]: On master: COMMIT
[0m09:25:18.720555 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:25:18.721396 [debug] [MainThread]: On master: Close
[0m09:25:18.728222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:18.729387 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:25:18.730292 [debug] [MainThread]: Connection 'model.taxis_chicago.cleaned_taxi_trips' was properly closed.
[0m09:25:18.731411 [info ] [MainThread]: 
[0m09:25:18.732652 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m09:25:18.734946 [debug] [MainThread]: Command end result
[0m09:25:18.809982 [info ] [MainThread]: 
[0m09:25:18.811823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:25:18.813206 [info ] [MainThread]: 
[0m09:25:18.814559 [error] [MainThread]:   Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Binder Error: Referenced column "trip_id" not found in FROM clause!
  Candidate bindings: "stg_taxi_trips.ride_id", "stg_taxi_trips.tips", "stg_taxi_trips.trip_miles"
  LINE 8:     trip_id,
              ^
[0m09:25:18.815559 [info ] [MainThread]: 
[0m09:25:18.816721 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m09:25:18.818732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.453454, "process_user_time": 3.247519, "process_kernel_time": 0.197417, "process_mem_max_rss": "184804", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:25:18.820107 [debug] [MainThread]: Command `dbt run` failed at 09:25:18.819970 after 2.45 seconds
[0m09:25:18.821108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3415680af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3415421ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3408156ef0>]}
[0m09:25:18.822145 [debug] [MainThread]: Flushing usage events
[0m09:26:04.729566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6672230ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66706fd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66706fd600>]}


============================== 09:26:04.733053 | 624781fe-81ec-498d-a8be-8e56e181cffd ==============================
[0m09:26:04.733053 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:26:04.734177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:26:05.038729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66720c1ed0>]}
[0m09:26:05.135484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666d4c3f10>]}
[0m09:26:05.137534 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:26:05.152073 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:26:05.484127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:26:05.486093 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/02. staging/stg_taxi_trips.sql
[0m09:26:05.487115 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/03. cleaning/cleaned_taxi_trips.sql
[0m09:26:05.843892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:26:05.854668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6665241f30>]}
[0m09:26:05.990021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6664109330>]}
[0m09:26:05.991434 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:26:05.992634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66641090f0>]}
[0m09:26:05.996202 [info ] [MainThread]: 
[0m09:26:05.997662 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:26:06.005162 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:26:06.138231 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:26:06.139853 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:26:06.140946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:06.157062 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:26:06.159390 [debug] [ThreadPool]: On list_dev: Close
[0m09:26:06.165013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:26:06.166244 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:26:06.178414 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:06.179621 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:26:06.180566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:06.195509 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:26:06.197595 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:06.198350 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:26:06.199867 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:06.200544 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:06.201235 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:26:06.202580 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:06.204008 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:26:06.204880 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:06.205807 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:26:06.207005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:26:06.207741 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:26:06.213072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:26:06.220289 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:26:06.221279 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:26:06.222182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:06.234178 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:26:06.235208 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:26:06.236164 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:26:06.260960 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m09:26:06.264393 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:26:06.265995 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:26:06.266812 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:26:06.274870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66723058a0>]}
[0m09:26:06.276110 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:06.276797 [debug] [MainThread]: On master: BEGIN
[0m09:26:06.277437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:06.289926 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m09:26:06.291033 [debug] [MainThread]: On master: COMMIT
[0m09:26:06.291790 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:06.292611 [debug] [MainThread]: On master: COMMIT
[0m09:26:06.293708 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:26:06.294690 [debug] [MainThread]: On master: Close
[0m09:26:06.298218 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:26:06.299551 [info ] [MainThread]: 
[0m09:26:06.303471 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:26:06.304678 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:26:06.306295 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:26:06.307373 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:26:06.324976 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.339110 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:26:06.389020 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.397700 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.399272 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:26:06.400105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:26:06.417336 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:26:06.418825 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.419719 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:26:06.482017 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:26:06.492286 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.493597 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m09:26:06.495239 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:06.499174 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.500105 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:26:06.501567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:06.525725 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:26:06.527627 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.528690 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:26:06.534248 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:26:06.541282 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:06.542271 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:26:06.545630 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:06.548772 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:26:06.560005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6664109120>]}
[0m09:26:06.561744 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.25s]
[0m09:26:06.565367 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:26:06.567746 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:26:06.569058 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:26:06.570541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:26:06.572577 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:26:06.586625 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.594765 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:26:06.606304 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.619664 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.620877 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:26:06.621801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:06.643417 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m09:26:06.646353 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.650776 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as VARCHAR) as trip_seconds,
    cast(trip_miles as VARCHAR) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:26:06.714787 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m09:26:06.719572 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.720546 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m09:26:06.721824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:06.725922 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.728762 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:26:06.730252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:06.732480 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:26:06.733293 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.734151 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:26:06.738710 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:26:06.742565 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:06.743425 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:26:06.746788 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:06.748802 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:26:06.758019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6664109120>]}
[0m09:26:06.759470 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.19s]
[0m09:26:06.760998 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:26:06.763157 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:06.765995 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:26:06.767535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:26:06.768772 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:06.775223 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:06.782087 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:06.790055 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:06.799324 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:06.800632 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:26:06.801616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:06.819906 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:26:06.821454 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:06.822551 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:26:06.889058 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:26:06.890143 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:26:06.891341 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: ROLLBACK
[0m09:26:06.893814 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.cleaned_taxi_trips'
[0m09:26:06.894903 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:26:06.901726 [debug] [Thread-1 (]: Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Binder Error: Referenced column "trip_total" not found in FROM clause!
  Candidate bindings: "stg_taxi_trips.trip_id"
  LINE 20:     trip_total,
               ^
[0m09:26:06.903331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '624781fe-81ec-498d-a8be-8e56e181cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664640c4c0>]}
[0m09:26:06.905149 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt_blue.cleaned_taxi_trips ............... [[31mERROR[0m in 0.14s]
[0m09:26:06.906829 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:06.909289 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:26:06.910385 [info ] [Thread-1 (]: 4 of 6 SKIP relation dbt_blue.enriched_taxi_trips .............................. [[33mSKIP[0m]
[0m09:26:06.911768 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:26:06.915237 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:26:06.916536 [info ] [Thread-1 (]: 5 of 6 SKIP relation dbt_blue.structural_taxi_trips ............................ [[33mSKIP[0m]
[0m09:26:06.917890 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:26:06.919823 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:26:06.920879 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_blue.fact_taxi_trips .................................. [[33mSKIP[0m]
[0m09:26:06.922029 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:26:06.924751 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:06.925768 [debug] [MainThread]: On master: BEGIN
[0m09:26:06.926702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:06.939235 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m09:26:06.940618 [debug] [MainThread]: On master: COMMIT
[0m09:26:06.941553 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:06.942350 [debug] [MainThread]: On master: COMMIT
[0m09:26:06.943675 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:26:06.945296 [debug] [MainThread]: On master: Close
[0m09:26:06.953831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:06.955351 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:26:06.956247 [debug] [MainThread]: Connection 'model.taxis_chicago.cleaned_taxi_trips' was properly closed.
[0m09:26:06.957332 [info ] [MainThread]: 
[0m09:26:06.958566 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m09:26:06.960904 [debug] [MainThread]: Command end result
[0m09:26:07.037254 [info ] [MainThread]: 
[0m09:26:07.039042 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:26:07.040446 [info ] [MainThread]: 
[0m09:26:07.042467 [error] [MainThread]:   Runtime Error in model cleaned_taxi_trips (models/03. cleaning/cleaned_taxi_trips.sql)
  Binder Error: Referenced column "trip_total" not found in FROM clause!
  Candidate bindings: "stg_taxi_trips.trip_id"
  LINE 20:     trip_total,
               ^
[0m09:26:07.043881 [info ] [MainThread]: 
[0m09:26:07.045701 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m09:26:07.051902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4270303, "process_user_time": 3.296995, "process_kernel_time": 0.168315, "process_mem_max_rss": "193660", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:26:07.054195 [debug] [MainThread]: Command `dbt run` failed at 09:26:07.053980 after 2.43 seconds
[0m09:26:07.055469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6672230ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6671327b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6664109360>]}
[0m09:26:07.056516 [debug] [MainThread]: Flushing usage events
[0m09:26:23.683221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5baa7a8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba8c2bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba8c2bb20>]}


============================== 09:26:23.687769 | 5518a32b-f14b-41ab-b8bb-afbe6530d95d ==============================
[0m09:26:23.687769 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:26:23.689135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:26:23.989148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9db86d40>]}
[0m09:26:24.080313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba8cce6b0>]}
[0m09:26:24.082693 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:26:24.098950 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:26:24.444485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:26:24.446426 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/03. cleaning/cleaned_taxi_trips.sql
[0m09:26:24.823232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:26:24.832257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9d74fca0>]}
[0m09:26:24.974128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77557040>]}
[0m09:26:24.976270 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:26:24.978763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77556470>]}
[0m09:26:24.982564 [info ] [MainThread]: 
[0m09:26:24.984255 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:26:24.995541 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:26:25.138694 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:26:25.140105 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:26:25.140939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:25.155821 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:26:25.158130 [debug] [ThreadPool]: On list_dev: Close
[0m09:26:25.163839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:26:25.164984 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:26:25.177469 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:25.178475 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:26:25.179307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:25.195396 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:26:25.198253 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:25.199287 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:26:25.200857 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:25.201679 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:25.202379 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:26:25.204097 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:25.205802 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:26:25.206574 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:25.207482 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:26:25.209194 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:25.210025 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:26:25.215699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:26:25.223374 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:26:25.224296 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:26:25.225116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:25.236719 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:26:25.237581 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:26:25.238428 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:26:25.263514 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m09:26:25.267244 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:26:25.268588 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:26:25.269391 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:26:25.277204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9d8ba710>]}
[0m09:26:25.278391 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:25.279305 [debug] [MainThread]: On master: BEGIN
[0m09:26:25.280057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:25.292403 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m09:26:25.293615 [debug] [MainThread]: On master: COMMIT
[0m09:26:25.294335 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:25.295055 [debug] [MainThread]: On master: COMMIT
[0m09:26:25.295996 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:26:25.296765 [debug] [MainThread]: On master: Close
[0m09:26:25.300206 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:26:25.301283 [info ] [MainThread]: 
[0m09:26:25.305716 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:26:25.306788 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:26:25.308148 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:26:25.309153 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:26:25.325409 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.334660 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:26:25.385658 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.393703 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.394983 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:26:25.395942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:26:25.413385 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:26:25.414787 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.415815 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:26:25.477154 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m09:26:25.489928 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.491513 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m09:26:25.492845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:25.497051 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.497920 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:26:25.499113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:25.519866 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:26:25.521085 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.522051 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:26:25.529559 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:26:25.539279 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:25.540944 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:26:25.545400 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:26:25.550693 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:26:25.566587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b775563e0>]}
[0m09:26:25.567931 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.26s]
[0m09:26:25.569550 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:26:25.571423 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:26:25.572691 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:26:25.574996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:26:25.576050 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:26:25.581612 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.589748 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:26:25.598465 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.607236 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.608574 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:26:25.609780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:25.630723 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m09:26:25.632433 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.633717 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as VARCHAR) as trip_seconds,
    cast(trip_miles as VARCHAR) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:26:25.704674 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m09:26:25.710641 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.711593 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m09:26:25.713109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:25.717472 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.720287 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:26:25.721752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:25.724231 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:26:25.725800 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.727304 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:26:25.732876 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:26:25.737681 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:25.738733 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:26:25.741997 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:25.744217 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:26:25.753743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba985a350>]}
[0m09:26:25.754926 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.18s]
[0m09:26:25.756804 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:26:25.758951 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:25.760058 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:26:25.761319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:26:25.762351 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:25.771708 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.782485 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:25.788831 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.797985 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.799278 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:26:25.800198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:25.818887 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:26:25.820600 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.821837 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:26:25.887535 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m09:26:25.892510 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.893580 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m09:26:25.894917 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:25.896887 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m09:26:25.897766 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.898664 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m09:26:25.902658 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:26:25.906211 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:25.907115 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m09:26:25.908255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:25.910100 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:26:25.919159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba8dc9840>]}
[0m09:26:25.920421 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.16s]
[0m09:26:25.922181 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:25.924074 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:26:25.925517 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m09:26:25.927910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m09:26:25.928885 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m09:26:25.934177 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:25.949993 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m09:26:25.958571 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:25.971531 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:25.972679 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m09:26:25.973929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:25.991898 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:26:25.993978 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:25.995581 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m09:26:26.062169 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m09:26:26.063445 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:26:26.064400 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: ROLLBACK
[0m09:26:26.066774 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.enriched_taxi_trips'
[0m09:26:26.067717 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m09:26:26.071827 [debug] [Thread-1 (]: Runtime Error in model enriched_taxi_trips (models/04. enrichment/enriched_taxi_trips.sql)
  Binder Error: No function matches the given name and argument types '*(VARCHAR, DECIMAL(6,5))'. You might need to add explicit type casts.
  	Candidate functions:
  	*(TINYINT, TINYINT) -> TINYINT
  	*(SMALLINT, SMALLINT) -> SMALLINT
  	*(INTEGER, INTEGER) -> INTEGER
  	*(BIGINT, BIGINT) -> BIGINT
  	*(HUGEINT, HUGEINT) -> HUGEINT
  	*(FLOAT, FLOAT) -> FLOAT
  	*(DOUBLE, DOUBLE) -> DOUBLE
  	*(DECIMAL, DECIMAL) -> DECIMAL
  	*(UTINYINT, UTINYINT) -> UTINYINT
  	*(USMALLINT, USMALLINT) -> USMALLINT
  	*(UINTEGER, UINTEGER) -> UINTEGER
  	*(UBIGINT, UBIGINT) -> UBIGINT
  	*(UHUGEINT, UHUGEINT) -> UHUGEINT
  	*(INTERVAL, BIGINT) -> INTERVAL
  	*(BIGINT, INTERVAL) -> INTERVAL
  
  LINE 18:     trip_distance_miles * 1.60934 AS trip_distance_km,
                                   ^
[0m09:26:26.072918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5518a32b-f14b-41ab-b8bb-afbe6530d95d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ba985a350>]}
[0m09:26:26.074291 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model dbt_blue.enriched_taxi_trips .............. [[31mERROR[0m in 0.15s]
[0m09:26:26.075823 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:26:26.079261 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:26:26.080410 [info ] [Thread-1 (]: 5 of 6 SKIP relation dbt_blue.structural_taxi_trips ............................ [[33mSKIP[0m]
[0m09:26:26.081587 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:26:26.083511 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:26:26.084451 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_blue.fact_taxi_trips .................................. [[33mSKIP[0m]
[0m09:26:26.085561 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:26:26.087906 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:26.088761 [debug] [MainThread]: On master: BEGIN
[0m09:26:26.089613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:26.106574 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m09:26:26.108544 [debug] [MainThread]: On master: COMMIT
[0m09:26:26.109497 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:26.110402 [debug] [MainThread]: On master: COMMIT
[0m09:26:26.112254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:26:26.113176 [debug] [MainThread]: On master: Close
[0m09:26:26.123489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:26.125300 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:26:26.126625 [debug] [MainThread]: Connection 'model.taxis_chicago.enriched_taxi_trips' was properly closed.
[0m09:26:26.128922 [info ] [MainThread]: 
[0m09:26:26.130214 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m09:26:26.133087 [debug] [MainThread]: Command end result
[0m09:26:26.216588 [info ] [MainThread]: 
[0m09:26:26.218564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:26:26.220021 [info ] [MainThread]: 
[0m09:26:26.221518 [error] [MainThread]:   Runtime Error in model enriched_taxi_trips (models/04. enrichment/enriched_taxi_trips.sql)
  Binder Error: No function matches the given name and argument types '*(VARCHAR, DECIMAL(6,5))'. You might need to add explicit type casts.
  	Candidate functions:
  	*(TINYINT, TINYINT) -> TINYINT
  	*(SMALLINT, SMALLINT) -> SMALLINT
  	*(INTEGER, INTEGER) -> INTEGER
  	*(BIGINT, BIGINT) -> BIGINT
  	*(HUGEINT, HUGEINT) -> HUGEINT
  	*(FLOAT, FLOAT) -> FLOAT
  	*(DOUBLE, DOUBLE) -> DOUBLE
  	*(DECIMAL, DECIMAL) -> DECIMAL
  	*(UTINYINT, UTINYINT) -> UTINYINT
  	*(USMALLINT, USMALLINT) -> USMALLINT
  	*(UINTEGER, UINTEGER) -> UINTEGER
  	*(UBIGINT, UBIGINT) -> UBIGINT
  	*(UHUGEINT, UHUGEINT) -> UHUGEINT
  	*(INTERVAL, BIGINT) -> INTERVAL
  	*(BIGINT, INTERVAL) -> INTERVAL
  
  LINE 18:     trip_distance_miles * 1.60934 AS trip_distance_km,
                                   ^
[0m09:26:26.223096 [info ] [MainThread]: 
[0m09:26:26.226387 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 TOTAL=6
[0m09:26:26.229587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6413937, "process_user_time": 3.380839, "process_kernel_time": 0.220054, "process_mem_max_rss": "190848", "process_in_blocks": "112", "command_success": false, "process_out_blocks": "0"}
[0m09:26:26.230981 [debug] [MainThread]: Command `dbt run` failed at 09:26:26.230839 after 2.64 seconds
[0m09:26:26.232044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5baa7a8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9d853670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9d853640>]}
[0m09:26:26.233153 [debug] [MainThread]: Flushing usage events
[0m09:26:57.018397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2ec0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc1343a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc1343af0>]}


============================== 09:26:57.022491 | bd20e0c1-312b-433f-8168-58ae86f61a06 ==============================
[0m09:26:57.022491 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:26:57.024185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:26:57.335382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb6156590>]}
[0m09:26:57.431299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbe0c7400>]}
[0m09:26:57.433065 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:26:57.447883 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:26:57.788085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:26:57.790012 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/02. staging/stg_taxi_trips.sql
[0m09:26:58.125569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:26:58.137367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb4138040>]}
[0m09:26:58.273477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb413b4c0>]}
[0m09:26:58.274535 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:26:58.275718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb413a8c0>]}
[0m09:26:58.278770 [info ] [MainThread]: 
[0m09:26:58.280546 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:26:58.290700 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:26:58.410902 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:26:58.412221 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:26:58.413036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:58.431721 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m09:26:58.434258 [debug] [ThreadPool]: On list_dev: Close
[0m09:26:58.440057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:26:58.441716 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:26:58.453466 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:58.454381 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:26:58.455262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:58.469580 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m09:26:58.471926 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:58.472800 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:26:58.473860 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:26:58.474632 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:58.475351 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:26:58.476715 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:58.478206 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:26:58.478951 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:26:58.479704 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:26:58.481085 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:26:58.482848 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:26:58.491632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:26:58.499246 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:26:58.500755 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:26:58.501925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:58.514232 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m09:26:58.515312 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:26:58.516252 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:26:58.545028 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m09:26:58.548323 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:26:58.549278 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:26:58.549986 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:26:58.554623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb5fba4a0>]}
[0m09:26:58.555614 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:58.556390 [debug] [MainThread]: On master: BEGIN
[0m09:26:58.557133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:58.569547 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m09:26:58.570553 [debug] [MainThread]: On master: COMMIT
[0m09:26:58.571337 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:58.572028 [debug] [MainThread]: On master: COMMIT
[0m09:26:58.572967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:26:58.573805 [debug] [MainThread]: On master: Close
[0m09:26:58.576881 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:26:58.577860 [info ] [MainThread]: 
[0m09:26:58.581363 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:26:58.582657 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:26:58.583981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:26:58.584982 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:26:58.599215 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.609634 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:26:58.663162 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.671076 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.672354 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:26:58.673260 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:26:58.692352 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m09:26:58.693752 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.694789 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:26:58.758618 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m09:26:58.771351 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.772810 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m09:26:58.774712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:58.779893 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.780928 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:26:58.782342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:58.808348 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:26:58.809747 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.810623 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:26:58.815208 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:26:58.822807 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:26:58.823785 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:26:58.826428 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:58.829555 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:26:58.843765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb413a890>]}
[0m09:26:58.845599 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.26s]
[0m09:26:58.847084 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:26:58.849051 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:26:58.850296 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:26:58.851650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:26:58.852559 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:26:58.857134 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.863422 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:26:58.869169 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.877201 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.878417 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:26:58.879418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:58.899334 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m09:26:58.901319 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.902881 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:26:58.970058 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m09:26:58.977521 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.978921 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m09:26:58.980519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:58.984420 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.987028 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:26:58.988316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:58.990410 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:26:58.991314 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:58.992147 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:26:58.997182 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:26:59.001349 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:26:59.002590 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:26:59.006628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:59.008600 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:26:59.018100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb413a890>]}
[0m09:26:59.019796 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.17s]
[0m09:26:59.021322 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:26:59.023515 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:59.024668 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:26:59.026103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:26:59.026999 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:59.034559 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.043102 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:59.051933 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.060019 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.061591 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:26:59.062777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:59.081312 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:26:59.082687 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.083697 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:26:59.145711 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:26:59.153645 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.154966 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m09:26:59.156438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:59.160889 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.161875 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m09:26:59.163266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:59.165421 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m09:26:59.166270 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.167159 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m09:26:59.172233 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:26:59.177889 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:26:59.178889 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m09:26:59.181711 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:26:59.183765 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:26:59.193724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb5fa1c60>]}
[0m09:26:59.195376 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.17s]
[0m09:26:59.197185 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:26:59.199638 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:26:59.201530 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m09:26:59.204525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m09:26:59.205672 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m09:26:59.211252 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.225227 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m09:26:59.237918 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.246368 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.247550 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m09:26:59.248660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:59.265363 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:26:59.267251 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.268792 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m09:26:59.329629 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m09:26:59.336157 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.337141 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m09:26:59.338681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:26:59.341004 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m09:26:59.342339 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.343364 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m09:26:59.348239 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:26:59.353071 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:26:59.354232 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m09:26:59.355710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:26:59.358109 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m09:26:59.368022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7ef53520>]}
[0m09:26:59.369260 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.16s]
[0m09:26:59.371025 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:26:59.372945 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:26:59.374248 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m09:26:59.375646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m09:26:59.376577 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m09:26:59.381444 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m09:26:59.393006 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m09:26:59.398189 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m09:26:59.412666 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:26:59.414304 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m09:26:59.415344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:59.432954 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:26:59.437437 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:26:59.440117 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_community_area_id,
    dropoff_community_area as dropoff_community_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_dolar,
    trip_total_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m09:26:59.503863 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_community_area_id,
    dropoff_community_area as dropoff_community_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_dolar,
    trip_total_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m09:26:59.505079 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:26:59.506260 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: ROLLBACK
[0m09:26:59.508658 [debug] [Thread-1 (]: Failed to rollback 'model.taxis_chicago.structural_taxi_trips'
[0m09:26:59.509538 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m09:26:59.514100 [debug] [Thread-1 (]: Runtime Error in model structural_taxi_trips (models/05. structural/structural_taxi_trips.sql)
  Binder Error: Referenced column "trip_total_dolar" not found in FROM clause!
  Candidate bindings: "enriched_taxi_trips.trip_total_amount_dolar"
  LINE 25:     trip_total_dolar,
               ^
[0m09:26:59.515111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd20e0c1-312b-433f-8168-58ae86f61a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb60e49a0>]}
[0m09:26:59.516302 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model dbt_blue.structural_taxi_trips ............ [[31mERROR[0m in 0.14s]
[0m09:26:59.517760 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:26:59.520129 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:26:59.521632 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_blue.fact_taxi_trips .................................. [[33mSKIP[0m]
[0m09:26:59.522980 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:26:59.525879 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:59.526918 [debug] [MainThread]: On master: BEGIN
[0m09:26:59.527810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:59.548380 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m09:26:59.549976 [debug] [MainThread]: On master: COMMIT
[0m09:26:59.551339 [debug] [MainThread]: Using duckdb connection "master"
[0m09:26:59.552473 [debug] [MainThread]: On master: COMMIT
[0m09:26:59.554641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:26:59.555695 [debug] [MainThread]: On master: Close
[0m09:26:59.563600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:59.564806 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:26:59.565643 [debug] [MainThread]: Connection 'model.taxis_chicago.structural_taxi_trips' was properly closed.
[0m09:26:59.566651 [info ] [MainThread]: 
[0m09:26:59.568089 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m09:26:59.571861 [debug] [MainThread]: Command end result
[0m09:26:59.651401 [info ] [MainThread]: 
[0m09:26:59.653165 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:26:59.654626 [info ] [MainThread]: 
[0m09:26:59.656129 [error] [MainThread]:   Runtime Error in model structural_taxi_trips (models/05. structural/structural_taxi_trips.sql)
  Binder Error: Referenced column "trip_total_dolar" not found in FROM clause!
  Candidate bindings: "enriched_taxi_trips.trip_total_amount_dolar"
  LINE 25:     trip_total_dolar,
               ^
[0m09:26:59.657275 [info ] [MainThread]: 
[0m09:26:59.658597 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m09:26:59.660784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.736332, "process_user_time": 3.31606, "process_kernel_time": 0.309632, "process_mem_max_rss": "196412", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:26:59.662099 [debug] [MainThread]: Command `dbt run` failed at 09:26:59.661961 after 2.74 seconds
[0m09:26:59.663075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2ec0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc1f68f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb416b1f0>]}
[0m09:26:59.664069 [debug] [MainThread]: Flushing usage events
[0m09:27:30.082134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc83f08b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc82411720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc824116c0>]}


============================== 09:27:30.085630 | bbab6217-7432-4a08-b57a-61803ec6f43c ==============================
[0m09:27:30.085630 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:27:30.087382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:27:30.395933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc83da5f90>]}
[0m09:27:30.485245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc773593c0>]}
[0m09:27:30.487181 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:27:30.500308 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m09:27:30.832161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:27:30.833454 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/05. structural/structural_taxi_trips.sql
[0m09:27:31.175208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m09:27:31.186123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc770bc2b0>]}
[0m09:27:31.323681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc76e533d0>]}
[0m09:27:31.324916 [info ] [MainThread]: Found 6 models, 408 macros
[0m09:27:31.325841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc76e52830>]}
[0m09:27:31.328950 [info ] [MainThread]: 
[0m09:27:31.330713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:27:31.339653 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:27:31.467314 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:27:31.470028 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m09:27:31.471081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:31.488793 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m09:27:31.490976 [debug] [ThreadPool]: On list_dev: Close
[0m09:27:31.494894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m09:27:31.495935 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m09:27:31.505583 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:27:31.506426 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m09:27:31.507235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:31.523034 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m09:27:31.525252 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:27:31.526070 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m09:27:31.527711 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:27:31.528618 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:27:31.529396 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m09:27:31.530870 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:27:31.532274 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:27:31.533016 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m09:27:31.533765 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m09:27:31.535181 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:27:31.536058 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m09:27:31.541611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m09:27:31.550416 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:27:31.551430 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m09:27:31.552395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:31.567432 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m09:27:31.568807 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m09:27:31.569839 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m09:27:31.598236 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m09:27:31.600991 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m09:27:31.602158 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m09:27:31.603140 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m09:27:31.610161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc770ca6b0>]}
[0m09:27:31.611198 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:31.611924 [debug] [MainThread]: On master: BEGIN
[0m09:27:31.612681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:31.627602 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m09:27:31.628632 [debug] [MainThread]: On master: COMMIT
[0m09:27:31.629534 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:31.630270 [debug] [MainThread]: On master: COMMIT
[0m09:27:31.631225 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:27:31.631977 [debug] [MainThread]: On master: Close
[0m09:27:31.635137 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m09:27:31.636067 [info ] [MainThread]: 
[0m09:27:31.639614 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m09:27:31.640890 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m09:27:31.642390 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m09:27:31.643397 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m09:27:31.658157 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.668585 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m09:27:31.719143 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.729203 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.731273 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m09:27:31.732306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:27:31.748821 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m09:27:31.750445 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.751569 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m09:27:31.815268 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m09:27:31.825658 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.827223 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m09:27:31.828696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:27:31.832905 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.833844 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m09:27:31.835060 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:27:31.858376 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:27:31.859553 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.860765 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m09:27:31.865560 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:27:31.872698 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m09:27:31.873575 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m09:27:31.876303 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:27:31.879992 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m09:27:31.892278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc770ca6b0>]}
[0m09:27:31.894000 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.25s]
[0m09:27:31.896166 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m09:27:31.898231 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m09:27:31.899549 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m09:27:31.900974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m09:27:31.901936 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m09:27:31.906639 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m09:27:31.915834 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m09:27:31.924705 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m09:27:31.936853 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:27:31.938475 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m09:27:31.939654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:31.956777 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:27:31.958242 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:27:31.959200 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m09:27:32.022981 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m09:27:32.027688 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:27:32.028594 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m09:27:32.030255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:27:32.034758 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:27:32.038771 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m09:27:32.039967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:27:32.042178 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:27:32.043197 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:27:32.044349 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m09:27:32.050887 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:27:32.054981 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m09:27:32.055958 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m09:27:32.058602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:27:32.061001 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m09:27:32.074445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7411cb50>]}
[0m09:27:32.076387 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.17s]
[0m09:27:32.078644 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m09:27:32.081582 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m09:27:32.083026 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m09:27:32.084531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m09:27:32.085656 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m09:27:32.093950 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.107697 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m09:27:32.115099 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.123338 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.124584 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m09:27:32.125461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:32.143076 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:27:32.145410 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.147259 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m09:27:32.209687 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m09:27:32.214530 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.215521 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m09:27:32.216842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:27:32.221171 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.222405 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m09:27:32.224064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:27:32.226263 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m09:27:32.227184 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.228026 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m09:27:32.232159 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:27:32.236511 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m09:27:32.237580 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m09:27:32.241428 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:27:32.243993 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m09:27:32.255711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc74200e80>]}
[0m09:27:32.256988 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.17s]
[0m09:27:32.258625 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m09:27:32.261059 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m09:27:32.263684 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m09:27:32.265713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m09:27:32.267179 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m09:27:32.274398 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.283999 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m09:27:32.292747 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.302830 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.304475 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m09:27:32.305421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:32.323864 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m09:27:32.325498 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.327340 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m09:27:32.391939 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m09:27:32.397289 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.398697 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m09:27:32.400772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:27:32.406179 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.407323 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m09:27:32.408713 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:27:32.411309 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m09:27:32.412221 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.413126 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m09:27:32.417886 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:27:32.421899 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m09:27:32.422907 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m09:27:32.425689 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:27:32.427559 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m09:27:32.437050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc770a6f80>]}
[0m09:27:32.438338 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.17s]
[0m09:27:32.440554 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m09:27:32.442557 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m09:27:32.445140 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m09:27:32.449609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m09:27:32.451065 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m09:27:32.458749 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.472041 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m09:27:32.479296 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.488134 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.489326 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m09:27:32.490429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:32.511685 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m09:27:32.514933 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.516589 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_community_area_id,
    dropoff_community_area as dropoff_community_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m09:27:32.587683 [debug] [Thread-1 (]: SQL status: OK in 0.070 seconds
[0m09:27:32.593530 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.594870 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m09:27:32.596625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:27:32.599415 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m09:27:32.600463 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.601545 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m09:27:32.606695 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:27:32.613847 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m09:27:32.615113 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m09:27:32.616982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:27:32.619146 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m09:27:32.628978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc741463e0>]}
[0m09:27:32.630429 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.18s]
[0m09:27:32.632230 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m09:27:32.634058 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m09:27:32.635083 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m09:27:32.636286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m09:27:32.637136 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m09:27:32.641741 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.655791 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m09:27:32.687486 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.700268 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.701899 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m09:27:32.703654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:32.720942 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m09:27:32.722350 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.723343 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m09:27:32.839551 [debug] [Thread-1 (]: SQL status: OK in 0.115 seconds
[0m09:27:32.845794 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.847105 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m09:27:32.849078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:27:32.856908 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m09:27:32.857832 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.858667 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m09:27:32.867358 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m09:27:32.871486 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m09:27:32.872339 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m09:27:32.873695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:27:32.875643 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m09:27:32.908104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbab6217-7432-4a08-b57a-61803ec6f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc741465c0>]}
[0m09:27:32.909907 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.27s]
[0m09:27:32.912144 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m09:27:32.915266 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:32.916266 [debug] [MainThread]: On master: BEGIN
[0m09:27:32.917194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:27:32.936261 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m09:27:32.937816 [debug] [MainThread]: On master: COMMIT
[0m09:27:32.938929 [debug] [MainThread]: Using duckdb connection "master"
[0m09:27:32.940199 [debug] [MainThread]: On master: COMMIT
[0m09:27:32.941558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:27:32.942553 [debug] [MainThread]: On master: Close
[0m09:27:32.950866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:32.952367 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m09:27:32.953372 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m09:27:32.954468 [info ] [MainThread]: 
[0m09:27:32.955559 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m09:27:32.958733 [debug] [MainThread]: Command end result
[0m09:27:33.035689 [info ] [MainThread]: 
[0m09:27:33.037234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:33.038548 [info ] [MainThread]: 
[0m09:27:33.039775 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:27:33.041918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.055831, "process_user_time": 3.527252, "process_kernel_time": 0.275247, "process_mem_max_rss": "200004", "process_in_blocks": "1928", "process_out_blocks": "0"}
[0m09:27:33.043286 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:33.043073 after 3.06 seconds
[0m09:27:33.045665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc83f08b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc83008880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc773593c0>]}
[0m09:27:33.047588 [debug] [MainThread]: Flushing usage events
[0m09:59:04.558180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4ea54b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4cf1d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4cf1d6c0>]}


============================== 09:59:04.563283 | 090bde34-10b1-4ee1-823c-abfd5b8f5d13 ==============================
[0m09:59:04.563283 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:59:04.564571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:05.010191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '090bde34-10b1-4ee1-823c-abfd5b8f5d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec49c8bd30>]}
[0m09:59:05.109020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '090bde34-10b1-4ee1-823c-abfd5b8f5d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec49cb9990>]}
[0m09:59:05.111217 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:59:05.115268 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m09:59:05.119428 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.65326095, "process_user_time": 1.926745, "process_kernel_time": 0.131139, "process_mem_max_rss": "125132", "process_in_blocks": "55304", "command_success": false, "process_out_blocks": "0"}
[0m09:59:05.120830 [debug] [MainThread]: Command `dbt test` failed at 09:59:05.120671 after 0.65 seconds
[0m09:59:05.121886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4ea54b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec41d4e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec49cdf460>]}
[0m09:59:05.126356 [debug] [MainThread]: Flushing usage events
[0m09:59:25.063881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde84334ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8283d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8283d600>]}


============================== 09:59:25.067215 | 29966234-56f6-4637-af6d-f51dea7368e4 ==============================
[0m09:59:25.067215 [info ] [MainThread]: Running with dbt=1.8.4
[0m09:59:25.068690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:25.382962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29966234-56f6-4637-af6d-f51dea7368e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde77751c00>]}
[0m09:59:25.479766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29966234-56f6-4637-af6d-f51dea7368e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde82a3dc90>]}
[0m09:59:25.481698 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m09:59:25.485998 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m09:59:25.488901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5170292, "process_user_time": 1.957808, "process_kernel_time": 0.111009, "process_mem_max_rss": "125644", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:25.490069 [debug] [MainThread]: Command `dbt run` failed at 09:59:25.489895 after 0.52 seconds
[0m09:59:25.490968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde84334ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde82aabc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde77669ba0>]}
[0m09:59:25.491989 [debug] [MainThread]: Flushing usage events
[0m10:13:18.816200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e97b44af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e960455a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e96045540>]}


============================== 10:13:18.820287 | cbd9cfee-2c58-4aa9-80db-3336d0933cd4 ==============================
[0m10:13:18.820287 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:13:18.821857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/etl_project/taxis_chicago', 'debug': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:13:19.030016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbd9cfee-2c58-4aa9-80db-3336d0933cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e979d5f00>]}
[0m10:13:19.066879 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4hcll0yh'
[0m10:13:19.067971 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:13:19.477408 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:13:19.479882 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:13:19.702888 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:13:19.716854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:13:19.941770 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:13:19.960014 [info ] [MainThread]: Updating lock file in file path: /etl_project/taxis_chicago/package-lock.yml
[0m10:13:19.971099 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w04izqge'
[0m10:13:19.980739 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:13:23.373774 [info ] [MainThread]: Installed from version 0.10.3
[0m10:13:23.375032 [info ] [MainThread]: Up to date!
[0m10:13:23.376410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbd9cfee-2c58-4aa9-80db-3336d0933cd4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9750bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e95e4dae0>]}
[0m10:13:23.377338 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:13:24.818715 [info ] [MainThread]: Installed from version 0.10.1
[0m10:13:24.820427 [info ] [MainThread]: Up to date!
[0m10:13:24.821988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbd9cfee-2c58-4aa9-80db-3336d0933cd4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9750bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e95e4cca0>]}
[0m10:13:24.826736 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.1038594, "process_user_time": 2.176956, "process_kernel_time": 0.425495, "process_mem_max_rss": "100800", "process_in_blocks": "68240", "process_out_blocks": "7400"}
[0m10:13:24.828002 [debug] [MainThread]: Command `dbt deps` succeeded at 10:13:24.827863 after 6.11 seconds
[0m10:13:24.828905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e97b44af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e974e9fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e96050670>]}
[0m10:13:24.829966 [debug] [MainThread]: Flushing usage events
[0m10:13:32.798083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561b798af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5619c616c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5619c61660>]}


============================== 10:13:32.803447 | 48464692-fdc4-4d3b-b86d-a293b3df2878 ==============================
[0m10:13:32.803447 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:13:32.804930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:13:33.285513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48464692-fdc4-4d3b-b86d-a293b3df2878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560eb13d60>]}
[0m10:13:33.394310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48464692-fdc4-4d3b-b86d-a293b3df2878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5619edf970>]}
[0m10:13:33.397522 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:13:33.469108 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:13:33.598049 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m10:13:33.599549 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:13:33.600632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48464692-fdc4-4d3b-b86d-a293b3df2878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561a88da20>]}
[0m10:13:38.254495 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_bike_trips' in the 'models' section of file 'models/99. datamart/datamarts.yml'
[0m10:13:38.507588 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxis_chicago.unique_fact_bike_trips_trip_id.575e858f74' (models/99. datamart/datamarts.yml) depends on a node named 'fact_bike_trips' in package '' which was not found
[0m10:13:38.509331 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxis_chicago.not_null_fact_bike_trips_taxi_id.91da3de31d' (models/99. datamart/datamarts.yml) depends on a node named 'fact_bike_trips' in package '' which was not found
[0m10:13:38.512548 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxis_chicago.not_null_fact_bike_trips_payment_type.d12b56e00b' (models/99. datamart/datamarts.yml) depends on a node named 'fact_bike_trips' in package '' which was not found
[0m10:13:38.514341 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxis_chicago.accepted_values_fact_bike_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.49a666e1ec' (models/99. datamart/datamarts.yml) depends on a node named 'fact_bike_trips' in package '' which was not found
[0m10:13:38.515745 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_bike_trips_pickup_area_id__77__0.d2b8c9a636' (models/99. datamart/datamarts.yml) depends on a node named 'fact_bike_trips' in package '' which was not found
[0m10:13:38.517046 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_bike_trips_dropoff_area_id__77__0.3e9260ba4f' (models/99. datamart/datamarts.yml) depends on a node named 'fact_bike_trips' in package '' which was not found
[0m10:13:38.792564 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:13:38.806081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48464692-fdc4-4d3b-b86d-a293b3df2878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560e7d7df0>]}
[0m10:13:39.036308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48464692-fdc4-4d3b-b86d-a293b3df2878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560e8d3910>]}
[0m10:13:39.037843 [info ] [MainThread]: Found 6 models, 675 macros
[0m10:13:39.039261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48464692-fdc4-4d3b-b86d-a293b3df2878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560e727340>]}
[0m10:13:39.044021 [info ] [MainThread]: 
[0m10:13:39.047056 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:13:39.049351 [debug] [MainThread]: Command end result
[0m10:13:39.174565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.4838233, "process_user_time": 5.207245, "process_kernel_time": 0.442124, "process_mem_max_rss": "140608", "process_in_blocks": "57872", "process_out_blocks": "0"}
[0m10:13:39.176002 [debug] [MainThread]: Command `dbt test` succeeded at 10:13:39.175811 after 6.49 seconds
[0m10:13:39.178402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561b798af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560c432770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560c4312a0>]}
[0m10:13:39.179712 [debug] [MainThread]: Flushing usage events
[0m10:14:10.629763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b1ca8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b01956f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b0195690>]}


============================== 10:14:10.634349 | 14362018-0b5a-4306-b004-3a52df94ee57 ==============================
[0m10:14:10.634349 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:14:10.635779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:10.983824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14362018-0b5a-4306-b004-3a52df94ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b0163520>]}
[0m10:14:11.082002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14362018-0b5a-4306-b004-3a52df94ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3acf374c0>]}
[0m10:14:11.084504 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:14:11.164530 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:14:13.555800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:14:13.558068 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/99. datamart/datamarts.yml
[0m10:14:14.022489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:14:14.038350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14362018-0b5a-4306-b004-3a52df94ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a4ae53c0>]}
[0m10:14:14.352228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14362018-0b5a-4306-b004-3a52df94ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a4cdb5e0>]}
[0m10:14:14.354088 [info ] [MainThread]: Found 6 models, 6 data tests, 675 macros
[0m10:14:14.355211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14362018-0b5a-4306-b004-3a52df94ee57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a4f6cbe0>]}
[0m10:14:14.359302 [info ] [MainThread]: 
[0m10:14:14.360907 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:14:14.370839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m10:14:14.450934 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:14:14.452425 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m10:14:14.453834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:14.477924 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m10:14:14.479638 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m10:14:14.481827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:14.482753 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m10:14:14.483604 [info ] [MainThread]: 
[0m10:14:14.484595 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m10:14:14.486101 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/etl_project/taxis_chicago/dev.duckdb": No such file or directory
[0m10:14:14.488196 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.962433, "process_user_time": 3.133771, "process_kernel_time": 0.360433, "process_mem_max_rss": "148520", "process_in_blocks": "7528", "command_success": false, "process_out_blocks": "0"}
[0m10:14:14.489459 [debug] [MainThread]: Command `dbt test` failed at 10:14:14.489326 after 3.96 seconds
[0m10:14:14.490540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b1ca8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a4f6cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a4d35570>]}
[0m10:14:14.491566 [debug] [MainThread]: Flushing usage events
[0m10:15:25.465703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8569260b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856776d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856776d6c0>]}


============================== 10:15:25.470521 | ff837927-d927-4a95-b85f-54d665bb83b7 ==============================
[0m10:15:25.470521 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:15:25.473685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m10:15:25.834890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff837927-d927-4a95-b85f-54d665bb83b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85690e9f90>]}
[0m10:15:25.961613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff837927-d927-4a95-b85f-54d665bb83b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856448da80>]}
[0m10:15:25.964045 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:15:26.040561 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:15:28.603494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:28.605434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:28.626576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:15:28.690933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff837927-d927-4a95-b85f-54d665bb83b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855c2ec1f0>]}
[0m10:15:28.890462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff837927-d927-4a95-b85f-54d665bb83b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855c2ec670>]}
[0m10:15:28.891938 [info ] [MainThread]: Found 6 models, 6 data tests, 675 macros
[0m10:15:28.892975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff837927-d927-4a95-b85f-54d665bb83b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855c2ecd90>]}
[0m10:15:28.896695 [info ] [MainThread]: 
[0m10:15:28.898407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:15:28.907993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:15:28.982785 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:15:28.984557 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m10:15:28.985509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:28.997104 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m10:15:28.998453 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m10:15:29.000322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:29.001102 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:15:29.002052 [info ] [MainThread]: 
[0m10:15:29.003233 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m10:15:29.005675 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/etl_project/taxis_chicago/dev.duckdb": No such file or directory
[0m10:15:29.009304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.657177, "process_user_time": 2.956506, "process_kernel_time": 0.280617, "process_mem_max_rss": "142616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:15:29.010711 [debug] [MainThread]: Command `dbt run` failed at 10:15:29.010566 after 3.66 seconds
[0m10:15:29.011724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8569260b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855c305780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855c2a0760>]}
[0m10:15:29.012678 [debug] [MainThread]: Flushing usage events
[0m10:17:27.205949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c4beccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c30998d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c3099870>]}


============================== 10:17:27.209347 | effe0470-70ed-42a0-afd1-9dbd420f7fb0 ==============================
[0m10:17:27.209347 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:17:27.210509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/etl_project/taxis_chicago', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:27.380775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'effe0470-70ed-42a0-afd1-9dbd420f7fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c30a7370>]}
[0m10:17:27.631176 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mj29tq1v'
[0m10:17:27.633630 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:17:28.024060 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:17:28.026976 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:17:28.215935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:17:28.224237 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:17:28.415559 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:17:28.420571 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:17:31.863754 [info ] [MainThread]: Installed from version 0.10.3
[0m10:17:31.865274 [info ] [MainThread]: Up to date!
[0m10:17:31.866677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'effe0470-70ed-42a0-afd1-9dbd420f7fb0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c4595ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c2eb6830>]}
[0m10:17:31.867821 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:17:33.331882 [info ] [MainThread]: Installed from version 0.10.1
[0m10:17:33.333200 [info ] [MainThread]: Up to date!
[0m10:17:33.334925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'effe0470-70ed-42a0-afd1-9dbd420f7fb0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c4595ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c2eb5000>]}
[0m10:17:33.339490 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.2211733, "process_user_time": 2.024585, "process_kernel_time": 0.508796, "process_mem_max_rss": "100916", "process_in_blocks": "1504", "process_out_blocks": "8152"}
[0m10:17:33.341037 [debug] [MainThread]: Command `dbt deps` succeeded at 10:17:33.340853 after 6.22 seconds
[0m10:17:33.342101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c4beccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c49e4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c4595ff0>]}
[0m10:17:33.343156 [debug] [MainThread]: Flushing usage events
[0m10:17:41.670032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654d90ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2653277af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2653277b50>]}


============================== 10:17:41.673518 | 4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99 ==============================
[0m10:17:41.673518 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:17:41.674653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:17:41.971348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654c21ed0>]}
[0m10:17:42.064097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26532fad40>]}
[0m10:17:42.065850 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:17:42.162100 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:17:44.527120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:44.528691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:44.540523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:17:44.610324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2647dd0280>]}
[0m10:17:44.819887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2647f08460>]}
[0m10:17:44.820910 [info ] [MainThread]: Found 6 models, 6 data tests, 675 macros
[0m10:17:44.821935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265331dc90>]}
[0m10:17:44.824672 [info ] [MainThread]: 
[0m10:17:44.826035 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:17:44.833421 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:17:44.892347 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:17:44.893862 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m10:17:44.894999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:44.920013 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m10:17:44.923262 [debug] [ThreadPool]: On list_dev: Close
[0m10:17:44.930965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m10:17:44.932569 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m10:17:45.007607 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:17:45.009454 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m10:17:45.010678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:45.027018 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:17:45.029231 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:17:45.030103 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m10:17:45.031744 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:17:45.032524 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:17:45.033286 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m10:17:45.035285 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:17:45.036790 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m10:17:45.037563 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:17:45.038315 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m10:17:45.042619 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:17:45.043490 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m10:17:45.055930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m10:17:45.064430 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:17:45.065576 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m10:17:45.066410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:45.079741 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m10:17:45.081118 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:17:45.082073 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m10:17:45.110442 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m10:17:45.113374 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m10:17:45.115537 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m10:17:45.116384 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m10:17:45.123863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654e658a0>]}
[0m10:17:45.124982 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:45.125739 [debug] [MainThread]: On master: BEGIN
[0m10:17:45.126628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:45.139495 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m10:17:45.140404 [debug] [MainThread]: On master: COMMIT
[0m10:17:45.141170 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:45.142122 [debug] [MainThread]: On master: COMMIT
[0m10:17:45.143192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:17:45.144071 [debug] [MainThread]: On master: Close
[0m10:17:45.147314 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m10:17:45.148483 [info ] [MainThread]: 
[0m10:17:45.163022 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m10:17:45.165384 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m10:17:45.167740 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.load_taxi_trips'
[0m10:17:45.169541 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m10:17:45.189009 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.200579 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m10:17:45.254830 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.262761 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.264195 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m10:17:45.265414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:17:45.283312 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:17:45.284856 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.286002 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m10:17:45.359875 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m10:17:45.374936 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.376123 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m10:17:45.377985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:45.399514 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m10:17:45.400739 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.401626 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m10:17:45.407159 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:17:45.415987 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:17:45.417115 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m10:17:45.418565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:45.422367 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m10:17:45.433720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26470eadd0>]}
[0m10:17:45.435056 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.27s]
[0m10:17:45.436626 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m10:17:45.438671 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m10:17:45.439932 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m10:17:45.441549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m10:17:45.442853 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m10:17:45.453249 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.464135 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m10:17:45.478444 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.489980 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.491586 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m10:17:45.493480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:45.511197 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:17:45.514056 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.515959 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m10:17:45.585962 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m10:17:45.594269 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.595541 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m10:17:45.597621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:45.600003 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m10:17:45.600972 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.602077 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m10:17:45.606344 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:17:45.611052 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:17:45.612006 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m10:17:45.613207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:45.615398 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m10:17:45.625412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26470de9b0>]}
[0m10:17:45.626731 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.18s]
[0m10:17:45.628031 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m10:17:45.629823 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m10:17:45.630997 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m10:17:45.632289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m10:17:45.633093 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m10:17:45.638860 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.650483 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m10:17:45.659057 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.669744 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.671012 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m10:17:45.672061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:45.689903 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:17:45.691541 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.692911 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m10:17:45.754996 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:17:45.764453 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.766242 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m10:17:45.768363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:45.771093 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m10:17:45.772026 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.772910 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m10:17:45.779438 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:17:45.786250 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:17:45.787963 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m10:17:45.790031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:45.794086 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m10:17:45.805192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26470de9b0>]}
[0m10:17:45.806539 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.17s]
[0m10:17:45.808083 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m10:17:45.810379 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m10:17:45.811575 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m10:17:45.812749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m10:17:45.813726 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m10:17:45.819058 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.826172 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m10:17:45.835102 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.844484 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.848387 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m10:17:45.850235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:45.869391 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:17:45.870916 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.872340 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m10:17:45.939898 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m10:17:45.945756 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.946738 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m10:17:45.948135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:45.950084 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m10:17:45.950950 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.951858 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m10:17:45.955957 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:17:45.962244 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:17:45.964447 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m10:17:45.966352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:45.969647 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m10:17:45.984475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2647b6cdf0>]}
[0m10:17:45.986577 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.17s]
[0m10:17:45.988612 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m10:17:45.990947 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m10:17:45.992222 [info ] [Thread-1 (]: 5 of 6 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m10:17:45.993869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m10:17:45.995162 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m10:17:46.002676 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.010977 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m10:17:46.020168 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.028517 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.029778 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m10:17:46.030851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:46.050440 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:17:46.052292 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.053509 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m10:17:46.118878 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m10:17:46.124560 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.126018 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m10:17:46.127943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:46.129922 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m10:17:46.130779 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.131795 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m10:17:46.135967 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:17:46.140141 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:17:46.140994 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m10:17:46.142285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:46.144281 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m10:17:46.156641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2647b667d0>]}
[0m10:17:46.157976 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.16s]
[0m10:17:46.159578 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m10:17:46.161614 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m10:17:46.162983 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m10:17:46.164447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m10:17:46.165868 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m10:17:46.172719 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.183944 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m10:17:46.221354 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.231945 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.233308 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m10:17:46.234201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:46.254751 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:17:46.256267 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.257222 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m10:17:46.366439 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m10:17:46.374272 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.375424 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m10:17:46.377532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:46.385253 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m10:17:46.386842 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.387853 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m10:17:46.396767 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:17:46.401860 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:17:46.402714 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m10:17:46.404134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:46.406869 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m10:17:46.436290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e29818e-cf4a-4c0f-a87b-4a1fe3b90e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2647e53010>]}
[0m10:17:46.438924 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.27s]
[0m10:17:46.440653 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m10:17:46.444879 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:46.445937 [debug] [MainThread]: On master: BEGIN
[0m10:17:46.446879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:46.469481 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m10:17:46.477734 [debug] [MainThread]: On master: COMMIT
[0m10:17:46.491116 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:46.493089 [debug] [MainThread]: On master: COMMIT
[0m10:17:46.496162 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:17:46.497624 [debug] [MainThread]: On master: Close
[0m10:17:46.505351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:46.506382 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m10:17:46.507202 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m10:17:46.508211 [info ] [MainThread]: 
[0m10:17:46.509188 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m10:17:46.512231 [debug] [MainThread]: Command end result
[0m10:17:46.619148 [info ] [MainThread]: 
[0m10:17:46.620726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:46.622088 [info ] [MainThread]: 
[0m10:17:46.623276 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:17:46.625062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0598845, "process_user_time": 3.580793, "process_kernel_time": 0.395552, "process_mem_max_rss": "192136", "process_in_blocks": "7528", "process_out_blocks": "88"}
[0m10:17:46.626435 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:46.626276 after 5.06 seconds
[0m10:17:46.627434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654d90ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2654063610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2647b83b20>]}
[0m10:17:46.628502 [debug] [MainThread]: Flushing usage events
[0m10:17:55.491544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eced14ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd221690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd221630>]}


============================== 10:17:55.495408 | 936ec877-4f7e-446f-8c71-6565c072f6ca ==============================
[0m10:17:55.495408 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:17:55.496817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:55.815250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '936ec877-4f7e-446f-8c71-6565c072f6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecebb1ed0>]}
[0m10:17:55.909301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '936ec877-4f7e-446f-8c71-6565c072f6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd2a6d40>]}
[0m10:17:55.910821 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:17:55.990616 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:17:58.311020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:58.311972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:58.321140 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:17:58.387602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '936ec877-4f7e-446f-8c71-6565c072f6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec1de0160>]}
[0m10:17:58.575659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '936ec877-4f7e-446f-8c71-6565c072f6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec1e09780>]}
[0m10:17:58.576693 [info ] [MainThread]: Found 6 models, 6 data tests, 675 macros
[0m10:17:58.577694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936ec877-4f7e-446f-8c71-6565c072f6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec1f04be0>]}
[0m10:17:58.580715 [info ] [MainThread]: 
[0m10:17:58.582081 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:17:58.590687 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m10:17:58.713703 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:17:58.715591 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m10:17:58.716489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:58.731989 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:17:58.733000 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:17:58.733745 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m10:17:58.755308 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m10:17:58.762974 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m10:17:58.764369 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m10:17:58.765099 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m10:17:58.770679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936ec877-4f7e-446f-8c71-6565c072f6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eceded8a0>]}
[0m10:17:58.771778 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:58.772505 [debug] [MainThread]: On master: BEGIN
[0m10:17:58.773257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:58.785441 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m10:17:58.786293 [debug] [MainThread]: On master: COMMIT
[0m10:17:58.787008 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:58.787712 [debug] [MainThread]: On master: COMMIT
[0m10:17:58.788685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:17:58.789490 [debug] [MainThread]: On master: Close
[0m10:17:58.796046 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m10:17:58.797437 [info ] [MainThread]: 
[0m10:17:58.804126 [debug] [Thread-1 (]: Began running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce
[0m10:17:58.805344 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown  [RUN]
[0m10:17:58.808220 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce'
[0m10:17:58.809830 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce
[0m10:17:58.844808 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce"
[0m10:17:58.862914 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce
[0m10:17:58.894846 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce"
[0m10:17:58.908048 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce"
[0m10:17:58.908902 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce: BEGIN
[0m10:17:58.909679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:17:58.923650 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:17:58.925059 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce"
[0m10:17:58.926086 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "dev"."dbt_blue"."fact_taxi_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    'Mobile','Credit Card','Cash','Prcard','Unknown'
)



      
    ) dbt_internal_test
[0m10:17:58.945407 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:17:58.953866 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce: ROLLBACK
[0m10:17:58.955599 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce'
[0m10:17:58.956998 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce: Close
[0m10:17:58.963408 [error] [Thread-1 (]: 1 of 6 FAIL 1 accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown  [[31mFAIL 1[0m in 0.16s]
[0m10:17:58.965368 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce
[0m10:17:58.967064 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:17:58.968214 [info ] [Thread-1 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m10:17:58.969681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown.16fbbdacce, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34)
[0m10:17:58.970791 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:17:59.000719 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:17:59.012278 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:17:59.019264 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:17:59.030579 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:17:59.031813 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m10:17:59.032652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:59.051422 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:17:59.052942 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:17:59.054144 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m10:17:59.057279 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:17:59.061560 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m10:17:59.062748 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m10:17:59.063667 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m10:17:59.070297 [info ] [Thread-1 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.10s]
[0m10:17:59.072508 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:17:59.074656 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:17:59.076081 [info ] [Thread-1 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m10:17:59.077840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m10:17:59.079332 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:17:59.089560 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:17:59.099083 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:17:59.109944 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:17:59.120416 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:17:59.122043 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m10:17:59.123192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:59.144161 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:17:59.146529 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:17:59.147719 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m10:17:59.150233 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:59.153458 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m10:17:59.154658 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m10:17:59.155584 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m10:17:59.162786 [info ] [Thread-1 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m10:17:59.164810 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:17:59.166108 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:17:59.167105 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m10:17:59.168413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m10:17:59.169332 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:17:59.182259 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:17:59.189247 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:17:59.195956 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:17:59.205704 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:17:59.207162 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m10:17:59.208301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:59.226461 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:17:59.229455 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:17:59.230492 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m10:17:59.232680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:59.235808 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m10:17:59.236988 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m10:17:59.237887 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m10:17:59.246351 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.08s]
[0m10:17:59.248686 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:17:59.249990 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:17:59.251044 [info ] [Thread-1 (]: 5 of 6 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m10:17:59.252463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m10:17:59.253444 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:17:59.263049 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:17:59.271433 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:17:59.275953 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:17:59.285415 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:17:59.286527 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m10:17:59.287813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:59.313499 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m10:17:59.315139 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:17:59.316061 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m10:17:59.318225 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:17:59.321437 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m10:17:59.322632 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m10:17:59.323914 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m10:17:59.332021 [info ] [Thread-1 (]: 5 of 6 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m10:17:59.333893 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:17:59.335426 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:17:59.336600 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m10:17:59.338136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m10:17:59.339165 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:17:59.356844 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:17:59.366656 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:17:59.374460 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:17:59.385007 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:17:59.386576 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m10:17:59.388010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:59.406699 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:17:59.408542 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:17:59.410166 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:17:59.440670 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m10:17:59.444945 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m10:17:59.446506 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m10:17:59.447718 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m10:17:59.457253 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m10:17:59.458989 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:17:59.462366 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:59.463431 [debug] [MainThread]: On master: BEGIN
[0m10:17:59.464330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:59.483532 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m10:17:59.485033 [debug] [MainThread]: On master: COMMIT
[0m10:17:59.485959 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:59.486799 [debug] [MainThread]: On master: COMMIT
[0m10:17:59.487934 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:17:59.489031 [debug] [MainThread]: On master: Close
[0m10:17:59.498731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:59.500252 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m10:17:59.501613 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m10:17:59.502825 [info ] [MainThread]: 
[0m10:17:59.504200 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m10:17:59.506943 [debug] [MainThread]: Command end result
[0m10:17:59.635555 [info ] [MainThread]: 
[0m10:17:59.636953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:17:59.638140 [info ] [MainThread]: 
[0m10:17:59.639493 [error] [MainThread]: [31mFailure in test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown (models/99. datamart/datamarts.yml)[0m
[0m10:17:59.641011 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m10:17:59.642406 [info ] [MainThread]: 
[0m10:17:59.644610 [info ] [MainThread]:   compiled code at target/compiled/taxis_chicago/models/99. datamart/datamarts.yml/accepted_values_fact_taxi_trip_d40e4afcbbd8039441c6fc7a5a1dfd71.sql
[0m10:17:59.645883 [info ] [MainThread]: 
[0m10:17:59.647159 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:17:59.649355 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.256267, "process_user_time": 3.209963, "process_kernel_time": 0.30571, "process_mem_max_rss": "193740", "process_in_blocks": "808", "command_success": false, "process_out_blocks": "0"}
[0m10:17:59.650909 [debug] [MainThread]: Command `dbt test` failed at 10:17:59.650711 after 4.26 seconds
[0m10:17:59.652034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eced14ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec1f243d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec0eb6110>]}
[0m10:17:59.653072 [debug] [MainThread]: Flushing usage events
[0m10:19:40.574847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2894478af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28929816c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2892981660>]}


============================== 10:19:40.578250 | 7eb78897-92b0-46c0-a2aa-9a930a5edb62 ==============================
[0m10:19:40.578250 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:19:40.579389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:40.894373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eb78897-92b0-46c0-a2aa-9a930a5edb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f288f6bfd60>]}
[0m10:19:40.986404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eb78897-92b0-46c0-a2aa-9a930a5edb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2892bef970>]}
[0m10:19:40.987925 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:19:41.079794 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:19:43.426584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:43.428110 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/99. datamart/datamarts.yml
[0m10:19:44.148300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:19:44.159301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eb78897-92b0-46c0-a2aa-9a930a5edb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28874ddba0>]}
[0m10:19:44.360946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eb78897-92b0-46c0-a2aa-9a930a5edb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f288f71e3b0>]}
[0m10:19:44.362060 [info ] [MainThread]: Found 6 models, 6 data tests, 675 macros
[0m10:19:44.363696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eb78897-92b0-46c0-a2aa-9a930a5edb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2885144e80>]}
[0m10:19:44.367552 [info ] [MainThread]: 
[0m10:19:44.369599 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:19:44.379815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m10:19:44.433067 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:19:44.434237 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m10:19:44.435545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:44.455245 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m10:19:44.456348 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:19:44.457186 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m10:19:44.482401 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m10:19:44.491186 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m10:19:44.492828 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m10:19:44.493668 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m10:19:44.503386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eb78897-92b0-46c0-a2aa-9a930a5edb62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f288f71e350>]}
[0m10:19:44.505120 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:44.506008 [debug] [MainThread]: On master: BEGIN
[0m10:19:44.506790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:44.524092 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:19:44.525478 [debug] [MainThread]: On master: COMMIT
[0m10:19:44.526340 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:44.527202 [debug] [MainThread]: On master: COMMIT
[0m10:19:44.528310 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:19:44.529098 [debug] [MainThread]: On master: Close
[0m10:19:44.536384 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m10:19:44.537569 [info ] [MainThread]: 
[0m10:19:44.541195 [debug] [Thread-1 (]: Began running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:19:44.542142 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [RUN]
[0m10:19:44.543528 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m10:19:44.544497 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:19:44.565726 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:19:44.575692 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:19:44.605574 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:19:44.615628 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:19:44.616660 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: BEGIN
[0m10:19:44.617816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:19:44.635723 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:19:44.637655 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:19:44.638933 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "dev"."dbt_blue"."fact_taxi_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    'Mobile','Credit Card','Cash','Prcard','Unknown','No Charge'
)



      
    ) dbt_internal_test
[0m10:19:44.647218 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:19:44.655114 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: ROLLBACK
[0m10:19:44.656510 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m10:19:44.657567 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: Close
[0m10:19:44.661880 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [[32mPASS[0m in 0.12s]
[0m10:19:44.663632 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:19:44.664674 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:19:44.665573 [info ] [Thread-1 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m10:19:44.666873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34)
[0m10:19:44.667914 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:19:44.678292 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:19:44.690410 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:19:44.698356 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:19:44.707990 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:19:44.709438 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m10:19:44.710611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:44.729211 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:19:44.730809 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:19:44.732001 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m10:19:44.734487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:19:44.738076 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m10:19:44.739553 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m10:19:44.740697 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m10:19:44.747280 [info ] [Thread-1 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m10:19:44.748993 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:19:44.750303 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:19:44.751386 [info ] [Thread-1 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m10:19:44.753206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m10:19:44.754407 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:19:44.766190 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:19:44.775103 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:19:44.782105 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:19:44.791925 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:19:44.793436 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m10:19:44.795337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:44.813852 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:19:44.815390 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:19:44.816314 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m10:19:44.818609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:19:44.823485 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m10:19:44.825279 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m10:19:44.826314 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m10:19:44.833309 [info ] [Thread-1 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m10:19:44.835642 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:19:44.837139 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:19:44.838245 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m10:19:44.839818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m10:19:44.840798 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:19:44.853146 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:19:44.861393 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:19:44.869401 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:19:44.878461 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:19:44.879907 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m10:19:44.880798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:44.897896 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:19:44.899522 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:19:44.900731 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m10:19:44.903575 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:19:44.908672 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m10:19:44.909927 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m10:19:44.910926 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m10:19:44.917419 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.08s]
[0m10:19:44.920231 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:19:44.921756 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:19:44.923100 [info ] [Thread-1 (]: 5 of 6 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m10:19:44.924521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m10:19:44.925618 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:19:44.934921 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:19:44.944465 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:19:44.952118 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:19:44.962975 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:19:44.965219 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m10:19:44.966607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:44.985918 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:19:44.987817 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:19:44.989620 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m10:19:44.992563 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:19:44.995884 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m10:19:44.997212 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m10:19:44.998088 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m10:19:45.004720 [info ] [Thread-1 (]: 5 of 6 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m10:19:45.007196 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:19:45.008534 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:19:45.009615 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m10:19:45.010984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m10:19:45.011926 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:19:45.025793 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:19:45.034726 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:19:45.040206 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:19:45.048623 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:19:45.049832 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m10:19:45.050755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:45.067992 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m10:19:45.070972 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:19:45.072781 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:19:45.083470 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m10:19:45.087433 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m10:19:45.088957 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m10:19:45.090072 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m10:19:45.097999 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.09s]
[0m10:19:45.099550 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:19:45.102782 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:45.103791 [debug] [MainThread]: On master: BEGIN
[0m10:19:45.104695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:45.117612 [debug] [MainThread]: SQL status: OK in 0.013 seconds
[0m10:19:45.118696 [debug] [MainThread]: On master: COMMIT
[0m10:19:45.119896 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:45.120835 [debug] [MainThread]: On master: COMMIT
[0m10:19:45.122643 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:19:45.124263 [debug] [MainThread]: On master: Close
[0m10:19:45.131519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:45.132476 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m10:19:45.133235 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m10:19:45.134226 [info ] [MainThread]: 
[0m10:19:45.135666 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m10:19:45.142554 [debug] [MainThread]: Command end result
[0m10:19:45.256126 [info ] [MainThread]: 
[0m10:19:45.257814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:45.259262 [info ] [MainThread]: 
[0m10:19:45.260587 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:19:45.262749 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.777455, "process_user_time": 3.614764, "process_kernel_time": 0.39269, "process_mem_max_rss": "187672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:19:45.264018 [debug] [MainThread]: Command `dbt test` succeeded at 10:19:45.263862 after 4.78 seconds
[0m10:19:45.265018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2894478af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2893579060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28873d0dc0>]}
[0m10:19:45.266042 [debug] [MainThread]: Flushing usage events
[0m10:58:01.476560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45180a8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45165b56c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45165b5660>]}


============================== 10:58:01.480823 | d1408e6a-fdcb-42d8-80a3-074c972dcbb3 ==============================
[0m10:58:01.480823 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:58:01.482710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:01.921999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4513303d60>]}
[0m10:58:02.021980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f451681b970>]}
[0m10:58:02.024436 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:58:02.097318 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:58:04.462532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m10:58:04.463832 [debug] [MainThread]: Partial parsing: added file: taxis_chicago://models/99. datamart/dim_date.sql
[0m10:58:04.464712 [debug] [MainThread]: Partial parsing: added file: taxis_chicago://models/99. datamart/dim_time.sql
[0m10:58:04.465502 [debug] [MainThread]: Partial parsing: added file: taxis_chicago://models/99. datamart/dim_community_areas.sql
[0m10:58:04.844687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:58:04.856846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450aed6410>]}
[0m10:58:05.154239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450b0a2ec0>]}
[0m10:58:05.155336 [info ] [MainThread]: Found 9 models, 6 data tests, 675 macros
[0m10:58:05.156305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450b0a04c0>]}
[0m10:58:05.159857 [info ] [MainThread]: 
[0m10:58:05.161227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:05.175028 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:58:05.239905 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:58:05.241691 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m10:58:05.242586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:05.273645 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m10:58:05.276809 [debug] [ThreadPool]: On list_dev: Close
[0m10:58:05.282013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m10:58:05.283249 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m10:58:05.296200 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:58:05.297463 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m10:58:05.298502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:05.315535 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:58:05.319207 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:58:05.320490 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m10:58:05.321831 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:58:05.322698 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:58:05.323497 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m10:58:05.326180 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:58:05.327791 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m10:58:05.328559 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m10:58:05.329472 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m10:58:05.331175 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:58:05.332382 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m10:58:05.341075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m10:58:05.351619 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:58:05.352801 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m10:58:05.353677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:05.365571 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m10:58:05.366638 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:58:05.368663 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m10:58:05.392591 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m10:58:05.400064 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m10:58:05.402564 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m10:58:05.403579 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m10:58:05.413580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45181818d0>]}
[0m10:58:05.415154 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:05.416049 [debug] [MainThread]: On master: BEGIN
[0m10:58:05.416829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:05.433606 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:58:05.435104 [debug] [MainThread]: On master: COMMIT
[0m10:58:05.435933 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:05.436680 [debug] [MainThread]: On master: COMMIT
[0m10:58:05.437788 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:58:05.438542 [debug] [MainThread]: On master: Close
[0m10:58:05.442140 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m10:58:05.443291 [info ] [MainThread]: 
[0m10:58:05.448280 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m10:58:05.449669 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m10:58:05.451159 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m10:58:05.452169 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m10:58:05.471580 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m10:58:05.480559 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m10:58:05.537727 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m10:58:05.549193 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m10:58:05.551202 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m10:58:05.552089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:05.566485 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m10:58:05.568247 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m10:58:05.569498 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m10:58:05.623956 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m10:58:05.635010 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m10:58:05.636312 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m10:58:05.638144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:05.668244 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m10:58:05.670079 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m10:58:05.670975 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m10:58:05.694155 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m10:58:05.704650 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m10:58:05.706263 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m10:58:05.708911 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:05.713783 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m10:58:05.745511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4517f465c0>]}
[0m10:58:05.747172 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.29s]
[0m10:58:05.748916 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m10:58:05.750201 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m10:58:05.751305 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m10:58:05.752486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m10:58:05.753313 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m10:58:05.758205 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m10:58:05.770754 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m10:58:05.779518 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m10:58:05.789953 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m10:58:05.791295 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m10:58:05.792356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:05.810784 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m10:58:05.812536 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m10:58:05.814124 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m10:58:05.864677 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m10:58:05.870525 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m10:58:05.871598 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:58:05.873365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:05.875908 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m10:58:05.876875 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m10:58:05.877925 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m10:58:05.884861 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:58:05.895027 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m10:58:05.896161 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m10:58:05.897710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:05.900626 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m10:58:05.946865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450b0cb460>]}
[0m10:58:05.956179 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.19s]
[0m10:58:05.959365 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m10:58:05.960867 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m10:58:05.962237 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m10:58:05.963942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m10:58:05.964989 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m10:58:05.970765 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m10:58:05.978648 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m10:58:05.989713 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m10:58:05.998086 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m10:58:05.999748 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m10:58:06.001616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.023362 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:58:06.025102 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m10:58:06.026466 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m10:58:06.048824 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:58:06.057570 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m10:58:06.058912 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m10:58:06.061119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:06.063880 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m10:58:06.064861 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m10:58:06.065652 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m10:58:06.113315 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m10:58:06.120532 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m10:58:06.121981 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m10:58:06.123676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:06.125737 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m10:58:06.157528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4508bfad40>]}
[0m10:58:06.159000 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.19s]
[0m10:58:06.160773 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m10:58:06.161931 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m10:58:06.163014 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m10:58:06.164263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m10:58:06.165154 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m10:58:06.170305 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.176357 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m10:58:06.210422 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.222005 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.223263 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m10:58:06.224209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.243830 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m10:58:06.245254 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.246112 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m10:58:06.308002 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:58:06.313472 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.314676 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m10:58:06.316042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:06.322016 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.322952 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m10:58:06.324178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:06.328698 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m10:58:06.329925 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.330877 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m10:58:06.335540 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:58:06.341029 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m10:58:06.341964 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m10:58:06.344859 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:06.346961 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m10:58:06.358835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450ae74c10>]}
[0m10:58:06.360384 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.19s]
[0m10:58:06.362181 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m10:58:06.364394 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m10:58:06.367049 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m10:58:06.368517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m10:58:06.369932 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m10:58:06.379544 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.391820 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m10:58:06.400658 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.412207 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.414028 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m10:58:06.415485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.436851 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:58:06.438716 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.440066 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m10:58:06.502091 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m10:58:06.507741 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.508802 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m10:58:06.510472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:06.515395 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.516268 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m10:58:06.517613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:06.519929 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m10:58:06.520715 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.521598 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m10:58:06.526161 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:58:06.530541 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m10:58:06.531484 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m10:58:06.534036 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:06.536064 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m10:58:06.548528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45082d7f70>]}
[0m10:58:06.549970 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.18s]
[0m10:58:06.551537 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m10:58:06.553162 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m10:58:06.554635 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m10:58:06.555897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m10:58:06.556836 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m10:58:06.564270 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.573238 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m10:58:06.588070 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.596542 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.598335 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m10:58:06.600481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.622689 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m10:58:06.624407 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.625524 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m10:58:06.690908 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m10:58:06.699265 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.700480 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m10:58:06.701916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:06.706507 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.707696 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m10:58:06.709196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:06.711334 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m10:58:06.712206 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.713220 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m10:58:06.718943 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:58:06.724832 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m10:58:06.725749 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m10:58:06.728284 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:06.731101 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m10:58:06.744070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4508300f40>]}
[0m10:58:06.745552 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.19s]
[0m10:58:06.747563 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m10:58:06.749191 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m10:58:06.750557 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m10:58:06.752042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m10:58:06.752877 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m10:58:06.759713 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.769233 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m10:58:06.780438 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.791780 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.793002 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m10:58:06.793871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.814616 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:58:06.816237 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.818216 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m10:58:06.879609 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m10:58:06.887550 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.888652 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m10:58:06.890077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:06.894857 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.895757 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m10:58:06.897239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:06.899639 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m10:58:06.900892 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.901928 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m10:58:06.907070 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:58:06.913015 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m10:58:06.914362 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m10:58:06.917551 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:06.919888 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m10:58:06.932214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450ae77340>]}
[0m10:58:06.933929 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.18s]
[0m10:58:06.935875 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m10:58:06.937572 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m10:58:06.938572 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m10:58:06.939737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m10:58:06.940616 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m10:58:06.947483 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m10:58:06.953746 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m10:58:06.959150 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m10:58:06.968061 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:58:06.969497 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m10:58:06.970558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:06.991374 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:58:06.992944 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:58:06.993893 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m10:58:07.055155 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m10:58:07.061755 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:58:07.062723 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m10:58:07.064198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:58:07.068818 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:58:07.070529 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m10:58:07.072262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:07.074700 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m10:58:07.075560 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:58:07.076516 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m10:58:07.081837 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:58:07.088974 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m10:58:07.090479 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m10:58:07.093539 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:07.095545 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m10:58:07.111954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4508bfab60>]}
[0m10:58:07.113361 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.17s]
[0m10:58:07.115607 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m10:58:07.118196 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m10:58:07.119582 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m10:58:07.121020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m10:58:07.121962 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m10:58:07.132509 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.140680 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m10:58:07.149603 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.158996 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.160313 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m10:58:07.161473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:07.182347 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:58:07.185209 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.186952 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m10:58:07.296558 [debug] [Thread-1 (]: SQL status: OK in 0.108 seconds
[0m10:58:07.305853 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.307585 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m10:58:07.310143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:07.315816 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.316752 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m10:58:07.318306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:58:07.320625 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m10:58:07.321466 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.322493 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m10:58:07.330480 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:58:07.335954 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m10:58:07.336864 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m10:58:07.339770 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:58:07.341997 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m10:58:07.369674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1408e6a-fdcb-42d8-80a3-074c972dcbb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45167173a0>]}
[0m10:58:07.371721 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.25s]
[0m10:58:07.373135 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m10:58:07.376212 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:07.377236 [debug] [MainThread]: On master: BEGIN
[0m10:58:07.378026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:07.396201 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m10:58:07.397957 [debug] [MainThread]: On master: COMMIT
[0m10:58:07.399441 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:07.400646 [debug] [MainThread]: On master: COMMIT
[0m10:58:07.402591 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:58:07.403589 [debug] [MainThread]: On master: Close
[0m10:58:07.410625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:07.411592 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m10:58:07.412793 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m10:58:07.414394 [info ] [MainThread]: 
[0m10:58:07.415960 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m10:58:07.419785 [debug] [MainThread]: Command end result
[0m10:58:07.530649 [info ] [MainThread]: 
[0m10:58:07.532297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:07.533808 [info ] [MainThread]: 
[0m10:58:07.536453 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m10:58:07.539181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.159514, "process_user_time": 4.32739, "process_kernel_time": 0.734285, "process_mem_max_rss": "226032", "process_in_blocks": "138784", "process_out_blocks": "0"}
[0m10:58:07.541072 [debug] [MainThread]: Command `dbt run` succeeded at 10:58:07.540942 after 6.16 seconds
[0m10:58:07.541893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45180a8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45171a9060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4517a5bb20>]}
[0m10:58:07.542706 [debug] [MainThread]: Flushing usage events
[0m10:59:36.707823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae6a40b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae4f01720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae4f016c0>]}


============================== 10:59:36.711900 | 92e360ce-54b1-4fcc-8a6f-17a9312de76e ==============================
[0m10:59:36.711900 [info ] [MainThread]: Running with dbt=1.8.4
[0m10:59:36.714587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:37.161227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92e360ce-54b1-4fcc-8a6f-17a9312de76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae1c67d30>]}
[0m10:59:37.261912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92e360ce-54b1-4fcc-8a6f-17a9312de76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae1ca1990>]}
[0m10:59:37.264034 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m10:59:37.332908 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m10:59:39.327437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:39.328345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:39.337971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m10:59:39.399286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92e360ce-54b1-4fcc-8a6f-17a9312de76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead9ad4f70>]}
[0m10:59:39.631849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92e360ce-54b1-4fcc-8a6f-17a9312de76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead9d07a30>]}
[0m10:59:39.634066 [info ] [MainThread]: Found 9 models, 6 data tests, 675 macros
[0m10:59:39.635085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e360ce-54b1-4fcc-8a6f-17a9312de76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead9da6350>]}
[0m10:59:39.638570 [info ] [MainThread]: 
[0m10:59:39.640043 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:59:39.652899 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m10:59:39.831339 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:59:39.832523 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m10:59:39.833259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:39.862586 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m10:59:39.864079 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m10:59:39.864963 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m10:59:39.901571 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m10:59:39.911642 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m10:59:39.915305 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m10:59:39.916482 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m10:59:39.928983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e360ce-54b1-4fcc-8a6f-17a9312de76e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead9ae0370>]}
[0m10:59:39.930904 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:39.931803 [debug] [MainThread]: On master: BEGIN
[0m10:59:39.932638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:39.950573 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m10:59:39.951940 [debug] [MainThread]: On master: COMMIT
[0m10:59:39.952682 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:39.953374 [debug] [MainThread]: On master: COMMIT
[0m10:59:39.954463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:59:39.955185 [debug] [MainThread]: On master: Close
[0m10:59:39.960966 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m10:59:39.965191 [info ] [MainThread]: 
[0m10:59:39.971152 [debug] [Thread-1 (]: Began running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:59:39.972326 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [RUN]
[0m10:59:39.973979 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m10:59:39.975388 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:59:40.007833 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:59:40.018891 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:59:40.049998 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:59:40.059200 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:59:40.060317 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: BEGIN
[0m10:59:40.061581 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:40.081745 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:59:40.083808 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m10:59:40.085071 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "dev"."dbt_blue"."fact_taxi_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    'Mobile','Credit Card','Cash','Prcard','Unknown','No Charge'
)



      
    ) dbt_internal_test
[0m10:59:40.098999 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m10:59:40.107365 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: ROLLBACK
[0m10:59:40.108871 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m10:59:40.109990 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: Close
[0m10:59:40.117946 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [[32mPASS[0m in 0.14s]
[0m10:59:40.119558 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m10:59:40.120784 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:59:40.121869 [info ] [Thread-1 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m10:59:40.123206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34)
[0m10:59:40.124375 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:59:40.156713 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:59:40.169149 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:59:40.175523 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:59:40.186235 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:59:40.187819 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m10:59:40.188892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:40.210309 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:59:40.212650 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m10:59:40.214766 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m10:59:40.218436 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:59:40.221767 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m10:59:40.223305 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m10:59:40.224383 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m10:59:40.231844 [info ] [Thread-1 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.11s]
[0m10:59:40.233733 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m10:59:40.235078 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:59:40.236335 [info ] [Thread-1 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m10:59:40.237712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m10:59:40.238686 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:59:40.251475 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:59:40.265157 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:59:40.272177 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:59:40.283409 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:59:40.284885 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m10:59:40.286079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:40.307421 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:59:40.309148 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m10:59:40.310369 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m10:59:40.314070 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:59:40.318142 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m10:59:40.319596 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m10:59:40.320775 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m10:59:40.328235 [info ] [Thread-1 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m10:59:40.330974 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m10:59:40.332362 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:59:40.333487 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m10:59:40.335116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m10:59:40.336236 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:59:40.350940 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:59:40.359537 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:59:40.368194 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:59:40.377747 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:59:40.379110 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m10:59:40.380367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:40.402779 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m10:59:40.404568 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m10:59:40.405815 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m10:59:40.408070 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:59:40.411347 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m10:59:40.412643 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m10:59:40.413620 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m10:59:40.422429 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m10:59:40.424753 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m10:59:40.426323 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:59:40.427612 [info ] [Thread-1 (]: 5 of 6 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m10:59:40.429540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m10:59:40.430768 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:59:40.441410 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:59:40.451256 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:59:40.458493 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:59:40.468567 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:59:40.470550 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m10:59:40.471845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:40.493341 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m10:59:40.495629 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m10:59:40.496921 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m10:59:40.499781 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:59:40.503977 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m10:59:40.505401 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m10:59:40.506665 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m10:59:40.519091 [info ] [Thread-1 (]: 5 of 6 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m10:59:40.523109 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m10:59:40.524981 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:59:40.527065 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m10:59:40.529007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m10:59:40.530941 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:59:40.552544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:59:40.563249 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:59:40.570170 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:59:40.582406 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:59:40.584287 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m10:59:40.585267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:40.605070 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m10:59:40.606826 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m10:59:40.608034 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:59:40.632867 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m10:59:40.637844 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m10:59:40.639480 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m10:59:40.640539 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m10:59:40.650456 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m10:59:40.652724 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m10:59:40.656080 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:40.657087 [debug] [MainThread]: On master: BEGIN
[0m10:59:40.657867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:40.677230 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m10:59:40.680755 [debug] [MainThread]: On master: COMMIT
[0m10:59:40.683662 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:40.685547 [debug] [MainThread]: On master: COMMIT
[0m10:59:40.687747 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:59:40.689134 [debug] [MainThread]: On master: Close
[0m10:59:40.698004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:40.699177 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m10:59:40.700079 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m10:59:40.701086 [info ] [MainThread]: 
[0m10:59:40.702393 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m10:59:40.706268 [debug] [MainThread]: Command end result
[0m10:59:40.814336 [info ] [MainThread]: 
[0m10:59:40.816095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:40.817862 [info ] [MainThread]: 
[0m10:59:40.819184 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:59:40.822263 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.20594, "process_user_time": 3.562811, "process_kernel_time": 0.351117, "process_mem_max_rss": "186028", "process_in_blocks": "132640", "process_out_blocks": "0"}
[0m10:59:40.823629 [debug] [MainThread]: Command `dbt test` succeeded at 10:59:40.823472 after 4.21 seconds
[0m10:59:40.824550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae6a40b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feae6278d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead9d07a30>]}
[0m10:59:40.825441 [debug] [MainThread]: Flushing usage events
[0m11:02:04.206350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371c6e4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371abb5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371abb56c0>]}


============================== 11:02:04.212491 | bd8c0860-9baa-4633-bfbc-753bf1535987 ==============================
[0m11:02:04.212491 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:02:04.213936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:04.706034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd8c0860-9baa-4633-bfbc-753bf1535987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371c0bac20>]}
[0m11:02:04.808924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd8c0860-9baa-4633-bfbc-753bf1535987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371ae37700>]}
[0m11:02:04.811817 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:02:04.894004 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:02:07.445013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:07.446388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:07.457463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:02:07.519029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8c0860-9baa-4633-bfbc-753bf1535987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370f6d4fa0>]}
[0m11:02:07.750380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8c0860-9baa-4633-bfbc-753bf1535987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370f6dc7c0>]}
[0m11:02:07.751985 [info ] [MainThread]: Found 9 models, 6 data tests, 675 macros
[0m11:02:07.753206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8c0860-9baa-4633-bfbc-753bf1535987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370f6cb5e0>]}
[0m11:02:07.757123 [info ] [MainThread]: 
[0m11:02:07.758775 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:02:07.773351 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m11:02:07.957107 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:02:07.958642 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:02:07.959537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:07.989369 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m11:02:07.991246 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:02:07.992252 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:02:08.024276 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m11:02:08.035640 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:02:08.038736 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:02:08.039947 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:02:08.054904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8c0860-9baa-4633-bfbc-753bf1535987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370f6de140>]}
[0m11:02:08.056453 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:08.057496 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.058290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:08.078441 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m11:02:08.079859 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.081104 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:08.082098 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.083832 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:08.084958 [debug] [MainThread]: On master: Close
[0m11:02:08.092330 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:02:08.093622 [info ] [MainThread]: 
[0m11:02:08.100676 [debug] [Thread-1 (]: Began running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:02:08.102047 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [RUN]
[0m11:02:08.103806 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m11:02:08.104806 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:02:08.138251 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:02:08.148165 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:02:08.181767 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:02:08.191882 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:02:08.193069 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: BEGIN
[0m11:02:08.193967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:08.214120 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:02:08.216164 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:02:08.217924 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "dev"."dbt_blue"."fact_taxi_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    'Mobile','Credit Card','Cash','Prcard','Unknown','No Charge'
)



      
    ) dbt_internal_test
[0m11:02:08.234775 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m11:02:08.243858 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: ROLLBACK
[0m11:02:08.245328 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m11:02:08.246755 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: Close
[0m11:02:08.256143 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [[32mPASS[0m in 0.15s]
[0m11:02:08.258431 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:02:08.259786 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:02:08.261069 [info ] [Thread-1 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m11:02:08.262539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34)
[0m11:02:08.263606 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:02:08.298829 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:02:08.309613 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:02:08.317391 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:02:08.327357 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:02:08.328527 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m11:02:08.329451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.350014 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:02:08.351626 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:02:08.352827 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:02:08.356997 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:02:08.360214 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m11:02:08.361610 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:02:08.362564 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m11:02:08.371217 [info ] [Thread-1 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.11s]
[0m11:02:08.373329 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:02:08.374720 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:02:08.375857 [info ] [Thread-1 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m11:02:08.377395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m11:02:08.378291 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:02:08.389533 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:02:08.400460 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:02:08.409749 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:02:08.422981 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:02:08.424256 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m11:02:08.425281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.447025 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m11:02:08.448914 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:02:08.450590 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:02:08.453659 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:02:08.456902 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m11:02:08.458116 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m11:02:08.458983 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m11:02:08.467706 [info ] [Thread-1 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m11:02:08.470752 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:02:08.472118 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:02:08.473326 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m11:02:08.474848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m11:02:08.475774 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:02:08.491837 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:02:08.501494 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:02:08.507625 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:02:08.517017 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:02:08.518336 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m11:02:08.519527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.539891 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:02:08.542265 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:02:08.543441 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m11:02:08.547194 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:02:08.551548 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m11:02:08.553089 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m11:02:08.554535 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m11:02:08.559330 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.08s]
[0m11:02:08.561200 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:02:08.562938 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:02:08.565539 [info ] [Thread-1 (]: 5 of 6 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m11:02:08.569434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m11:02:08.571380 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:02:08.581334 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:02:08.591510 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:02:08.598867 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:02:08.608497 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:02:08.609763 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m11:02:08.610963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.629937 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:02:08.632083 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:02:08.633348 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m11:02:08.636512 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:02:08.639819 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m11:02:08.640943 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m11:02:08.641780 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m11:02:08.648875 [info ] [Thread-1 (]: 5 of 6 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m11:02:08.651143 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:02:08.652238 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:02:08.653256 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m11:02:08.654705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m11:02:08.655698 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:02:08.673477 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:02:08.683535 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:02:08.691873 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:02:08.702357 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:02:08.703755 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m11:02:08.704929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.725826 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m11:02:08.727646 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:02:08.728817 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:02:08.757198 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:02:08.762821 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m11:02:08.764727 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m11:02:08.766183 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m11:02:08.776357 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m11:02:08.778287 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:02:08.781579 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:08.782839 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.783782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:08.804743 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m11:02:08.806649 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.808047 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:08.809079 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.810693 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:02:08.811640 [debug] [MainThread]: On master: Close
[0m11:02:08.818821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:08.820068 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:02:08.821419 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m11:02:08.822683 [info ] [MainThread]: 
[0m11:02:08.824048 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m11:02:08.826606 [debug] [MainThread]: Command end result
[0m11:02:08.939481 [info ] [MainThread]: 
[0m11:02:08.941061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:08.942316 [info ] [MainThread]: 
[0m11:02:08.943501 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:02:08.946381 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.8459096, "process_user_time": 3.583576, "process_kernel_time": 0.621017, "process_mem_max_rss": "192428", "process_in_blocks": "136928", "process_out_blocks": "0"}
[0m11:02:08.948007 [debug] [MainThread]: Command `dbt test` succeeded at 11:02:08.947847 after 4.85 seconds
[0m11:02:08.949025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371c6e4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f371ac79d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370e7791e0>]}
[0m11:02:08.950133 [debug] [MainThread]: Flushing usage events
[0m11:06:13.978992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fe1f4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fc6f3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fc6f3b20>]}


============================== 11:06:13.982673 | bc10a4db-26d1-4f9f-8ad6-2980f6d0085b ==============================
[0m11:06:13.982673 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:06:13.984071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'True', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target green --empty', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:06:14.283124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fe085ed0>]}
[0m11:06:14.376358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fc777a90>]}
[0m11:06:14.377940 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:06:14.459303 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m11:06:14.611574 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:06:14.613473 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m11:06:14.616324 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:06:14.618178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fd308460>]}
[0m11:06:19.423806 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:06:19.437418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f0ce43a0>]}
[0m11:06:19.656819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f0c40220>]}
[0m11:06:19.658462 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:06:19.659602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50026c760>]}
[0m11:06:19.663947 [info ] [MainThread]: 
[0m11:06:19.666040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:06:19.674729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:06:19.726131 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:06:19.727175 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:06:19.727922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:19.752254 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m11:06:19.755506 [debug] [ThreadPool]: On list_dev: Close
[0m11:06:19.761220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_green)
[0m11:06:19.762271 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_green"
"
[0m11:06:19.773681 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_green"
[0m11:06:19.775037 [debug] [ThreadPool]: On create_dev_dbt_green: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "create_dev_dbt_green"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:06:19.775883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:19.793734 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m11:06:19.798102 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_green"
[0m11:06:19.799521 [debug] [ThreadPool]: On create_dev_dbt_green: BEGIN
[0m11:06:19.801913 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:06:19.802810 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_green"
[0m11:06:19.803634 [debug] [ThreadPool]: On create_dev_dbt_green: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "create_dev_dbt_green"} */

    
    
        create schema if not exists "dev"."dbt_green"
    
[0m11:06:19.805266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:06:19.806705 [debug] [ThreadPool]: On create_dev_dbt_green: COMMIT
[0m11:06:19.807461 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_green"
[0m11:06:19.808193 [debug] [ThreadPool]: On create_dev_dbt_green: COMMIT
[0m11:06:19.812551 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:06:19.813411 [debug] [ThreadPool]: On create_dev_dbt_green: Close
[0m11:06:19.827892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_green, now list_dev_dbt_green)
[0m11:06:19.838124 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_green"
[0m11:06:19.839125 [debug] [ThreadPool]: On list_dev_dbt_green: BEGIN
[0m11:06:19.839972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:19.856741 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m11:06:19.857685 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_green"
[0m11:06:19.858682 [debug] [ThreadPool]: On list_dev_dbt_green: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "list_dev_dbt_green"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_green'
    and table_catalog = 'dev'
  
[0m11:06:19.885212 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m11:06:19.887359 [debug] [ThreadPool]: On list_dev_dbt_green: ROLLBACK
[0m11:06:19.888468 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_green'
[0m11:06:19.889272 [debug] [ThreadPool]: On list_dev_dbt_green: Close
[0m11:06:19.893444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fc971e10>]}
[0m11:06:19.894858 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:19.896140 [debug] [MainThread]: On master: BEGIN
[0m11:06:19.897157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:19.916862 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m11:06:19.917922 [debug] [MainThread]: On master: COMMIT
[0m11:06:19.918749 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:19.919593 [debug] [MainThread]: On master: COMMIT
[0m11:06:19.920779 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:06:19.921652 [debug] [MainThread]: On master: Close
[0m11:06:19.925709 [info ] [MainThread]: Concurrency: 1 threads (target='green')
[0m11:06:19.926917 [info ] [MainThread]: 
[0m11:06:19.931169 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m11:06:19.932441 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_green.dim_community_areas ..................... [RUN]
[0m11:06:19.933871 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m11:06:19.934853 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m11:06:19.947066 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m11:06:19.953756 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m11:06:20.006780 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m11:06:20.015289 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:06:20.016450 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m11:06:20.017298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:20.033066 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m11:06:20.034783 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:06:20.035995 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_green"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m11:06:20.099587 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m11:06:20.111953 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:06:20.113816 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_green"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m11:06:20.115913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.139393 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:06:20.140953 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:06:20.141960 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:06:20.174304 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m11:06:20.183818 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:06:20.185150 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_green"."dim_community_areas__dbt_backup" cascade
[0m11:06:20.187452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.191586 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m11:06:20.224210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee7f3cd0>]}
[0m11:06:20.225889 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_green.dim_community_areas ................ [[32mOK[0m in 0.29s]
[0m11:06:20.227417 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m11:06:20.228428 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m11:06:20.229649 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_green.dim_date ................................ [RUN]
[0m11:06:20.230990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m11:06:20.233407 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m11:06:20.239847 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m11:06:20.246527 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m11:06:20.253760 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m11:06:20.260746 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:06:20.261553 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m11:06:20.262535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:20.279422 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m11:06:20.280705 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:06:20.283508 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_green"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m11:06:20.342982 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m11:06:20.348532 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:06:20.349712 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_green"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:06:20.351160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.353575 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:06:20.354490 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:06:20.355335 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:06:20.362723 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:06:20.368780 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:06:20.369928 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_green"."dim_date__dbt_backup" cascade
[0m11:06:20.371640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.373947 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m11:06:20.419834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ede123e0>]}
[0m11:06:20.421346 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_green.dim_date ........................... [[32mOK[0m in 0.19s]
[0m11:06:20.422878 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m11:06:20.423935 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m11:06:20.425181 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_green.dim_time ................................ [RUN]
[0m11:06:20.426475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m11:06:20.427430 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m11:06:20.436221 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m11:06:20.442829 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m11:06:20.448392 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m11:06:20.454679 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:06:20.455552 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m11:06:20.456313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:20.475910 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:06:20.477512 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:06:20.478717 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_green"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m11:06:20.497432 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m11:06:20.504366 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:06:20.505360 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_green"."dim_time__dbt_tmp" rename to "dim_time"
[0m11:06:20.506800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.509061 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:06:20.510104 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:06:20.511160 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:06:20.555658 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m11:06:20.560502 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:06:20.561626 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_green"."dim_time__dbt_backup" cascade
[0m11:06:20.563304 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.566835 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m11:06:20.601854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4f0c1af20>]}
[0m11:06:20.603346 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_green.dim_time ........................... [[32mOK[0m in 0.18s]
[0m11:06:20.604984 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m11:06:20.605995 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m11:06:20.607046 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_green.load_taxi_trips .......................... [RUN]
[0m11:06:20.608195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m11:06:20.609085 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m11:06:20.615269 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.622701 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m11:06:20.656812 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.667896 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.669403 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m11:06:20.670202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:20.693028 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:06:20.694528 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.695520 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_green"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m11:06:20.758150 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m11:06:20.763704 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.764706 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_green"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m11:06:20.766512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.769127 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:06:20.770033 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.771090 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:06:20.776757 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:06:20.785872 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:06:20.787057 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_green"."load_taxi_trips__dbt_backup" cascade
[0m11:06:20.788944 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.791407 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m11:06:20.812552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee76e6e0>]}
[0m11:06:20.814246 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_green.load_taxi_trips ..................... [[32mOK[0m in 0.20s]
[0m11:06:20.815873 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m11:06:20.817827 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m11:06:20.819244 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_green.stg_taxi_trips ........................... [RUN]
[0m11:06:20.820954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m11:06:20.822349 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m11:06:20.830481 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.839477 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m11:06:20.847535 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.859203 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.861043 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m11:06:20.862677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:20.889507 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:06:20.891177 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.892320 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_green"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from (select * from "dev"."dbt_green"."load_taxi_trips" where false limit 0)
  );

[0m11:06:20.956561 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m11:06:20.962273 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.963218 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_green"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m11:06:20.965033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.967677 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:06:20.968805 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.969767 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:06:20.975059 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:06:20.980664 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:06:20.981719 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_green"."stg_taxi_trips__dbt_backup" cascade
[0m11:06:20.983227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:20.985854 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m11:06:21.005195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee7bfdf0>]}
[0m11:06:21.006488 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_green.stg_taxi_trips ...................... [[32mOK[0m in 0.18s]
[0m11:06:21.007869 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m11:06:21.009724 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m11:06:21.010873 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_green.cleaned_taxi_trips ....................... [RUN]
[0m11:06:21.012320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m11:06:21.013485 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m11:06:21.023487 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.031921 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m11:06:21.041822 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.051259 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.052605 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m11:06:21.053916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:21.076599 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:06:21.078095 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.079008 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_green"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from (select * from "dev"."dbt_green"."stg_taxi_trips" where false limit 0)
  );

[0m11:06:21.139242 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m11:06:21.144770 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.145916 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_green"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m11:06:21.147563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:21.149659 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:06:21.150691 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.151682 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:06:21.156471 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:06:21.161352 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:06:21.162209 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_green"."cleaned_taxi_trips__dbt_backup" cascade
[0m11:06:21.163584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:06:21.167028 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m11:06:21.182669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee76e6b0>]}
[0m11:06:21.184056 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_green.cleaned_taxi_trips .................. [[32mOK[0m in 0.17s]
[0m11:06:21.185739 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m11:06:21.188097 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m11:06:21.189256 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_green.enriched_taxi_trips ...................... [RUN]
[0m11:06:21.190859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m11:06:21.191917 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m11:06:21.200441 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.208899 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m11:06:21.224639 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.238301 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.239455 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m11:06:21.240546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:21.266077 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:06:21.268746 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.270872 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_green"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from (select * from "dev"."dbt_green"."cleaned_taxi_trips" where false limit 0)
  );

[0m11:06:21.335676 [debug] [Thread-1 (]: SQL status: OK in 0.063 seconds
[0m11:06:21.341124 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.342342 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_green"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m11:06:21.344437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:21.346789 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:06:21.347750 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.348808 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:06:21.356087 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:06:21.360774 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:06:21.361757 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_green"."enriched_taxi_trips__dbt_backup" cascade
[0m11:06:21.363277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:21.367167 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m11:06:21.383621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee76e710>]}
[0m11:06:21.385421 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_green.enriched_taxi_trips ................. [[32mOK[0m in 0.19s]
[0m11:06:21.387061 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m11:06:21.388948 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m11:06:21.390137 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_green.structural_taxi_trips .................... [RUN]
[0m11:06:21.391403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m11:06:21.392483 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m11:06:21.401609 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.410175 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m11:06:21.419741 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.428330 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.429508 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m11:06:21.430874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:21.455116 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:06:21.456724 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.457886 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_green"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from (select * from "dev"."dbt_green"."enriched_taxi_trips" where false limit 0)
  );

[0m11:06:21.526252 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m11:06:21.610957 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.612606 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_green"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m11:06:21.614424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:06:21.616484 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:06:21.617536 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.618433 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:06:21.623168 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:06:21.628060 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:06:21.629170 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_green"."structural_taxi_trips__dbt_backup" cascade
[0m11:06:21.630696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:06:21.632690 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m11:06:21.646409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee7b4310>]}
[0m11:06:21.648240 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_green.structural_taxi_trips ............... [[32mOK[0m in 0.25s]
[0m11:06:21.650638 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m11:06:21.652650 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m11:06:21.654094 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_green.fact_taxi_trips ......................... [RUN]
[0m11:06:21.655711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m11:06:21.656703 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m11:06:21.663652 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.673218 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m11:06:21.681802 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.691608 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.692950 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m11:06:21.693832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:21.716186 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:06:21.718675 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.720082 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_green"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from (select * from "dev"."dbt_green"."structural_taxi_trips" where false limit 0)
)

select * from tmp_data
    );
  
  
[0m11:06:21.848066 [debug] [Thread-1 (]: SQL status: OK in 0.127 seconds
[0m11:06:21.858546 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.859803 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_green"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m11:06:21.862745 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:06:21.865992 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:06:21.867004 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.867892 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:06:21.873058 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:06:21.880346 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:06:21.881304 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_green"."fact_taxi_trips__dbt_backup" cascade
[0m11:06:21.882641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:06:21.884915 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m11:06:21.904290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc10a4db-26d1-4f9f-8ad6-2980f6d0085b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ee77eb90>]}
[0m11:06:21.905783 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_green.fact_taxi_trips .................... [[32mOK[0m in 0.25s]
[0m11:06:21.907538 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m11:06:21.909998 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:21.910929 [debug] [MainThread]: On master: BEGIN
[0m11:06:21.911917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:21.935453 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m11:06:21.937089 [debug] [MainThread]: On master: COMMIT
[0m11:06:21.938010 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:21.938798 [debug] [MainThread]: On master: COMMIT
[0m11:06:21.939932 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:06:21.940763 [debug] [MainThread]: On master: Close
[0m11:06:21.951062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:21.952184 [debug] [MainThread]: Connection 'list_dev_dbt_green' was properly closed.
[0m11:06:21.953568 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m11:06:21.955131 [info ] [MainThread]: 
[0m11:06:21.956566 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m11:06:21.960562 [debug] [MainThread]: Command end result
[0m11:06:22.069483 [info ] [MainThread]: 
[0m11:06:22.071732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:22.073931 [info ] [MainThread]: 
[0m11:06:22.075585 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:06:22.077859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.20436, "process_user_time": 6.436454, "process_kernel_time": 0.709609, "process_mem_max_rss": "237500", "process_in_blocks": "3360", "process_out_blocks": "0"}
[0m11:06:22.079401 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:22.079214 after 8.21 seconds
[0m11:06:22.080919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fe1f4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fd30bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fe085ed0>]}
[0m11:06:22.082125 [debug] [MainThread]: Flushing usage events
[0m11:06:37.351324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80a04a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7ef19540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7ef194e0>]}


============================== 11:06:37.356197 | 15de723e-7b7c-4f9f-a342-43a3b130c9a8 ==============================
[0m11:06:37.356197 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:06:37.357507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'send_anonymous_usage_stats': 'True'}
[0m11:06:37.671519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15de723e-7b7c-4f9f-a342-43a3b130c9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7bc5ea70>]}
[0m11:06:37.766919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15de723e-7b7c-4f9f-a342-43a3b130c9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7f10ac20>]}
[0m11:06:37.768827 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:06:37.866355 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m11:06:40.243292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:40.245457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:40.256859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:06:40.318789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15de723e-7b7c-4f9f-a342-43a3b130c9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd73901000>]}
[0m11:06:40.494891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15de723e-7b7c-4f9f-a342-43a3b130c9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd73900cd0>]}
[0m11:06:40.496026 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:06:40.497430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15de723e-7b7c-4f9f-a342-43a3b130c9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd73acdb40>]}
[0m11:06:40.499079 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m11:06:40.500080 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:06:40.500999 [debug] [MainThread]: On macro_publish: BEGIN
[0m11:06:40.502016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:40.526547 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m11:06:40.528847 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:06:40.532457 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:06:40.533738 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:06:40.536236 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:06:40.553804 [info ] [MainThread]: Merging into green environmet...
[0m11:06:40.596305 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:06:40.597532 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_bike_trips;

    
  
[0m11:06:40.624656 [debug] [MainThread]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_bike_trips;

    
  
[0m11:06:40.626791 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:06:40.628757 [debug] [MainThread]: On macro_publish: Close
[0m11:06:40.641267 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  Catalog Error: Table with name fact_bike_trips does not exist!
  Did you mean "fact_taxi_trips"?
  LINE 4: ...8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */
  
      
          CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_bike_trips;
                                                    ^
[0m11:06:40.650101 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py", line 84, in exception_handler
    yield
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 95, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/duckdb/environments/local.py", line 23, in execute
    return self._cursor.execute(sql)
duckdb.duckdb.CatalogException: Catalog Error: Table with name fact_bike_trips does not exist!
Did you mean "fact_taxi_trips"?
LINE 4: ...8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_bike_trips;
                                                  ^

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run_operation.py", line 62, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run_operation.py", line 47, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1131, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 335, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 35, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 356, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py", line 119, in execute
    return super().execute(sql, auto_begin, fetch, limit)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 157, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    with self.exception_handler(sql):
  File "/usr/local/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py", line 92, in exception_handler
    raise dbt.exceptions.DbtRuntimeError(str(exc)) from exc
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  Catalog Error: Table with name fact_bike_trips does not exist!
  Did you mean "fact_taxi_trips"?
  LINE 4: ...8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */
  
      
          CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_bike_trips;
                                                    ^

[0m11:06:40.667382 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 3.4159036, "process_user_time": 2.535867, "process_kernel_time": 0.240556, "process_mem_max_rss": "150680", "process_in_blocks": "4952", "command_success": false, "process_out_blocks": "0"}
[0m11:06:40.669752 [debug] [MainThread]: Command `dbt run-operation` failed at 11:06:40.669318 after 3.42 seconds
[0m11:06:40.671246 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m11:06:40.672393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80a04a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd73900eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd73902770>]}
[0m11:06:40.673522 [debug] [MainThread]: Flushing usage events
[0m11:07:04.850334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9eda4cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ebed15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ebed1540>]}


============================== 11:07:04.854766 | 1761d0d0-c507-4663-a1ad-ce3bd521b3ad ==============================
[0m11:07:04.854766 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:07:04.858389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'send_anonymous_usage_stats': 'True'}
[0m11:07:05.161415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1761d0d0-c507-4663-a1ad-ce3bd521b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e0d95e10>]}
[0m11:07:05.252928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1761d0d0-c507-4663-a1ad-ce3bd521b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ec133250>]}
[0m11:07:05.256581 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:07:05.349048 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m11:07:07.719842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:07.722333 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://macros/WAP.sql
[0m11:07:07.833646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:07:07.843903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1761d0d0-c507-4663-a1ad-ce3bd521b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e0804130>]}
[0m11:07:08.030250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1761d0d0-c507-4663-a1ad-ce3bd521b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e08071f0>]}
[0m11:07:08.031640 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:07:08.032717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1761d0d0-c507-4663-a1ad-ce3bd521b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e0817010>]}
[0m11:07:08.034186 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m11:07:08.034983 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:07:08.035826 [debug] [MainThread]: On macro_publish: BEGIN
[0m11:07:08.036571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:08.057663 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m11:07:08.059441 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:07:08.060884 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:07:08.061879 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:07:08.062950 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:07:08.076185 [info ] [MainThread]: Merging into green environmet...
[0m11:07:08.195599 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:07:08.196877 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;

    
  
[0m11:07:08.214736 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m11:07:08.217505 [info ] [MainThread]: Merge into green environmet done
[0m11:07:08.218677 [debug] [MainThread]: On macro_publish: Close
[0m11:07:08.282538 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 3.5250394, "process_user_time": 2.588798, "process_kernel_time": 0.329846, "process_mem_max_rss": "166180", "process_in_blocks": "56", "process_out_blocks": "0"}
[0m11:07:08.285188 [debug] [MainThread]: Command `dbt run-operation` succeeded at 11:07:08.284860 after 3.53 seconds
[0m11:07:08.293998 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m11:07:08.295942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9eda4cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e08073d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e0807610>]}
[0m11:07:08.298000 [debug] [MainThread]: Flushing usage events
[0m11:10:52.251356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1374cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad11c4fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad11c4fa90>]}


============================== 11:10:52.255172 | 03daf70f-e00b-41a8-a5d8-9add39c5a574 ==============================
[0m11:10:52.255172 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:10:52.256625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m11:10:52.559999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad135c9f90>]}
[0m11:10:52.659188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad06b2dc00>]}
[0m11:10:52.660771 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:10:52.724229 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:10:52.873581 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:10:52.875562 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m11:10:52.876724 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:10:52.877833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad128658d0>]}
[0m11:10:57.054650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:10:57.064526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad067e8d30>]}
[0m11:10:57.239171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0673abf0>]}
[0m11:10:57.241531 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:10:57.242528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0673a9b0>]}
[0m11:10:57.246359 [info ] [MainThread]: 
[0m11:10:57.248147 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:10:57.257836 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:10:57.314033 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:10:57.315444 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:10:57.316179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:57.341672 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m11:10:57.343812 [debug] [ThreadPool]: On list_dev: Close
[0m11:10:57.347687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m11:10:57.348685 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m11:10:57.360667 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:10:57.361778 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:10:57.362711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:57.375288 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m11:10:57.378882 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:10:57.379830 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m11:10:57.381773 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:10:57.382603 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:10:57.383370 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m11:10:57.385080 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:10:57.386809 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m11:10:57.387884 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:10:57.388809 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m11:10:57.393328 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:10:57.394089 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m11:10:57.406261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m11:10:57.417749 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:10:57.418722 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:10:57.419492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:57.432738 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m11:10:57.433605 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:10:57.434414 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:10:57.463856 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m11:10:57.466399 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:10:57.467501 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:10:57.468346 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:10:57.474973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad06802d40>]}
[0m11:10:57.476277 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:57.477184 [debug] [MainThread]: On master: BEGIN
[0m11:10:57.477986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:57.490470 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m11:10:57.491356 [debug] [MainThread]: On master: COMMIT
[0m11:10:57.492718 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:57.493714 [debug] [MainThread]: On master: COMMIT
[0m11:10:57.494989 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:10:57.495934 [debug] [MainThread]: On master: Close
[0m11:10:57.499952 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:10:57.501065 [info ] [MainThread]: 
[0m11:10:57.505425 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m11:10:57.508404 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m11:10:57.510779 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m11:10:57.512024 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m11:10:57.526284 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m11:10:57.534938 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m11:10:57.587596 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m11:10:57.597122 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:10:57.598086 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m11:10:57.598869 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:57.614521 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m11:10:57.616274 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:10:57.617403 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m11:10:57.666648 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m11:10:57.680756 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:10:57.683317 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m11:10:57.685502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:57.710014 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:10:57.711426 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:10:57.712420 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:10:57.733260 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m11:10:57.742442 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:10:57.743512 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m11:10:57.744817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:57.748067 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m11:10:57.780552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad135ca650>]}
[0m11:10:57.781938 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.27s]
[0m11:10:57.783245 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m11:10:57.784173 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m11:10:57.785285 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m11:10:57.786658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m11:10:57.787834 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m11:10:57.795176 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m11:10:57.803570 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m11:10:57.812160 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m11:10:57.818717 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:10:57.819521 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m11:10:57.820252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:57.836912 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m11:10:57.838746 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:10:57.840224 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m11:10:57.892656 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m11:10:57.898901 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:10:57.900167 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:10:57.901395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:57.903458 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:10:57.904476 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:10:57.905580 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:10:57.912586 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m11:10:57.918286 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:10:57.919436 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m11:10:57.920948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:57.923091 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m11:10:57.967698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad06907a90>]}
[0m11:10:57.969374 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.18s]
[0m11:10:57.970851 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m11:10:57.971906 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m11:10:57.973006 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m11:10:57.974144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m11:10:57.975007 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m11:10:57.981091 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m11:10:57.987946 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m11:10:57.992865 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m11:10:57.999602 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:10:58.000392 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m11:10:58.001181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:58.018825 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m11:10:58.020217 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:10:58.021334 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m11:10:58.042862 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m11:10:58.051206 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:10:58.052777 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m11:10:58.054321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:58.056798 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:10:58.057809 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:10:58.058595 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:10:58.105730 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m11:10:58.110756 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:10:58.111707 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m11:10:58.113635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:58.116029 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m11:10:58.144358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad04536c80>]}
[0m11:10:58.145773 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.17s]
[0m11:10:58.147348 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m11:10:58.148453 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m11:10:58.149492 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m11:10:58.150700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m11:10:58.151518 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m11:10:58.156494 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.163433 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m11:10:58.189184 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.196943 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.198226 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m11:10:58.199072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:58.218151 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:10:58.219575 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.220763 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m11:10:58.283641 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m11:10:58.291388 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.292421 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m11:10:58.293896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:58.295798 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:10:58.296855 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.297944 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:10:58.302894 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:10:58.309106 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:10:58.310145 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m11:10:58.311531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:58.313769 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m11:10:58.324997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad0670f5b0>]}
[0m11:10:58.326446 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.17s]
[0m11:10:58.328211 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m11:10:58.329914 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m11:10:58.330922 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m11:10:58.332170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m11:10:58.332973 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m11:10:58.338671 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.345379 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m11:10:58.350916 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.359359 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.360678 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m11:10:58.361476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:58.378920 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m11:10:58.380479 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.381466 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m11:10:58.443920 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m11:10:58.451007 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.452068 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m11:10:58.453667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:58.455972 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:10:58.456965 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.458036 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:10:58.465978 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:10:58.472709 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:10:58.474000 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m11:10:58.475808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:58.478083 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m11:10:58.488158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad042cbd90>]}
[0m11:10:58.489456 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.16s]
[0m11:10:58.491154 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m11:10:58.493277 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m11:10:58.494579 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m11:10:58.496126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m11:10:58.497143 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m11:10:58.507000 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.514539 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m11:10:58.519924 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.533343 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.534912 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m11:10:58.535862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:58.553781 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m11:10:58.555880 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.557378 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m11:10:58.618974 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m11:10:58.625105 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.626359 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m11:10:58.627702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:58.629681 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:10:58.630752 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.631629 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:10:58.635916 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:10:58.640246 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:10:58.641349 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m11:10:58.643081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:58.645624 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m11:10:58.660537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad06958f40>]}
[0m11:10:58.662930 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.16s]
[0m11:10:58.664529 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m11:10:58.666731 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m11:10:58.667932 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m11:10:58.669341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m11:10:58.670236 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m11:10:58.677672 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.684133 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m11:10:58.692276 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.702756 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.705768 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m11:10:58.707090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:58.725932 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:10:58.728032 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.729081 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m11:10:58.790044 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m11:10:58.795406 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.796314 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m11:10:58.797661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:10:58.799433 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:10:58.800261 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.801126 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:10:58.805650 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:10:58.811777 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:10:58.812739 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m11:10:58.814517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:58.816634 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m11:10:58.828526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff513610>]}
[0m11:10:58.829856 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.16s]
[0m11:10:58.831312 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m11:10:58.833145 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m11:10:58.834176 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m11:10:58.835338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m11:10:58.836210 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m11:10:58.841883 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m11:10:58.851074 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m11:10:58.858807 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m11:10:58.866289 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:10:58.867473 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m11:10:58.868304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:58.887766 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:10:58.889740 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:10:58.891298 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m11:10:58.953229 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m11:10:59.034009 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:10:59.035528 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m11:10:59.037178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:59.039881 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:10:59.041639 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:10:59.042543 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:10:59.047805 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:10:59.053123 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:10:59.054632 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m11:10:59.056481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:59.059440 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m11:10:59.076442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facff513610>]}
[0m11:10:59.078150 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.24s]
[0m11:10:59.079823 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m11:10:59.081794 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m11:10:59.082993 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m11:10:59.084578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m11:10:59.085534 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m11:10:59.092590 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.103022 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m11:10:59.112158 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.119667 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.120808 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m11:10:59.122013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:59.145768 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:10:59.147829 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.149549 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m11:10:59.281849 [debug] [Thread-1 (]: SQL status: OK in 0.131 seconds
[0m11:10:59.288696 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.289576 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m11:10:59.290934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:59.292867 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:10:59.293675 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.294558 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:10:59.302105 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m11:10:59.308168 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:10:59.309161 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m11:10:59.310651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:10:59.312566 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m11:10:59.343737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03daf70f-e00b-41a8-a5d8-9add39c5a574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad041f00d0>]}
[0m11:10:59.345230 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.26s]
[0m11:10:59.346912 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m11:10:59.349518 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:59.350475 [debug] [MainThread]: On master: BEGIN
[0m11:10:59.351428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:59.371302 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m11:10:59.373376 [debug] [MainThread]: On master: COMMIT
[0m11:10:59.374579 [debug] [MainThread]: Using duckdb connection "master"
[0m11:10:59.375481 [debug] [MainThread]: On master: COMMIT
[0m11:10:59.376679 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:10:59.377709 [debug] [MainThread]: On master: Close
[0m11:10:59.384462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:59.385402 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:10:59.386184 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m11:10:59.387386 [info ] [MainThread]: 
[0m11:10:59.390181 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m11:10:59.393571 [debug] [MainThread]: Command end result
[0m11:10:59.494945 [info ] [MainThread]: 
[0m11:10:59.497743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:59.498969 [info ] [MainThread]: 
[0m11:10:59.500321 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:10:59.501998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3446617, "process_user_time": 6.262453, "process_kernel_time": 0.469434, "process_mem_max_rss": "238588", "process_in_blocks": "160", "process_out_blocks": "0"}
[0m11:10:59.503113 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:59.502949 after 7.35 seconds
[0m11:10:59.504113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad1374cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad123df6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad04646590>]}
[0m11:10:59.505228 [debug] [MainThread]: Flushing usage events
[0m11:11:13.345561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2250de8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224f231660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224f231600>]}


============================== 11:11:13.350289 | 0fe0bd32-3233-4baa-b9b6-c204e0511bfa ==============================
[0m11:11:13.350289 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:11:13.351368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'send_anonymous_usage_stats': 'True'}
[0m11:11:13.656451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fe0bd32-3233-4baa-b9b6-c204e0511bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f225077a8c0>]}
[0m11:11:13.748160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fe0bd32-3233-4baa-b9b6-c204e0511bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224f31dc90>]}
[0m11:11:13.750192 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:11:13.816261 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m11:11:13.965808 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:11:13.967378 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m11:11:13.968660 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:11:13.970712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fe0bd32-3233-4baa-b9b6-c204e0511bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224fe9d8d0>]}
[0m11:11:18.164791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:11:18.175167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fe0bd32-3233-4baa-b9b6-c204e0511bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2243dc0370>]}
[0m11:11:18.347175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fe0bd32-3233-4baa-b9b6-c204e0511bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2243d18940>]}
[0m11:11:18.348178 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:11:18.349380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe0bd32-3233-4baa-b9b6-c204e0511bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2250b68760>]}
[0m11:11:18.351366 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m11:11:18.352527 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:11:18.353937 [debug] [MainThread]: On macro_publish: BEGIN
[0m11:11:18.356697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:18.378025 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m11:11:18.379805 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:11:18.380859 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:11:18.381775 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:11:18.383786 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:11:18.394463 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m11:11:18.449613 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:11:18.451286 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m11:11:18.467761 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m11:11:18.470135 [info ] [MainThread]: Schema dbt_green created or already exists
[0m11:11:18.471824 [info ] [MainThread]: Merging into green environment...
[0m11:11:18.473370 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:11:18.474258 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m11:11:18.619257 [debug] [MainThread]: SQL status: OK in 0.144 seconds
[0m11:11:18.623223 [info ] [MainThread]: Merge into green environment done
[0m11:11:18.624743 [debug] [MainThread]: On macro_publish: Close
[0m11:11:18.732016 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.4708643, "process_user_time": 4.927112, "process_kernel_time": 0.304142, "process_mem_max_rss": "210060", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:11:18.733623 [debug] [MainThread]: Command `dbt run-operation` succeeded at 11:11:18.733433 after 5.47 seconds
[0m11:11:18.734783 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m11:11:18.735888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2250de8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2243d18a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2243d18f70>]}
[0m11:11:18.736936 [debug] [MainThread]: Flushing usage events
[0m11:28:16.269740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e08988b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e06e93a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e06e93a90>]}


============================== 11:28:16.273955 | d1c9b877-28d7-4fb8-a0a9-afcb129f0db4 ==============================
[0m11:28:16.273955 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:28:16.275340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:28:16.718511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e08825f90>]}
[0m11:28:16.821113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfbd25c00>]}
[0m11:28:16.823285 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:28:16.890422 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:28:17.034811 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:28:17.036017 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m11:28:17.037011 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:28:17.038090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e07aa98d0>]}
[0m11:28:21.823659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:28:21.835765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfb9e4d30>]}
[0m11:28:22.033045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfb93a9b0>]}
[0m11:28:22.034086 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:28:22.035582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfb93a830>]}
[0m11:28:22.038340 [info ] [MainThread]: 
[0m11:28:22.040034 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:28:22.051480 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:28:22.112375 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:28:22.113457 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:28:22.114331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:22.168728 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m11:28:22.171427 [debug] [ThreadPool]: On list_dev: Close
[0m11:28:22.176745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m11:28:22.178064 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m11:28:22.189340 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:28:22.190612 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:28:22.191532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:22.208985 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m11:28:22.211307 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:28:22.212227 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m11:28:22.214132 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:28:22.215180 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:28:22.215951 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m11:28:22.218186 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:28:22.219719 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m11:28:22.220483 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:28:22.221265 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m11:28:22.222622 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:28:22.223421 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m11:28:22.228999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m11:28:22.237183 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:28:22.238228 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:28:22.239035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:22.256143 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m11:28:22.257216 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:28:22.258102 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:28:22.281850 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:28:22.288515 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:28:22.290533 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:28:22.291290 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:28:22.297000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfb9868c0>]}
[0m11:28:22.298056 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:22.299053 [debug] [MainThread]: On master: BEGIN
[0m11:28:22.299816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:22.317277 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m11:28:22.318278 [debug] [MainThread]: On master: COMMIT
[0m11:28:22.319101 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:22.319820 [debug] [MainThread]: On master: COMMIT
[0m11:28:22.320833 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:22.321625 [debug] [MainThread]: On master: Close
[0m11:28:22.325319 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:28:22.327296 [info ] [MainThread]: 
[0m11:28:22.334014 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m11:28:22.335491 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m11:28:22.337106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m11:28:22.338069 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m11:28:22.350618 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m11:28:22.357511 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m11:28:22.411035 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m11:28:22.420550 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:28:22.421866 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m11:28:22.422788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:28:22.439322 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m11:28:22.440297 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:28:22.441149 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m11:28:22.495467 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m11:28:22.507674 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:28:22.509441 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m11:28:22.510908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:22.515741 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:28:22.517026 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m11:28:22.518341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:22.543593 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:28:22.544753 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:28:22.545671 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:28:22.568344 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:28:22.576202 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:28:22.577086 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m11:28:22.580784 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:28:22.585186 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m11:28:22.637477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df952df00>]}
[0m11:28:22.639181 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.30s]
[0m11:28:22.640909 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m11:28:22.642288 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m11:28:22.645991 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m11:28:22.648325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m11:28:22.649910 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m11:28:22.658413 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m11:28:22.665028 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m11:28:22.671081 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m11:28:22.680172 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:28:22.681686 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m11:28:22.682835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:22.705970 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:28:22.707389 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:28:22.708637 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m11:28:22.758503 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m11:28:22.765098 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:28:22.766823 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m11:28:22.768376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:22.773122 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:28:22.774244 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:28:22.775956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:22.778033 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:28:22.779000 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:28:22.779899 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:28:22.785735 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:28:22.789933 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:28:22.791100 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m11:28:22.795174 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:28:22.799494 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m11:28:22.851921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df97b0250>]}
[0m11:28:22.853592 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m11:28:22.855266 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m11:28:22.856555 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m11:28:22.857858 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m11:28:22.859616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m11:28:22.861213 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m11:28:22.873468 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m11:28:22.885510 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m11:28:22.893901 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m11:28:22.903124 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:28:22.904418 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m11:28:22.905507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:22.930499 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:28:22.932124 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:28:22.933239 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m11:28:22.952285 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m11:28:22.957816 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:28:22.959856 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m11:28:22.961651 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:22.967056 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:28:22.968081 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m11:28:22.969334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:22.971443 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:28:22.972291 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:28:22.973141 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:28:23.023419 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m11:28:23.028465 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:28:23.029569 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m11:28:23.032488 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:23.034512 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m11:28:23.074015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfbd9a230>]}
[0m11:28:23.076464 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m11:28:23.079156 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m11:28:23.080552 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m11:28:23.081867 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m11:28:23.083443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m11:28:23.084433 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m11:28:23.092377 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.100510 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m11:28:23.135318 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.147395 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.148679 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m11:28:23.149838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:23.173777 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:28:23.175502 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.176603 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m11:28:23.321090 [debug] [Thread-1 (]: SQL status: OK in 0.143 seconds
[0m11:28:23.331811 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.333006 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m11:28:23.334735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:23.340334 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.341343 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m11:28:23.343041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:23.345258 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:28:23.346330 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.347178 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:28:23.352412 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:23.357512 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:28:23.358648 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m11:28:23.361999 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:23.364500 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m11:28:23.381197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df94f6950>]}
[0m11:28:23.383346 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.30s]
[0m11:28:23.385178 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m11:28:23.387714 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m11:28:23.389085 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m11:28:23.390738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m11:28:23.391760 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m11:28:23.400307 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.408640 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m11:28:23.416973 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.437042 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.439765 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m11:28:23.441196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:23.469253 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m11:28:23.470801 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.471926 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m11:28:23.623053 [debug] [Thread-1 (]: SQL status: OK in 0.150 seconds
[0m11:28:23.628739 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.630129 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m11:28:23.631609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:23.636364 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.637351 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m11:28:23.638981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:23.640960 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:28:23.641937 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.642986 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:28:23.648506 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:28:23.652796 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:28:23.653704 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m11:28:23.656668 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:23.658804 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m11:28:23.676488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df945ae00>]}
[0m11:28:23.677820 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.29s]
[0m11:28:23.679547 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m11:28:23.681146 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m11:28:23.682277 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m11:28:23.683491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m11:28:23.684326 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m11:28:23.691024 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.699668 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m11:28:23.708675 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.719706 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.721032 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m11:28:23.721919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:23.749411 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:28:23.751334 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.752753 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m11:28:23.898280 [debug] [Thread-1 (]: SQL status: OK in 0.144 seconds
[0m11:28:23.906320 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.907516 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m11:28:23.909092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:23.913958 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.915218 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m11:28:23.916474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:23.918350 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:28:23.919575 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.920755 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:28:23.936489 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m11:28:23.944074 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:28:23.945308 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m11:28:23.948741 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:23.951548 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m11:28:23.970054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df945b100>]}
[0m11:28:23.971429 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.29s]
[0m11:28:23.973005 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m11:28:23.974944 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m11:28:23.976227 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m11:28:23.977666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m11:28:23.978732 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m11:28:23.985996 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.002539 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m11:28:24.013094 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.021635 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.022865 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m11:28:24.023947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:24.051668 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m11:28:24.053221 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.054446 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m11:28:24.201699 [debug] [Thread-1 (]: SQL status: OK in 0.146 seconds
[0m11:28:24.207931 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.209176 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m11:28:24.210721 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:24.215617 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.216487 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m11:28:24.217837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:24.219872 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:28:24.220715 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.221500 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:28:24.226478 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:24.231419 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:28:24.232470 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m11:28:24.235524 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:24.238179 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m11:28:24.258750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df952e380>]}
[0m11:28:24.260739 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.28s]
[0m11:28:24.262936 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m11:28:24.266048 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m11:28:24.268043 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m11:28:24.270173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m11:28:24.271339 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m11:28:24.285274 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.298293 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m11:28:24.306929 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.316897 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.318216 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m11:28:24.319108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:24.341424 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:28:24.343760 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.345191 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m11:28:24.493253 [debug] [Thread-1 (]: SQL status: OK in 0.147 seconds
[0m11:28:24.499284 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.500117 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m11:28:24.501391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:24.505653 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.506637 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m11:28:24.507869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:24.509745 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:28:24.510700 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.511621 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:28:24.516749 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:24.521750 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:28:24.522715 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m11:28:24.525854 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:24.529192 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m11:28:24.544291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df94f6950>]}
[0m11:28:24.545655 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.27s]
[0m11:28:24.547335 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m11:28:24.549374 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m11:28:24.550923 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m11:28:24.552503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m11:28:24.553642 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m11:28:24.564404 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m11:28:24.572366 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m11:28:24.581461 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m11:28:24.592113 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:28:24.594565 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m11:28:24.596063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:24.621197 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:28:24.622864 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:28:24.624350 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m11:28:25.108982 [debug] [Thread-1 (]: SQL status: OK in 0.483 seconds
[0m11:28:25.115251 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:28:25.116426 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m11:28:25.118005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:25.122473 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:28:25.123523 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m11:28:25.125128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:25.128867 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:28:25.129813 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:28:25.130646 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:28:25.174757 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m11:28:25.181381 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:28:25.182501 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m11:28:25.187421 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:25.189960 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m11:28:25.247482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c9b877-28d7-4fb8-a0a9-afcb129f0db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df94f6950>]}
[0m11:28:25.249148 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.70s]
[0m11:28:25.250634 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m11:28:25.253021 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:25.253882 [debug] [MainThread]: On master: BEGIN
[0m11:28:25.254643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:25.272215 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m11:28:25.273199 [debug] [MainThread]: On master: COMMIT
[0m11:28:25.274198 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:25.275306 [debug] [MainThread]: On master: COMMIT
[0m11:28:25.277045 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:25.278027 [debug] [MainThread]: On master: Close
[0m11:28:25.284691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:25.285601 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:28:25.286357 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m11:28:25.287443 [info ] [MainThread]: 
[0m11:28:25.288755 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m11:28:25.292428 [debug] [MainThread]: Command end result
[0m11:28:25.499122 [info ] [MainThread]: 
[0m11:28:25.500213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:25.501335 [info ] [MainThread]: 
[0m11:28:25.502277 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:28:25.504272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.331688, "process_user_time": 6.810472, "process_kernel_time": 0.69208, "process_mem_max_rss": "239192", "process_in_blocks": "103648", "process_out_blocks": "0"}
[0m11:28:25.505260 [debug] [MainThread]: Command `dbt run` succeeded at 11:28:25.505144 after 9.33 seconds
[0m11:28:25.506159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e08988b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e07a88880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e076276a0>]}
[0m11:28:25.507066 [debug] [MainThread]: Flushing usage events
[0m11:28:33.240341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8b544b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde899c5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde899c56c0>]}


============================== 11:28:33.245436 | ad8d80ed-b1be-460b-951f-a4b54ba7c940 ==============================
[0m11:28:33.245436 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:28:33.247140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:28:33.577489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad8d80ed-b1be-460b-951f-a4b54ba7c940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8670fd30>]}
[0m11:28:33.681542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad8d80ed-b1be-460b-951f-a4b54ba7c940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde86745990>]}
[0m11:28:33.683358 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:28:33.752145 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:28:36.192669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:28:36.194192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:28:36.207032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:28:36.266246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad8d80ed-b1be-460b-951f-a4b54ba7c940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7e4e51e0>]}
[0m11:28:36.493174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad8d80ed-b1be-460b-951f-a4b54ba7c940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7e4b0d00>]}
[0m11:28:36.494795 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:28:36.496028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad8d80ed-b1be-460b-951f-a4b54ba7c940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7e4db3a0>]}
[0m11:28:36.499752 [info ] [MainThread]: 
[0m11:28:36.501273 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:28:36.514101 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m11:28:36.655487 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:28:36.656656 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:28:36.657789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:36.683980 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m11:28:36.685803 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:28:36.686676 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:28:36.712575 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m11:28:36.719913 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:28:36.720948 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:28:36.721804 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:28:36.733041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad8d80ed-b1be-460b-951f-a4b54ba7c940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7e4b33d0>]}
[0m11:28:36.734302 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:36.735128 [debug] [MainThread]: On master: BEGIN
[0m11:28:36.735866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:36.758830 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m11:28:36.760312 [debug] [MainThread]: On master: COMMIT
[0m11:28:36.761237 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:36.762015 [debug] [MainThread]: On master: COMMIT
[0m11:28:36.763093 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:36.763869 [debug] [MainThread]: On master: Close
[0m11:28:36.767328 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:28:36.768647 [info ] [MainThread]: 
[0m11:28:36.772520 [debug] [Thread-1 (]: Began running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:28:36.773451 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [RUN]
[0m11:28:36.774863 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m11:28:36.775853 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:28:36.812409 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:28:36.822567 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:28:36.852002 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:28:36.861229 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:28:36.862351 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: BEGIN
[0m11:28:36.863152 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:28:36.890078 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:28:36.892307 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:28:36.893498 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "dev"."dbt_blue"."fact_taxi_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    'Mobile','Credit Card','Cash','Prcard','Unknown','No Charge'
)



      
    ) dbt_internal_test
[0m11:28:36.909837 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m11:28:36.915893 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: ROLLBACK
[0m11:28:36.917163 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m11:28:36.918189 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: Close
[0m11:28:36.924397 [error] [Thread-1 (]: 1 of 6 FAIL 1 accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [[31mFAIL 1[0m in 0.15s]
[0m11:28:36.927025 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:28:36.928409 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:28:36.929443 [info ] [Thread-1 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m11:28:36.930823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34)
[0m11:28:36.931765 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:28:36.969623 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:28:36.980220 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:28:36.986950 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:28:36.995694 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:28:36.996753 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m11:28:36.997592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:37.020279 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:28:37.021960 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:28:37.023080 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:28:37.026287 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:37.030012 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m11:28:37.031078 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:28:37.032014 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m11:28:37.038234 [info ] [Thread-1 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.11s]
[0m11:28:37.039795 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:28:37.040995 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:28:37.042032 [info ] [Thread-1 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m11:28:37.043351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m11:28:37.044264 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:28:37.052825 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:28:37.061113 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:28:37.070142 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:28:37.079719 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:28:37.081603 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m11:28:37.082504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:37.105425 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:28:37.107225 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:28:37.108719 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:28:37.112257 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:37.115707 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m11:28:37.116849 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m11:28:37.117704 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m11:28:37.126546 [info ] [Thread-1 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m11:28:37.128584 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:28:37.130006 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:28:37.131094 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m11:28:37.132516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m11:28:37.133500 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:28:37.147495 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:28:37.157203 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:28:37.162859 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:28:37.171302 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:28:37.172440 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m11:28:37.173388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:37.196751 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:28:37.198354 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:28:37.199292 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m11:28:37.201266 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:37.204225 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m11:28:37.205908 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m11:28:37.207107 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m11:28:37.214003 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.08s]
[0m11:28:37.216238 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:28:37.217492 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:28:37.218814 [info ] [Thread-1 (]: 5 of 6 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m11:28:37.220189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m11:28:37.221224 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:28:37.231122 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:28:37.240649 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:28:37.246868 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:28:37.257339 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:28:37.258969 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m11:28:37.260297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:37.282965 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:28:37.284815 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:28:37.285915 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m11:28:37.288528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:37.291395 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m11:28:37.292431 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m11:28:37.293303 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m11:28:37.304489 [info ] [Thread-1 (]: 5 of 6 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m11:28:37.309062 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:28:37.311542 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:28:37.313287 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m11:28:37.315249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m11:28:37.316307 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:28:37.341864 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:28:37.351458 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:28:37.359321 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:28:37.368596 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:28:37.369742 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m11:28:37.370613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:37.393239 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:28:37.394878 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:28:37.395929 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:28:37.415901 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:28:37.420705 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m11:28:37.422853 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m11:28:37.424111 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m11:28:37.434379 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m11:28:37.436724 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:28:37.439836 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:37.441354 [debug] [MainThread]: On master: BEGIN
[0m11:28:37.445124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:37.478623 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m11:28:37.480147 [debug] [MainThread]: On master: COMMIT
[0m11:28:37.480992 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:37.481758 [debug] [MainThread]: On master: COMMIT
[0m11:28:37.483107 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:37.483921 [debug] [MainThread]: On master: Close
[0m11:28:37.492515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:37.493767 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:28:37.494640 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m11:28:37.495650 [info ] [MainThread]: 
[0m11:28:37.496808 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m11:28:37.499509 [debug] [MainThread]: Command end result
[0m11:28:37.605362 [info ] [MainThread]: 
[0m11:28:37.608399 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:28:37.609636 [info ] [MainThread]: 
[0m11:28:37.610744 [error] [MainThread]: [31mFailure in test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge (models/99. datamart/datamarts.yml)[0m
[0m11:28:37.611750 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:37.612778 [info ] [MainThread]: 
[0m11:28:37.613853 [info ] [MainThread]:   compiled code at target/compiled/taxis_chicago/models/99. datamart/datamarts.yml/accepted_values_fact_taxi_trip_be432c855795d0e0fd5b5a1458f998ac.sql
[0m11:28:37.614911 [info ] [MainThread]: 
[0m11:28:37.615900 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:28:37.617805 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.4688168, "process_user_time": 3.271577, "process_kernel_time": 0.349791, "process_mem_max_rss": "196376", "process_in_blocks": "1880", "command_success": false, "process_out_blocks": "0"}
[0m11:28:37.619108 [debug] [MainThread]: Command `dbt test` failed at 11:28:37.618965 after 4.47 seconds
[0m11:28:37.620077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8b544b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7d5a9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7d58b5e0>]}
[0m11:28:37.621245 [debug] [MainThread]: Flushing usage events
[0m11:31:50.740436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe800768af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7febebac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7febebb20>]}


============================== 11:31:50.745511 | 62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8 ==============================
[0m11:31:50.745511 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:31:50.746913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:31:51.110416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f3b1fd60>]}
[0m11:31:51.206468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7fee4f970>]}
[0m11:31:51.208837 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:31:51.279839 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:31:53.480596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:31:53.482326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:31:53.493462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:31:53.551905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f37e1180>]}
[0m11:31:53.745078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f37eab00>]}
[0m11:31:53.746224 [info ] [MainThread]: Found 9 models, 6 data tests, 676 macros
[0m11:31:53.747243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f37d7370>]}
[0m11:31:53.750674 [info ] [MainThread]: 
[0m11:31:53.752087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:31:53.761418 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m11:31:53.890306 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:31:53.892070 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:31:53.893105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:53.916241 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m11:31:53.917573 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:31:53.918210 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:31:53.940703 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m11:31:53.946930 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:31:53.948396 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:31:53.949184 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:31:53.959559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cc1290-b5b3-41c2-bb60-8c06aa7c6ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f37ea710>]}
[0m11:31:53.960935 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:53.961681 [debug] [MainThread]: On master: BEGIN
[0m11:31:53.962359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:53.982037 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m11:31:53.983331 [debug] [MainThread]: On master: COMMIT
[0m11:31:53.984281 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:53.985204 [debug] [MainThread]: On master: COMMIT
[0m11:31:53.986511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:53.987517 [debug] [MainThread]: On master: Close
[0m11:31:53.994364 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:31:53.995723 [info ] [MainThread]: 
[0m11:31:54.002338 [debug] [Thread-1 (]: Began running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:31:54.003358 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [RUN]
[0m11:31:54.005174 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m11:31:54.006203 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:31:54.041147 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:31:54.053484 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:31:54.083563 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:31:54.094774 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:31:54.095788 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: BEGIN
[0m11:31:54.096612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:31:54.122616 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m11:31:54.124305 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"
[0m11:31:54.125410 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "dev"."dbt_blue"."fact_taxi_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    'Mobile','Credit Card','Cash','Prcard','Unknown','No Charge'
)



      
    ) dbt_internal_test
[0m11:31:54.143353 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m11:31:54.149436 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: ROLLBACK
[0m11:31:54.150522 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9'
[0m11:31:54.151453 [debug] [Thread-1 (]: On test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9: Close
[0m11:31:54.156699 [error] [Thread-1 (]: 1 of 6 FAIL 1 accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge  [[31mFAIL 1[0m in 0.15s]
[0m11:31:54.158686 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9
[0m11:31:54.159890 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:31:54.160889 [info ] [Thread-1 (]: 2 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m11:31:54.162211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge.a13c22bea9, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34)
[0m11:31:54.163197 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:31:54.188957 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:31:54.199936 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:31:54.207233 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:31:54.221631 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:31:54.223599 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m11:31:54.224964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:54.251562 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m11:31:54.254385 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:31:54.255477 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:31:54.258230 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:54.261736 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m11:31:54.262888 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:31:54.263685 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m11:31:54.270715 [info ] [Thread-1 (]: 2 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.11s]
[0m11:31:54.272526 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:31:54.273773 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:31:54.274744 [info ] [Thread-1 (]: 3 of 6 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m11:31:54.276240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m11:31:54.277337 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:31:54.287274 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:31:54.297090 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:31:54.308062 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:31:54.320172 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:31:54.321615 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m11:31:54.322827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:54.346908 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:31:54.348634 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:31:54.350029 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:31:54.353476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:54.356735 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m11:31:54.358280 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m11:31:54.359345 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m11:31:54.367273 [info ] [Thread-1 (]: 3 of 6 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m11:31:54.369416 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:31:54.370859 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:31:54.372017 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m11:31:54.373442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m11:31:54.374340 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:31:54.389746 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:31:54.398656 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:31:54.408034 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:31:54.424493 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:31:54.426175 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m11:31:54.427585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:54.453629 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m11:31:54.455313 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:31:54.456433 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m11:31:54.458859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:54.462405 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m11:31:54.463719 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m11:31:54.464933 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m11:31:54.469860 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m11:31:54.472052 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:31:54.473336 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:31:54.474503 [info ] [Thread-1 (]: 5 of 6 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m11:31:54.476429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m11:31:54.478342 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:31:54.486144 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:31:54.495911 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:31:54.502341 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:31:54.513781 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:31:54.515835 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m11:31:54.517606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:54.544966 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:31:54.546716 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:31:54.548178 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m11:31:54.551008 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:54.553983 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m11:31:54.555237 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m11:31:54.556297 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m11:31:54.563393 [info ] [Thread-1 (]: 5 of 6 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m11:31:54.565776 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:31:54.567225 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:31:54.568654 [info ] [Thread-1 (]: 6 of 6 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m11:31:54.570248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m11:31:54.571482 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:31:54.589110 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:31:54.599355 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:31:54.605730 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:31:54.614931 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:31:54.616315 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m11:31:54.617699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:54.639787 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:31:54.641434 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:31:54.642884 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:54.654813 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m11:31:54.657967 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m11:31:54.659221 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m11:31:54.660238 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m11:31:54.668464 [info ] [Thread-1 (]: 6 of 6 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.10s]
[0m11:31:54.671025 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:31:54.673604 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:54.674578 [debug] [MainThread]: On master: BEGIN
[0m11:31:54.675575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:54.698470 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m11:31:54.700694 [debug] [MainThread]: On master: COMMIT
[0m11:31:54.702043 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:54.702865 [debug] [MainThread]: On master: COMMIT
[0m11:31:54.704435 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:31:54.705395 [debug] [MainThread]: On master: Close
[0m11:31:54.712786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:54.714112 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:31:54.715355 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m11:31:54.716387 [info ] [MainThread]: 
[0m11:31:54.717569 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m11:31:54.720237 [debug] [MainThread]: Command end result
[0m11:31:54.829586 [info ] [MainThread]: 
[0m11:31:54.830879 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:31:54.832783 [info ] [MainThread]: 
[0m11:31:54.834288 [error] [MainThread]: [31mFailure in test accepted_values_fact_taxi_trips_payment_type__Mobile__Credit_Card__Cash__Prcard__Unknown__No_Charge (models/99. datamart/datamarts.yml)[0m
[0m11:31:54.835640 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:31:54.836743 [info ] [MainThread]: 
[0m11:31:54.838251 [info ] [MainThread]:   compiled code at target/compiled/taxis_chicago/models/99. datamart/datamarts.yml/accepted_values_fact_taxi_trip_be432c855795d0e0fd5b5a1458f998ac.sql
[0m11:31:54.839498 [info ] [MainThread]: 
[0m11:31:54.840644 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:31:54.842911 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.22255, "process_user_time": 3.353778, "process_kernel_time": 0.282093, "process_mem_max_rss": "191780", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:54.845451 [debug] [MainThread]: Command `dbt test` failed at 11:31:54.845292 after 4.23 seconds
[0m11:31:54.846654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe800768af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f38b51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8004b5930>]}
[0m11:31:54.848969 [debug] [MainThread]: Flushing usage events
[0m11:32:15.878187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69417d0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f693fc516f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f693fc51690>]}


============================== 11:32:15.882757 | 3a1338bc-fa22-4508-b4f1-8959ece763a5 ==============================
[0m11:32:15.882757 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:32:15.884162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:32:16.223700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1338bc-fa22-4508-b4f1-8959ece763a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f693fc1f520>]}
[0m11:32:16.341531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1338bc-fa22-4508-b4f1-8959ece763a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6934b7f4c0>]}
[0m11:32:16.344252 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:32:16.427533 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:32:18.598839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:18.601059 [debug] [MainThread]: Partial parsing: updated file: taxis_chicago://models/99. datamart/datamarts.yml
[0m11:32:19.343994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:32:19.356216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1338bc-fa22-4508-b4f1-8959ece763a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f693fcd3b20>]}
[0m11:32:19.560926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1338bc-fa22-4508-b4f1-8959ece763a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6940881e40>]}
[0m11:32:19.562682 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m11:32:19.564548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1338bc-fa22-4508-b4f1-8959ece763a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6940881600>]}
[0m11:32:19.567783 [info ] [MainThread]: 
[0m11:32:19.569170 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:32:19.577574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m11:32:19.633744 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:32:19.635323 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:32:19.636440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:19.662424 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m11:32:19.663478 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:32:19.664274 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:32:19.686763 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m11:32:19.693363 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:32:19.695814 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:32:19.696629 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:32:19.707373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1338bc-fa22-4508-b4f1-8959ece763a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f693fdf9870>]}
[0m11:32:19.708988 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:19.710167 [debug] [MainThread]: On master: BEGIN
[0m11:32:19.711476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:19.730098 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m11:32:19.731259 [debug] [MainThread]: On master: COMMIT
[0m11:32:19.732047 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:19.732752 [debug] [MainThread]: On master: COMMIT
[0m11:32:19.733785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:32:19.734538 [debug] [MainThread]: On master: Close
[0m11:32:19.737972 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:32:19.738951 [info ] [MainThread]: 
[0m11:32:19.743579 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:32:19.744633 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m11:32:19.745969 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:32:19.747026 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:32:19.768189 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:32:19.778412 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:32:19.806871 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:32:19.817938 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:32:19.819297 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m11:32:19.820368 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:32:19.843265 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:32:19.845089 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:32:19.846244 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:32:19.850196 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:32:19.857492 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m11:32:19.858636 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:32:19.859482 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m11:32:19.866520 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.12s]
[0m11:32:19.868524 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:32:19.869763 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:32:19.870942 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m11:32:19.872487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m11:32:19.873503 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:32:19.885814 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:32:19.895341 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:32:19.902861 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:32:19.911922 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:32:19.913276 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m11:32:19.914642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:19.938663 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:32:19.940373 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:32:19.941629 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:32:19.944270 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:32:19.948896 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m11:32:19.958784 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m11:32:19.966686 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m11:32:19.974550 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.10s]
[0m11:32:19.976956 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:32:19.978473 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:32:19.979801 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m11:32:19.981447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m11:32:19.982516 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:32:19.995606 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:32:20.005589 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:32:20.012471 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:32:20.022474 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:32:20.023813 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m11:32:20.024808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:20.049198 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:32:20.051257 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:32:20.052543 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m11:32:20.054876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:20.058133 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m11:32:20.059424 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m11:32:20.060431 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m11:32:20.067495 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m11:32:20.069359 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:32:20.070888 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:32:20.072003 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m11:32:20.073426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m11:32:20.074428 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:32:20.084540 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:32:20.092517 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:32:20.098645 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:32:20.107368 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:32:20.108551 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m11:32:20.109805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:20.135192 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:32:20.136820 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:32:20.137928 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m11:32:20.140203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:32:20.143638 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m11:32:20.144858 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m11:32:20.145897 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m11:32:20.154281 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m11:32:20.156298 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:32:20.157717 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:32:20.158762 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m11:32:20.160769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m11:32:20.162360 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:32:20.174911 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:32:20.186705 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:32:20.194810 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:32:20.204528 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:32:20.205812 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m11:32:20.206906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:20.231311 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:32:20.233367 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:32:20.234520 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:32:20.260329 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:32:20.264609 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m11:32:20.266104 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m11:32:20.267116 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m11:32:20.276298 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m11:32:20.278555 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:32:20.281753 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:20.282633 [debug] [MainThread]: On master: BEGIN
[0m11:32:20.283446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:20.303828 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m11:32:20.305287 [debug] [MainThread]: On master: COMMIT
[0m11:32:20.306432 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:20.307274 [debug] [MainThread]: On master: COMMIT
[0m11:32:20.308476 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:32:20.309722 [debug] [MainThread]: On master: Close
[0m11:32:20.317645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:20.319166 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:32:20.321229 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m11:32:20.322959 [info ] [MainThread]: 
[0m11:32:20.324612 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m11:32:20.328083 [debug] [MainThread]: Command end result
[0m11:32:20.439172 [info ] [MainThread]: 
[0m11:32:20.440474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:20.441727 [info ] [MainThread]: 
[0m11:32:20.442963 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:32:20.445336 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.659156, "process_user_time": 3.817796, "process_kernel_time": 0.393899, "process_mem_max_rss": "205676", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:20.447102 [debug] [MainThread]: Command `dbt test` succeeded at 11:32:20.446887 after 4.66 seconds
[0m11:32:20.448353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69417d0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6940859ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f693474c970>]}
[0m11:32:20.449503 [debug] [MainThread]: Flushing usage events
[0m11:33:12.692935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7363240a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73616d1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73616d14b0>]}


============================== 11:33:12.696967 | af1d872c-a303-4c7f-b908-33eb5ece7236 ==============================
[0m11:33:12.696967 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:33:12.700875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'send_anonymous_usage_stats': 'True'}
[0m11:33:13.005707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af1d872c-a303-4c7f-b908-33eb5ece7236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7363081e40>]}
[0m11:33:13.097576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af1d872c-a303-4c7f-b908-33eb5ece7236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73618c5c00>]}
[0m11:33:13.099202 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:33:13.179983 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m11:33:13.322547 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:33:13.324203 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m11:33:13.325294 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:33:13.326679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af1d872c-a303-4c7f-b908-33eb5ece7236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73622f4f10>]}
[0m11:33:17.988612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:33:17.998277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af1d872c-a303-4c7f-b908-33eb5ece7236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7317f03b80>]}
[0m11:33:18.166344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af1d872c-a303-4c7f-b908-33eb5ece7236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73563bd000>]}
[0m11:33:18.168953 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m11:33:18.170063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af1d872c-a303-4c7f-b908-33eb5ece7236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73563d9660>]}
[0m11:33:18.171540 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m11:33:18.172436 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:33:18.173307 [debug] [MainThread]: On macro_publish: BEGIN
[0m11:33:18.174185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:18.195838 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m11:33:18.196864 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:33:18.197944 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:33:18.198868 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:33:18.200626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:18.210951 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m11:33:18.254836 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:33:18.255932 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m11:33:18.257776 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:33:18.259533 [info ] [MainThread]: Schema dbt_green created or already exists
[0m11:33:18.260602 [info ] [MainThread]: Merging into green environment...
[0m11:33:18.261955 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:33:18.262841 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m11:33:18.440886 [debug] [MainThread]: SQL status: OK in 0.177 seconds
[0m11:33:18.443008 [info ] [MainThread]: Merge into green environment done
[0m11:33:18.444093 [debug] [MainThread]: On macro_publish: Close
[0m11:33:18.555192 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.9589863, "process_user_time": 4.91764, "process_kernel_time": 0.354151, "process_mem_max_rss": "211776", "process_in_blocks": "64", "process_out_blocks": "0"}
[0m11:33:18.556356 [debug] [MainThread]: Command `dbt run-operation` succeeded at 11:33:18.556220 after 5.96 seconds
[0m11:33:18.557299 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m11:33:18.558176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7363240a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73618c5c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73622d6e30>]}
[0m11:33:18.559075 [debug] [MainThread]: Flushing usage events
[0m11:44:05.746965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f3edcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f2379a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f2379a20>]}


============================== 11:44:05.750920 | 7e7a9355-aca3-415a-86f3-eb624f3c093d ==============================
[0m11:44:05.750920 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:44:05.752169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:06.188477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f23f3e20>]}
[0m11:44:06.281661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ef0e1300>]}
[0m11:44:06.283754 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:44:06.378910 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:44:06.544847 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:44:06.546564 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m11:44:06.547542 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:44:06.548809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f2fa3d60>]}
[0m11:44:10.844761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:44:10.856404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e705e650>]}
[0m11:44:11.066807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f24391e0>]}
[0m11:44:11.067825 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m11:44:11.068770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f243a7d0>]}
[0m11:44:11.071749 [info ] [MainThread]: 
[0m11:44:11.073122 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:11.083306 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:44:11.145976 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:44:11.147320 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:44:11.148176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:11.182668 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m11:44:11.185840 [debug] [ThreadPool]: On list_dev: Close
[0m11:44:11.193351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m11:44:11.194400 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m11:44:11.206138 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:44:11.207673 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:44:11.208703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:11.224782 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m11:44:11.226850 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:44:11.227635 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m11:44:11.228868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:11.229662 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:44:11.230673 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m11:44:11.235054 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:44:11.237210 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m11:44:11.238127 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m11:44:11.239177 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m11:44:11.240954 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:44:11.242094 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m11:44:11.249221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m11:44:11.259278 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:44:11.260086 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:44:11.260872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:11.276429 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m11:44:11.277428 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:44:11.278192 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:44:11.303032 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m11:44:11.309377 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:44:11.311173 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:44:11.311937 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:44:11.318133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e6e64610>]}
[0m11:44:11.319523 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:11.320357 [debug] [MainThread]: On master: BEGIN
[0m11:44:11.321073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:11.336556 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m11:44:11.337503 [debug] [MainThread]: On master: COMMIT
[0m11:44:11.338228 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:11.338889 [debug] [MainThread]: On master: COMMIT
[0m11:44:11.339880 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:11.340570 [debug] [MainThread]: On master: Close
[0m11:44:11.343903 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:44:11.345211 [info ] [MainThread]: 
[0m11:44:11.354248 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m11:44:11.355378 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m11:44:11.356676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m11:44:11.357604 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m11:44:11.370390 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m11:44:11.376616 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m11:44:11.436649 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m11:44:11.444427 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:44:11.445708 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m11:44:11.446837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:44:11.470150 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:44:11.471313 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:44:11.472222 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m11:44:11.538863 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m11:44:11.549306 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:44:11.550415 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m11:44:11.551962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:11.557022 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:44:11.557941 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m11:44:11.559457 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:11.589623 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:44:11.591456 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:44:11.592700 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m11:44:11.617085 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:44:11.627497 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m11:44:11.628587 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m11:44:11.634429 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:11.639617 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m11:44:11.689304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e4909b10>]}
[0m11:44:11.691651 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.33s]
[0m11:44:11.693600 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m11:44:11.694798 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m11:44:11.696070 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m11:44:11.699851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m11:44:11.701288 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m11:44:11.711957 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m11:44:11.721227 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m11:44:11.729585 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m11:44:11.738465 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:44:11.740514 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m11:44:11.741790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:11.769556 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m11:44:11.771449 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:44:11.772910 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m11:44:11.828794 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m11:44:11.838781 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:44:11.840419 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m11:44:11.841876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:11.847810 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:44:11.848857 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:44:11.850481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:11.852788 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:44:11.853606 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:44:11.854364 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m11:44:11.860727 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:11.867453 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m11:44:11.868992 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m11:44:11.874141 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:11.877250 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m11:44:11.922372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79ff4d300>]}
[0m11:44:11.923829 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.22s]
[0m11:44:11.925273 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m11:44:11.926327 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m11:44:11.927380 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m11:44:11.928715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m11:44:11.929776 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m11:44:11.936261 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m11:44:11.942585 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m11:44:11.947957 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m11:44:11.955019 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:44:11.955809 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m11:44:11.956605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:11.979634 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:44:11.985003 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:44:11.986548 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m11:44:12.011493 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:44:12.017478 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:44:12.018569 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m11:44:12.020330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:12.025743 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:44:12.026588 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m11:44:12.027972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:12.030035 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:44:12.031089 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:44:12.032328 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m11:44:12.086042 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m11:44:12.092808 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m11:44:12.093948 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m11:44:12.098227 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:12.101216 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m11:44:12.136452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ef0b9c00>]}
[0m11:44:12.138049 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m11:44:12.139561 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m11:44:12.140847 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m11:44:12.142163 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m11:44:12.143601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m11:44:12.144552 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m11:44:12.151849 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.159487 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m11:44:12.186249 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.194476 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.195474 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m11:44:12.196556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:12.220779 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:44:12.222530 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.223777 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m11:44:12.383041 [debug] [Thread-1 (]: SQL status: OK in 0.158 seconds
[0m11:44:12.388691 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.389662 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m11:44:12.390989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:12.395637 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.396683 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m11:44:12.398289 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:12.400337 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:44:12.401250 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.402275 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m11:44:12.417501 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m11:44:12.423521 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m11:44:12.424702 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m11:44:12.429752 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:12.438421 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m11:44:12.453954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e4a0b760>]}
[0m11:44:12.455259 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.31s]
[0m11:44:12.456987 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m11:44:12.458810 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m11:44:12.459896 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m11:44:12.461286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m11:44:12.462376 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m11:44:12.470010 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.476708 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m11:44:12.482719 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.493248 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.494744 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m11:44:12.495905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:12.523642 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:44:12.525946 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.534598 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m11:44:12.699865 [debug] [Thread-1 (]: SQL status: OK in 0.164 seconds
[0m11:44:12.705927 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.707136 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m11:44:12.708780 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:12.716061 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.717262 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m11:44:12.718818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:12.720875 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:44:12.721691 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.722584 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m11:44:12.726832 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:12.730905 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m11:44:12.731697 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m11:44:12.734384 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:12.736335 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m11:44:12.751988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e49084c0>]}
[0m11:44:12.753366 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.29s]
[0m11:44:12.757106 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m11:44:12.759357 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m11:44:12.760683 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m11:44:12.761960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m11:44:12.763119 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m11:44:12.772426 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:12.779631 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m11:44:12.792953 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:12.803557 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:12.805725 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m11:44:12.807113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:12.830236 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m11:44:12.831912 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:12.833545 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m11:44:12.989181 [debug] [Thread-1 (]: SQL status: OK in 0.153 seconds
[0m11:44:12.994875 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:12.995982 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m11:44:12.997801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:13.002796 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:13.003776 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m11:44:13.005375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:13.007397 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:44:13.008215 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:13.009138 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m11:44:13.024683 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m11:44:13.029551 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m11:44:13.030756 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m11:44:13.035702 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:44:13.038548 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m11:44:13.058584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e490bdf0>]}
[0m11:44:13.060392 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.30s]
[0m11:44:13.062621 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m11:44:13.064670 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m11:44:13.065898 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m11:44:13.067456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m11:44:13.068599 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m11:44:13.077768 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.089418 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m11:44:13.098435 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.106037 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.107403 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m11:44:13.108691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:13.129394 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m11:44:13.130942 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.131981 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m11:44:13.262040 [debug] [Thread-1 (]: SQL status: OK in 0.129 seconds
[0m11:44:13.267821 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.268650 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m11:44:13.269999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:13.274363 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.275284 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m11:44:13.276424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:13.278169 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:44:13.279008 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.279951 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m11:44:13.286229 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:44:13.291929 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m11:44:13.293510 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m11:44:13.296269 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:13.299308 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m11:44:13.316685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e490a020>]}
[0m11:44:13.318230 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.25s]
[0m11:44:13.319766 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m11:44:13.321735 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m11:44:13.322962 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m11:44:13.324204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m11:44:13.325093 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m11:44:13.333932 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.343185 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m11:44:13.352692 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.360248 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.361236 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m11:44:13.362077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:13.389624 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m11:44:13.391851 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.392937 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m11:44:13.556526 [debug] [Thread-1 (]: SQL status: OK in 0.163 seconds
[0m11:44:13.562058 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.563208 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m11:44:13.565640 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:13.571742 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.572819 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m11:44:13.574193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:13.576067 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:44:13.576841 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.577668 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m11:44:13.582604 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:13.588434 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m11:44:13.589272 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m11:44:13.592198 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:13.594685 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m11:44:13.609435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7e490a020>]}
[0m11:44:13.610830 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.29s]
[0m11:44:13.612271 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m11:44:13.614055 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m11:44:13.615188 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m11:44:13.616631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m11:44:13.617580 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m11:44:13.728503 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m11:44:13.736723 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m11:44:13.742449 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m11:44:13.749577 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:44:13.750424 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m11:44:13.751177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:13.770491 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m11:44:13.772569 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:44:13.773606 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m11:44:14.290076 [debug] [Thread-1 (]: SQL status: OK in 0.515 seconds
[0m11:44:14.297660 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:44:14.298852 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m11:44:14.300922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:14.306864 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:44:14.307814 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m11:44:14.309095 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:14.311486 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:44:14.312444 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:44:14.313439 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m11:44:14.354233 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m11:44:14.359182 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m11:44:14.360147 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m11:44:14.362973 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:14.365382 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m11:44:14.415401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7a9355-aca3-415a-86f3-eb624f3c093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ef0b8340>]}
[0m11:44:14.416749 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.80s]
[0m11:44:14.418435 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m11:44:14.421064 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:14.422019 [debug] [MainThread]: On master: BEGIN
[0m11:44:14.422974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:14.445835 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m11:44:14.446927 [debug] [MainThread]: On master: COMMIT
[0m11:44:14.447979 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:14.448857 [debug] [MainThread]: On master: COMMIT
[0m11:44:14.450707 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:44:14.451806 [debug] [MainThread]: On master: Close
[0m11:44:14.459168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:14.460328 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:44:14.461021 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m11:44:14.462004 [info ] [MainThread]: 
[0m11:44:14.466110 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m11:44:14.471750 [debug] [MainThread]: Command end result
[0m11:44:14.580809 [info ] [MainThread]: 
[0m11:44:14.581910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:14.583043 [info ] [MainThread]: 
[0m11:44:14.583977 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:44:14.586774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.937929, "process_user_time": 6.99994, "process_kernel_time": 0.789838, "process_mem_max_rss": "234076", "process_in_blocks": "105776", "process_out_blocks": "840"}
[0m11:44:14.587945 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:14.587815 after 8.94 seconds
[0m11:44:14.588821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f3edcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f2f75060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f25f0f10>]}
[0m11:44:14.589697 [debug] [MainThread]: Flushing usage events
[0m11:44:26.234067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c4728ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c2c2fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c2c2ff40>]}


============================== 11:44:26.237671 | 50bfb858-d3df-442d-971b-2e5679425611 ==============================
[0m11:44:26.237671 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:44:26.239322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:26.549470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50bfb858-d3df-442d-971b-2e5679425611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b7b99c00>]}
[0m11:44:26.653701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50bfb858-d3df-442d-971b-2e5679425611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c2e21c90>]}
[0m11:44:26.656060 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:44:26.723791 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m11:44:29.138233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:29.139172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:29.149221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:44:29.208632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50bfb858-d3df-442d-971b-2e5679425611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b75f8e20>]}
[0m11:44:29.437516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50bfb858-d3df-442d-971b-2e5679425611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b7abe9e0>]}
[0m11:44:29.439067 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m11:44:29.440387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bfb858-d3df-442d-971b-2e5679425611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b77e4e20>]}
[0m11:44:29.445365 [info ] [MainThread]: 
[0m11:44:29.448802 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:29.463018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m11:44:29.599701 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:44:29.601104 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m11:44:29.602204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:29.624669 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m11:44:29.626103 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m11:44:29.626952 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m11:44:29.647924 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m11:44:29.653972 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m11:44:29.655021 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m11:44:29.655891 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m11:44:29.661761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bfb858-d3df-442d-971b-2e5679425611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c47f4910>]}
[0m11:44:29.662772 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:29.663526 [debug] [MainThread]: On master: BEGIN
[0m11:44:29.664298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:29.681265 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m11:44:29.682870 [debug] [MainThread]: On master: COMMIT
[0m11:44:29.683914 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:29.684679 [debug] [MainThread]: On master: COMMIT
[0m11:44:29.685732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:29.686577 [debug] [MainThread]: On master: Close
[0m11:44:29.690013 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m11:44:29.691040 [info ] [MainThread]: 
[0m11:44:29.695639 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:44:29.696865 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m11:44:29.698509 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:44:29.699653 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:44:29.740926 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:44:29.751905 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:44:29.784604 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:44:29.793522 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:44:29.794694 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m11:44:29.795636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:44:29.817583 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:44:29.819098 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m11:44:29.820154 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:44:29.832663 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m11:44:29.838282 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m11:44:29.839218 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m11:44:29.839995 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m11:44:29.844700 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.15s]
[0m11:44:29.848018 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m11:44:29.849096 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:44:29.850213 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m11:44:29.851607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m11:44:29.852474 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:44:29.859613 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:44:29.868918 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:44:29.875973 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:44:29.886387 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:44:29.887640 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m11:44:29.888673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:29.913376 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:44:29.916022 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m11:44:29.917357 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m11:44:29.920088 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:44:29.923593 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m11:44:29.924985 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m11:44:29.926186 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m11:44:29.935161 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m11:44:29.937463 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m11:44:29.938916 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:44:29.939895 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m11:44:29.941557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m11:44:29.942486 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:44:29.957149 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:44:29.968900 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:44:29.982449 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:44:29.991741 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:44:29.993201 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m11:44:29.994498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:30.019101 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:44:30.020772 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m11:44:30.021887 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m11:44:30.023840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:30.027276 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m11:44:30.028447 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m11:44:30.029582 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m11:44:30.037735 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m11:44:30.039671 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m11:44:30.041145 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:44:30.042475 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m11:44:30.044729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m11:44:30.046096 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:44:30.057665 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:44:30.066833 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:44:30.074474 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:44:30.085553 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:44:30.086884 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m11:44:30.088125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:30.113011 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m11:44:30.115388 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m11:44:30.117103 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m11:44:30.119604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:30.122649 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m11:44:30.123783 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m11:44:30.124927 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m11:44:30.132393 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m11:44:30.134627 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m11:44:30.136049 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:44:30.137362 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m11:44:30.138818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m11:44:30.140006 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:44:30.155236 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:44:30.165225 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:44:30.171378 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:44:30.180946 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:44:30.182595 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m11:44:30.183561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:30.207651 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m11:44:30.209466 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m11:44:30.210662 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:44:30.250081 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m11:44:30.254722 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m11:44:30.256186 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m11:44:30.257244 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m11:44:30.263459 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m11:44:30.265076 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m11:44:30.267326 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:30.268121 [debug] [MainThread]: On master: BEGIN
[0m11:44:30.268867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:30.290770 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m11:44:30.292384 [debug] [MainThread]: On master: COMMIT
[0m11:44:30.293820 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:30.296781 [debug] [MainThread]: On master: COMMIT
[0m11:44:30.299014 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:44:30.300051 [debug] [MainThread]: On master: Close
[0m11:44:30.306804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:30.307942 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m11:44:30.308963 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m11:44:30.310175 [info ] [MainThread]: 
[0m11:44:30.311426 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m11:44:30.315426 [debug] [MainThread]: Command end result
[0m11:44:30.420598 [info ] [MainThread]: 
[0m11:44:30.422215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:30.423440 [info ] [MainThread]: 
[0m11:44:30.424781 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:44:30.427385 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.281807, "process_user_time": 2.956586, "process_kernel_time": 0.48628, "process_mem_max_rss": "198400", "process_in_blocks": "1848", "process_out_blocks": "0"}
[0m11:44:30.428909 [debug] [MainThread]: Command `dbt test` succeeded at 11:44:30.428714 after 4.28 seconds
[0m11:44:30.429929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c4728ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c383df30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b7abce50>]}
[0m11:44:30.430884 [debug] [MainThread]: Flushing usage events
[0m11:44:38.198085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435164cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434fb63bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434fb63c10>]}


============================== 11:44:38.202545 | 862f81ba-9ab0-4745-bf36-368a607f0ed6 ==============================
[0m11:44:38.202545 [info ] [MainThread]: Running with dbt=1.8.4
[0m11:44:38.205871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:38.524460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862f81ba-9ab0-4745-bf36-368a607f0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434c8a26e0>]}
[0m11:44:38.621595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862f81ba-9ab0-4745-bf36-368a607f0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434fdbfd60>]}
[0m11:44:38.623518 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m11:44:38.699869 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m11:44:38.847741 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:44:38.849318 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m11:44:38.850302 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:44:38.851512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '862f81ba-9ab0-4745-bf36-368a607f0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435076c8b0>]}
[0m11:44:43.620600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m11:44:43.634336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862f81ba-9ab0-4745-bf36-368a607f0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43448a07c0>]}
[0m11:44:43.852589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862f81ba-9ab0-4745-bf36-368a607f0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4344614130>]}
[0m11:44:43.854284 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m11:44:43.855567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862f81ba-9ab0-4745-bf36-368a607f0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43445fec80>]}
[0m11:44:43.857319 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m11:44:43.858418 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:44:43.859358 [debug] [MainThread]: On macro_publish: BEGIN
[0m11:44:43.860382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:43.886752 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m11:44:43.888355 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:44:43.889369 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:44:43.890458 [debug] [MainThread]: On macro_publish: COMMIT
[0m11:44:43.892762 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:44:43.905801 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m11:44:43.961988 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:44:43.963701 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m11:44:43.966670 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:44:43.969019 [info ] [MainThread]: Schema dbt_green created or already exists
[0m11:44:43.970233 [info ] [MainThread]: Merging into green environment...
[0m11:44:43.971985 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m11:44:43.972790 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m11:44:44.160813 [debug] [MainThread]: SQL status: OK in 0.187 seconds
[0m11:44:44.164117 [info ] [MainThread]: Merge into green environment done
[0m11:44:44.165519 [debug] [MainThread]: On macro_publish: Close
[0m11:44:44.299062 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.1917863, "process_user_time": 5.089909, "process_kernel_time": 0.386199, "process_mem_max_rss": "214404", "process_in_blocks": "64", "process_out_blocks": "0"}
[0m11:44:44.300168 [debug] [MainThread]: Command `dbt run-operation` succeeded at 11:44:44.300048 after 6.19 seconds
[0m11:44:44.300917 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m11:44:44.301873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435164cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4344633d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43446334c0>]}
[0m11:44:44.302700 [debug] [MainThread]: Flushing usage events
[0m12:17:43.541086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a594b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1189d5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1189d56f0>]}


============================== 12:17:43.549062 | 517ed573-f1c8-41e4-87c2-27d1bc891ef9 ==============================
[0m12:17:43.549062 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:17:43.552455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:43.999715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a3c1f90>]}
[0m12:17:44.096293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10d921c00>]}
[0m12:17:44.098184 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:17:44.174240 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:17:44.315930 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:44.317305 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m12:17:44.318609 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:17:44.320378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1196518d0>]}
[0m12:17:49.020983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:17:49.033787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10d5e97b0>]}
[0m12:17:49.231753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10d52ad40>]}
[0m12:17:49.233160 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:17:49.236498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10d529b70>]}
[0m12:17:49.239949 [info ] [MainThread]: 
[0m12:17:49.241953 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:17:49.250583 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:17:49.312414 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:17:49.314682 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:17:49.315681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:49.354699 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:17:49.358293 [debug] [ThreadPool]: On list_dev: Close
[0m12:17:49.366214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m12:17:49.367506 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m12:17:49.382598 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:17:49.383664 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:17:49.384725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:49.404117 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:17:49.406353 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:17:49.407103 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m12:17:49.408210 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:17:49.409189 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:17:49.409957 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m12:17:49.412028 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:17:49.413502 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:17:49.414258 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:17:49.415076 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:17:49.416449 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:17:49.417361 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m12:17:49.423481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m12:17:49.431620 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:17:49.432659 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:17:49.433512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:49.452379 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:17:49.453552 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:17:49.454309 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:17:49.477022 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:17:49.483591 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:17:49.485508 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:17:49.487536 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:17:49.498288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a614400>]}
[0m12:17:49.499816 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:49.501409 [debug] [MainThread]: On master: BEGIN
[0m12:17:49.502395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:49.523083 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m12:17:49.524285 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.525351 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:49.526244 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.527363 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:49.528113 [debug] [MainThread]: On master: Close
[0m12:17:49.531916 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:17:49.532955 [info ] [MainThread]: 
[0m12:17:49.537159 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m12:17:49.538240 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m12:17:49.539519 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m12:17:49.540364 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m12:17:49.556619 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m12:17:49.565979 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m12:17:49.633195 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m12:17:49.641181 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:17:49.642090 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m12:17:49.642848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:49.661175 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m12:17:49.662322 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:17:49.663140 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m12:17:49.717751 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m12:17:49.729032 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:17:49.730272 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m12:17:49.731933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:49.736629 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:17:49.737588 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m12:17:49.738912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:49.765940 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:17:49.767109 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:17:49.768000 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:17:49.788921 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:17:49.796853 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:17:49.797783 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m12:17:49.801869 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:17:49.807470 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m12:17:49.850575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f7018e50>]}
[0m12:17:49.852095 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.31s]
[0m12:17:49.853598 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m12:17:49.854860 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m12:17:49.856252 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m12:17:49.857706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m12:17:49.858664 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m12:17:49.863906 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m12:17:49.876523 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m12:17:49.889053 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m12:17:49.898296 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:17:49.899397 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m12:17:49.900354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:49.926480 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m12:17:49.928156 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:17:49.929266 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m12:17:49.984071 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m12:17:49.989573 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:17:49.990668 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m12:17:49.992065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:49.996892 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:17:49.998040 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:17:49.999590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:50.001842 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:17:50.004029 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:17:50.004875 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:17:50.011331 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:17:50.016113 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:17:50.017540 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m12:17:50.020554 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.023107 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m12:17:50.059716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f6f02830>]}
[0m12:17:50.061303 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m12:17:50.063080 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m12:17:50.064338 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m12:17:50.065618 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m12:17:50.066943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m12:17:50.067988 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m12:17:50.073143 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m12:17:50.079762 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m12:17:50.092749 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m12:17:50.102185 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:17:50.104087 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m12:17:50.106452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.130464 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:17:50.132143 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:17:50.133320 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m12:17:50.150788 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m12:17:50.157505 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:17:50.158739 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m12:17:50.160516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:50.165351 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:17:50.166371 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m12:17:50.168062 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:50.170407 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:17:50.171351 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:17:50.172582 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:17:50.224380 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m12:17:50.230680 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:17:50.232403 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m12:17:50.236529 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:17:50.239421 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m12:17:50.272336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10d72be80>]}
[0m12:17:50.273737 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m12:17:50.275402 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m12:17:50.276695 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m12:17:50.277938 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m12:17:50.279277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m12:17:50.280283 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m12:17:50.288457 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.297439 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m12:17:50.338543 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.347631 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.348865 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m12:17:50.349956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.375345 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:17:50.377036 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.378287 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:17:50.550048 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m12:17:50.558065 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.559165 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m12:17:50.560828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:50.565673 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.566701 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m12:17:50.568372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:50.570291 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:17:50.571137 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.572049 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:17:50.586217 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:17:50.592235 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:17:50.593154 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m12:17:50.596133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.598692 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m12:17:50.615074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f72bc220>]}
[0m12:17:50.616457 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.34s]
[0m12:17:50.618466 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m12:17:50.620532 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m12:17:50.621901 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m12:17:50.623354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m12:17:50.624617 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m12:17:50.634716 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.644328 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m12:17:50.652379 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.663983 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.665249 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m12:17:50.666243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.690142 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:17:50.692674 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.693905 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m12:17:50.867481 [debug] [Thread-1 (]: SQL status: OK in 0.172 seconds
[0m12:17:50.873661 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.874710 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m12:17:50.876372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:50.881177 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.882060 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m12:17:50.883534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:50.885999 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:17:50.888226 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.889022 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:17:50.894737 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:17:50.899114 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:17:50.900146 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m12:17:50.902807 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:50.904800 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m12:17:50.920597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f72bc220>]}
[0m12:17:50.922731 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.30s]
[0m12:17:50.924648 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m12:17:50.927169 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m12:17:50.928585 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m12:17:50.930374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m12:17:50.931933 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m12:17:50.942322 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:50.955276 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m12:17:50.964235 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:50.974725 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:50.976225 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m12:17:50.977281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:51.003131 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m12:17:51.005441 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:51.006842 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m12:17:51.142440 [debug] [Thread-1 (]: SQL status: OK in 0.134 seconds
[0m12:17:51.149483 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:51.150406 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m12:17:51.151995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:51.157265 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:51.158109 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m12:17:51.159393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:51.161275 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:17:51.162048 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:51.162845 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:17:51.166983 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:17:51.171616 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:17:51.172396 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m12:17:51.174761 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:51.177158 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m12:17:51.191724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f701add0>]}
[0m12:17:51.192978 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.26s]
[0m12:17:51.194837 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m12:17:51.196825 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m12:17:51.197978 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m12:17:51.199613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m12:17:51.200444 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m12:17:51.211518 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.218332 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m12:17:51.224288 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.229720 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.230555 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m12:17:51.231409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:51.254830 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:17:51.256954 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.258243 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m12:17:51.440237 [debug] [Thread-1 (]: SQL status: OK in 0.180 seconds
[0m12:17:51.448800 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.449952 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m12:17:51.452213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:51.457303 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.458341 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m12:17:51.459813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:17:51.461763 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:17:51.462566 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.463354 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:17:51.468651 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:17:51.473094 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:17:51.473949 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m12:17:51.476557 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:51.478614 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m12:17:51.498644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f701b100>]}
[0m12:17:51.500199 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.30s]
[0m12:17:51.502751 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m12:17:51.504524 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m12:17:51.505935 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m12:17:51.507871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m12:17:51.509764 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m12:17:51.521884 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.530337 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m12:17:51.539554 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.549226 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.550486 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m12:17:51.551887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:51.579258 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:17:51.580830 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.581912 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m12:17:51.766405 [debug] [Thread-1 (]: SQL status: OK in 0.183 seconds
[0m12:17:51.772747 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.773851 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m12:17:51.775502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:51.780558 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.781681 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m12:17:51.783162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:51.785558 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:17:51.786488 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.787308 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:17:51.801755 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:17:51.807658 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:17:51.808553 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m12:17:51.811148 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:51.813188 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m12:17:51.829771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f714a0b0>]}
[0m12:17:51.831238 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.32s]
[0m12:17:51.832930 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m12:17:51.835394 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m12:17:51.836895 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m12:17:51.838446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m12:17:51.839694 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m12:17:51.854355 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m12:17:51.864452 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m12:17:51.959903 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m12:17:51.968171 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:17:51.969185 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m12:17:51.970026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:51.986060 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m12:17:51.987225 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:17:51.988126 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m12:17:52.597565 [debug] [Thread-1 (]: SQL status: OK in 0.608 seconds
[0m12:17:52.605383 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:17:52.606742 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m12:17:52.608742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:52.614800 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:17:52.616155 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m12:17:52.617998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:52.620734 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:17:52.621924 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:17:52.622789 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:17:52.672749 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m12:17:52.678802 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:17:52.679984 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m12:17:52.682907 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:52.685233 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m12:17:52.741793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517ed573-f1c8-41e4-87c2-27d1bc891ef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f714a0b0>]}
[0m12:17:52.743240 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.90s]
[0m12:17:52.744766 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m12:17:52.747348 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:52.748257 [debug] [MainThread]: On master: BEGIN
[0m12:17:52.749022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:52.773701 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m12:17:52.775479 [debug] [MainThread]: On master: COMMIT
[0m12:17:52.776624 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:52.777533 [debug] [MainThread]: On master: COMMIT
[0m12:17:52.778778 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:52.779614 [debug] [MainThread]: On master: Close
[0m12:17:52.788282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:52.789912 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:17:52.791111 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m12:17:52.792561 [info ] [MainThread]: 
[0m12:17:52.793656 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m12:17:52.797666 [debug] [MainThread]: Command end result
[0m12:17:52.916782 [info ] [MainThread]: 
[0m12:17:52.918549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:52.920238 [info ] [MainThread]: 
[0m12:17:52.921365 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:17:52.924304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.481987, "process_user_time": 7.164563, "process_kernel_time": 0.793829, "process_mem_max_rss": "233492", "process_in_blocks": "103872", "process_out_blocks": "0"}
[0m12:17:52.925546 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:52.925405 after 9.48 seconds
[0m12:17:52.926509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11a594b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff119628880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f6f600d0>]}
[0m12:17:52.927441 [debug] [MainThread]: Flushing usage events
[0m12:17:55.814017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2101bcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e6bd6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e6bd660>]}


============================== 12:17:55.819306 | 0fc6e35a-4790-4058-8f84-7db68c1f7419 ==============================
[0m12:17:55.819306 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:17:55.820619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m12:17:56.133774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fc6e35a-4790-4058-8f84-7db68c1f7419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20352bd60>]}
[0m12:17:56.228001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fc6e35a-4790-4058-8f84-7db68c1f7419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e923970>]}
[0m12:17:56.229906 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:17:56.327454 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:17:58.672652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:58.673987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:58.685937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:17:58.742624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fc6e35a-4790-4058-8f84-7db68c1f7419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe202ff8e80>]}
[0m12:17:58.941009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fc6e35a-4790-4058-8f84-7db68c1f7419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe203328310>]}
[0m12:17:58.942085 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:17:58.943239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc6e35a-4790-4058-8f84-7db68c1f7419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2031e4d00>]}
[0m12:17:58.946549 [info ] [MainThread]: 
[0m12:17:58.948242 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:17:58.957737 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m12:17:59.078054 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:17:59.079342 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:17:59.080606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:59.102243 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:17:59.103561 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:17:59.104322 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:17:59.125987 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:17:59.133115 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:17:59.134266 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:17:59.134996 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:17:59.141713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fc6e35a-4790-4058-8f84-7db68c1f7419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2031bc3a0>]}
[0m12:17:59.142752 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:59.143512 [debug] [MainThread]: On master: BEGIN
[0m12:17:59.144286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:59.162399 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m12:17:59.163411 [debug] [MainThread]: On master: COMMIT
[0m12:17:59.164352 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:59.165306 [debug] [MainThread]: On master: COMMIT
[0m12:17:59.166819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:59.168542 [debug] [MainThread]: On master: Close
[0m12:17:59.172147 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:17:59.173295 [info ] [MainThread]: 
[0m12:17:59.177857 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:17:59.178927 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m12:17:59.180476 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:17:59.181996 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:17:59.223154 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:17:59.236194 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:17:59.266837 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:17:59.275253 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:17:59.276423 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m12:17:59.277295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:59.299656 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:17:59.300746 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:17:59.301662 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:17:59.304771 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:59.314333 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m12:17:59.315783 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:17:59.316741 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m12:17:59.322356 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.14s]
[0m12:17:59.324772 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:17:59.325948 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:17:59.327004 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m12:17:59.328366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m12:17:59.329308 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:17:59.337449 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:17:59.345398 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:17:59.350585 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:17:59.362576 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:17:59.363898 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m12:17:59.365152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:59.394610 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m12:17:59.396262 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:17:59.397657 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:17:59.402009 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:17:59.405797 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m12:17:59.407143 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m12:17:59.408170 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m12:17:59.416345 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m12:17:59.418941 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:17:59.420818 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:17:59.421885 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m12:17:59.423439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m12:17:59.424661 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:17:59.445200 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:17:59.455348 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:17:59.465662 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:17:59.474892 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:17:59.476023 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m12:17:59.476999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:59.501447 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:17:59.503297 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:17:59.504391 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m12:17:59.506524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:59.509734 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m12:17:59.510818 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m12:17:59.511771 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m12:17:59.520797 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m12:17:59.522898 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:17:59.524245 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:17:59.525295 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m12:17:59.526705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m12:17:59.527693 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:17:59.535458 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:17:59.543857 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:17:59.550636 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:17:59.560013 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:17:59.561089 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m12:17:59.561911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:59.586581 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:17:59.588989 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:17:59.590216 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m12:17:59.592202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:17:59.595590 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m12:17:59.596676 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m12:17:59.597953 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m12:17:59.608270 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m12:17:59.610769 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:17:59.612302 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:17:59.613574 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m12:17:59.615962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m12:17:59.617094 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:17:59.631903 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:17:59.641997 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:17:59.649207 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:17:59.662150 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:17:59.663925 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m12:17:59.666099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:59.693502 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:17:59.695082 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:17:59.696166 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:17:59.724668 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:17:59.729179 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m12:17:59.730575 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m12:17:59.731762 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m12:17:59.741573 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.13s]
[0m12:17:59.743324 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:17:59.746385 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:59.747509 [debug] [MainThread]: On master: BEGIN
[0m12:17:59.748465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:59.768761 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m12:17:59.770629 [debug] [MainThread]: On master: COMMIT
[0m12:17:59.771812 [debug] [MainThread]: Using duckdb connection "master"
[0m12:17:59.772828 [debug] [MainThread]: On master: COMMIT
[0m12:17:59.774171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:17:59.775061 [debug] [MainThread]: On master: Close
[0m12:17:59.782711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:59.784250 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:17:59.785327 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m12:17:59.786736 [info ] [MainThread]: 
[0m12:17:59.788605 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m12:17:59.792246 [debug] [MainThread]: Command end result
[0m12:17:59.904919 [info ] [MainThread]: 
[0m12:17:59.906510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:59.907900 [info ] [MainThread]: 
[0m12:17:59.909040 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:17:59.911096 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.1999993, "process_user_time": 3.142332, "process_kernel_time": 0.357083, "process_mem_max_rss": "198768", "process_in_blocks": "1848", "process_out_blocks": "0"}
[0m12:17:59.912301 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:59.912159 after 4.20 seconds
[0m12:17:59.913283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2101bcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe203328310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2034bded0>]}
[0m12:17:59.914644 [debug] [MainThread]: Flushing usage events
[0m12:18:02.389385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee9cf0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee81f7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee81f7c10>]}


============================== 12:18:02.394432 | 458ce422-ce9f-49a9-af39-e39a80100294 ==============================
[0m12:18:02.394432 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:18:02.395776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:02.707730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '458ce422-ce9f-49a9-af39-e39a80100294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee4f305b0>]}
[0m12:18:02.797032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '458ce422-ce9f-49a9-af39-e39a80100294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee4f30d60>]}
[0m12:18:02.799132 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:18:02.872286 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m12:18:03.019009 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:18:03.021053 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m12:18:03.022259 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:18:03.023665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '458ce422-ce9f-49a9-af39-e39a80100294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee8e048b0>]}
[0m12:18:07.708511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:18:07.718205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '458ce422-ce9f-49a9-af39-e39a80100294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edce41ea0>]}
[0m12:18:07.916389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '458ce422-ce9f-49a9-af39-e39a80100294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edceab7c0>]}
[0m12:18:07.917532 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:18:07.918806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458ce422-ce9f-49a9-af39-e39a80100294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edced05e0>]}
[0m12:18:07.920230 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m12:18:07.921218 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:07.922145 [debug] [MainThread]: On macro_publish: BEGIN
[0m12:18:07.923040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:07.946060 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m12:18:07.949334 [debug] [MainThread]: On macro_publish: COMMIT
[0m12:18:07.950732 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:07.951985 [debug] [MainThread]: On macro_publish: COMMIT
[0m12:18:07.953818 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:07.968062 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m12:18:08.014621 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:08.015838 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m12:18:08.018304 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:18:08.020549 [info ] [MainThread]: Schema dbt_green created or already exists
[0m12:18:08.021676 [info ] [MainThread]: Merging into green environment...
[0m12:18:08.023538 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:08.024509 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m12:18:08.210480 [debug] [MainThread]: SQL status: OK in 0.185 seconds
[0m12:18:08.213946 [info ] [MainThread]: Merge into green environment done
[0m12:18:08.215634 [debug] [MainThread]: On macro_publish: Close
[0m12:18:08.349366 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.062254, "process_user_time": 5.073517, "process_kernel_time": 0.294853, "process_mem_max_rss": "208132", "process_in_blocks": "64", "process_out_blocks": "0"}
[0m12:18:08.350692 [debug] [MainThread]: Command `dbt run-operation` succeeded at 12:18:08.350497 after 6.06 seconds
[0m12:18:08.351671 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m12:18:08.352573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee9cf0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edceb6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edceb6440>]}
[0m12:18:08.353411 [debug] [MainThread]: Flushing usage events
[0m12:18:32.688681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d91988b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8fe73ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8fe73b20>]}


============================== 12:18:32.692518 | 0cb10a9f-a99b-4e1e-af72-58d8997076a8 ==============================
[0m12:18:32.692518 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:18:32.694018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:33.019455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d9181df30>]}
[0m12:18:33.112327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8fef7a90>]}
[0m12:18:33.114470 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:18:33.197038 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:18:33.350406 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:18:33.352143 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m12:18:33.353097 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:18:33.354200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d90a807c0>]}
[0m12:18:38.082931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:18:38.093565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84bd25f0>]}
[0m12:18:38.268999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84921d20>]}
[0m12:18:38.270368 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:18:38.271747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84920130>]}
[0m12:18:38.275598 [info ] [MainThread]: 
[0m12:18:38.277345 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:18:38.284613 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:18:38.348802 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:18:38.350376 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:18:38.351312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:38.378954 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m12:18:38.382311 [debug] [ThreadPool]: On list_dev: Close
[0m12:18:38.390107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m12:18:38.391491 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m12:18:38.402943 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:18:38.403784 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:18:38.404672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:38.420592 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:18:38.422890 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:18:38.423764 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m12:18:38.425276 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:18:38.426024 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:18:38.426721 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m12:18:38.428065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:18:38.429546 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:18:38.430242 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:18:38.430958 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:18:38.432243 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:18:38.432983 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m12:18:38.438475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m12:18:38.448737 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:18:38.450084 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:18:38.450972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:38.466759 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:18:38.467781 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:18:38.468601 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:18:38.489140 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:18:38.495234 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:18:38.496402 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:18:38.497287 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:18:38.502751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84955210>]}
[0m12:18:38.503756 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:38.504757 [debug] [MainThread]: On master: BEGIN
[0m12:18:38.505454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:38.521191 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m12:18:38.522249 [debug] [MainThread]: On master: COMMIT
[0m12:18:38.523021 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:38.523997 [debug] [MainThread]: On master: COMMIT
[0m12:18:38.525222 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:18:38.527223 [debug] [MainThread]: On master: Close
[0m12:18:38.530914 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:18:38.532290 [info ] [MainThread]: 
[0m12:18:38.536630 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m12:18:38.537885 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m12:18:38.539620 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m12:18:38.541802 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m12:18:38.554983 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m12:18:38.563858 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m12:18:38.618991 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m12:18:38.628665 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:18:38.630042 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m12:18:38.631003 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:38.653100 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:18:38.654906 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:18:38.656438 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m12:18:38.708879 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m12:18:38.718692 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:18:38.719695 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m12:18:38.721161 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:38.726269 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:18:38.728409 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m12:18:38.730027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:38.754586 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:18:38.756128 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:18:38.757299 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:18:38.778515 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:18:38.788756 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:18:38.790289 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m12:18:38.793605 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:38.797896 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m12:18:38.836744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d763fc940>]}
[0m12:18:38.838101 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.30s]
[0m12:18:38.839853 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m12:18:38.841142 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m12:18:38.842348 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m12:18:38.843749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m12:18:38.844737 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m12:18:38.850380 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m12:18:38.857338 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m12:18:38.865795 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m12:18:38.873993 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:18:38.876140 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m12:18:38.877724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:38.901595 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:18:38.903020 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:18:38.903970 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m12:18:38.957711 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m12:18:38.963373 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:18:38.964464 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m12:18:38.966310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:38.971436 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:18:38.972585 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:18:38.973949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:38.976049 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:18:38.977025 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:18:38.978099 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:18:38.983979 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:18:38.988137 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:18:38.989010 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m12:18:38.991689 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:38.994950 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m12:18:39.039458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d90abeef0>]}
[0m12:18:39.041264 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m12:18:39.044044 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m12:18:39.045225 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m12:18:39.046268 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m12:18:39.047612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m12:18:39.048740 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m12:18:39.053592 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m12:18:39.061659 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m12:18:39.073621 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m12:18:39.082350 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:18:39.083615 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m12:18:39.084571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:39.111569 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:18:39.113544 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:18:39.114919 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m12:18:39.136424 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:18:39.145916 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:18:39.147767 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m12:18:39.150110 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:39.157455 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:18:39.158649 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m12:18:39.160379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:39.163389 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:18:39.164712 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:18:39.165794 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:18:39.213625 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m12:18:39.220923 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:18:39.222037 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m12:18:39.225304 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:39.227362 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m12:18:39.259979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84b38ca0>]}
[0m12:18:39.261562 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m12:18:39.263111 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m12:18:39.264128 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m12:18:39.265092 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m12:18:39.266239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m12:18:39.267098 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m12:18:39.272024 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.280870 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m12:18:39.318093 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.332110 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.333771 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m12:18:39.334828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:39.359455 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:18:39.361721 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.362942 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:18:39.547434 [debug] [Thread-1 (]: SQL status: OK in 0.183 seconds
[0m12:18:39.553304 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.554250 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m12:18:39.555564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:39.561019 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.562003 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m12:18:39.563578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:39.565431 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:18:39.566224 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.567055 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:18:39.581118 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:18:39.586278 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:18:39.587458 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m12:18:39.594259 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:18:39.597443 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m12:18:39.612961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d76318340>]}
[0m12:18:39.614263 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.35s]
[0m12:18:39.615913 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m12:18:39.617954 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m12:18:39.619189 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m12:18:39.620580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m12:18:39.621811 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m12:18:39.634351 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.649702 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m12:18:39.661696 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.669250 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.670176 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m12:18:39.671008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:39.693374 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:18:39.696297 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.697594 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m12:18:39.899616 [debug] [Thread-1 (]: SQL status: OK in 0.200 seconds
[0m12:18:39.905242 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.906524 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m12:18:39.908089 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:39.912823 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.913744 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m12:18:39.914956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:39.916794 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:18:39.917780 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.918718 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:18:39.925086 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:18:39.931540 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:18:39.932711 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m12:18:39.935464 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:39.937464 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m12:18:39.964164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84b9f490>]}
[0m12:18:39.966250 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.34s]
[0m12:18:39.968711 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m12:18:39.971047 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m12:18:39.972679 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m12:18:39.974495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m12:18:39.975774 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m12:18:39.985091 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.001603 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m12:18:40.014280 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.027697 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.030027 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m12:18:40.031300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:40.055780 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:18:40.057601 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.058885 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m12:18:40.247368 [debug] [Thread-1 (]: SQL status: OK in 0.187 seconds
[0m12:18:40.253933 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.255098 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m12:18:40.256624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:40.261623 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.262523 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m12:18:40.263757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:40.265645 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:18:40.266446 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.267344 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:18:40.271819 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:18:40.276074 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:18:40.277047 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m12:18:40.280088 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:40.282720 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m12:18:40.299478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84d6a3e0>]}
[0m12:18:40.300843 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.33s]
[0m12:18:40.302543 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m12:18:40.304215 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m12:18:40.305559 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m12:18:40.307346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m12:18:40.308506 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m12:18:40.315659 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.323520 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m12:18:40.334288 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.343289 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.345131 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m12:18:40.347496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:40.370965 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:18:40.372554 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.374074 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m12:18:40.567376 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m12:18:40.576699 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.578097 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m12:18:40.580045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:40.586545 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.588021 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m12:18:40.589411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:40.591763 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:18:40.592640 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.593488 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:18:40.608567 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:18:40.612944 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:18:40.613750 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m12:18:40.616184 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:40.618282 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m12:18:40.634765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84b9c6a0>]}
[0m12:18:40.636217 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.33s]
[0m12:18:40.637819 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m12:18:40.639951 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m12:18:40.641417 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m12:18:40.644125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m12:18:40.645196 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m12:18:40.659393 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.671228 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m12:18:40.681278 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.689325 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.695563 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m12:18:40.697072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:40.722252 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:18:40.724269 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.725881 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m12:18:40.912849 [debug] [Thread-1 (]: SQL status: OK in 0.186 seconds
[0m12:18:40.918752 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.919979 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m12:18:40.921612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:40.928921 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.930170 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m12:18:40.932169 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:40.934488 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:18:40.935415 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.936328 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:18:40.940617 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:18:40.944866 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:18:40.946354 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m12:18:40.949172 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:40.951102 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m12:18:40.969280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d84b9eef0>]}
[0m12:18:40.971283 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.32s]
[0m12:18:40.973175 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m12:18:40.975796 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m12:18:40.977006 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m12:18:40.978886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m12:18:40.979965 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m12:18:40.994595 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.003339 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m12:18:41.107419 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.115032 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.115919 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m12:18:41.116760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:41.134330 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m12:18:41.135658 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.136561 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m12:18:41.785573 [debug] [Thread-1 (]: SQL status: OK in 0.648 seconds
[0m12:18:41.791992 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.793466 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m12:18:41.794917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:41.799913 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.800909 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m12:18:41.802328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:41.804498 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:18:41.805325 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.806648 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:18:41.840002 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m12:18:41.846016 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:18:41.847406 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m12:18:41.850633 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:41.852639 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m12:18:41.911076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb10a9f-a99b-4e1e-af72-58d8997076a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d76390c10>]}
[0m12:18:41.912725 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.93s]
[0m12:18:41.914255 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m12:18:41.916583 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:41.917430 [debug] [MainThread]: On master: BEGIN
[0m12:18:41.918314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:41.940265 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m12:18:41.941957 [debug] [MainThread]: On master: COMMIT
[0m12:18:41.944709 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:41.945960 [debug] [MainThread]: On master: COMMIT
[0m12:18:41.947478 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:41.948496 [debug] [MainThread]: On master: Close
[0m12:18:41.956317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:41.957635 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:18:41.958743 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m12:18:41.959981 [info ] [MainThread]: 
[0m12:18:41.961157 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m12:18:41.964734 [debug] [MainThread]: Command end result
[0m12:18:42.077915 [info ] [MainThread]: 
[0m12:18:42.079503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:42.080703 [info ] [MainThread]: 
[0m12:18:42.081719 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:18:42.083558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.494452, "process_user_time": 6.676018, "process_kernel_time": 0.776515, "process_mem_max_rss": "236228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:42.084757 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:42.084623 after 9.50 seconds
[0m12:18:42.085674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d91988b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d76521c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d91731b40>]}
[0m12:18:42.086554 [debug] [MainThread]: Flushing usage events
[0m12:18:44.838723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a2064bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a04a1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a04a1720>]}


============================== 12:18:44.842837 | 41652598-d01a-42cd-87a7-d58e7816b48f ==============================
[0m12:18:44.842837 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:18:44.844149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:45.170323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41652598-d01a-42cd-87a7-d58e7816b48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a1e91fc0>]}
[0m12:18:45.262538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41652598-d01a-42cd-87a7-d58e7816b48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a0757eb0>]}
[0m12:18:45.264218 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:18:45.348472 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:18:47.708406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:47.709411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:47.718177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:18:47.771518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41652598-d01a-42cd-87a7-d58e7816b48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80950e0f40>]}
[0m12:18:47.972361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41652598-d01a-42cd-87a7-d58e7816b48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80953771c0>]}
[0m12:18:47.973591 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:18:47.974746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41652598-d01a-42cd-87a7-d58e7816b48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80950ccd90>]}
[0m12:18:47.978313 [info ] [MainThread]: 
[0m12:18:47.979824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:18:47.990303 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m12:18:48.111215 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:18:48.112756 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:18:48.113664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:48.134909 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:18:48.136230 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:18:48.137008 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:18:48.156391 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:18:48.162950 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:18:48.164046 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:18:48.164894 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:18:48.171611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41652598-d01a-42cd-87a7-d58e7816b48f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80950ec640>]}
[0m12:18:48.172613 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:48.173333 [debug] [MainThread]: On master: BEGIN
[0m12:18:48.174043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:48.190610 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m12:18:48.191615 [debug] [MainThread]: On master: COMMIT
[0m12:18:48.192390 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:48.193157 [debug] [MainThread]: On master: COMMIT
[0m12:18:48.194136 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:18:48.194934 [debug] [MainThread]: On master: Close
[0m12:18:48.199528 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:18:48.200666 [info ] [MainThread]: 
[0m12:18:48.205086 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:18:48.206353 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m12:18:48.209523 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:18:48.210822 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:18:48.259775 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:18:48.267698 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:18:48.293428 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:18:48.302354 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:18:48.303601 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m12:18:48.304997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:48.337239 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m12:18:48.339208 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:18:48.340445 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:18:48.344243 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:18:48.350210 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m12:18:48.351228 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:18:48.352265 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m12:18:48.357094 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.15s]
[0m12:18:48.359348 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:18:48.360717 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:18:48.361881 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m12:18:48.363505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m12:18:48.364557 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:18:48.375317 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:18:48.382858 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:18:48.387071 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:18:48.396983 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:18:48.398421 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m12:18:48.399451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:48.424195 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:18:48.426486 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:18:48.427806 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:18:48.430478 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:48.433731 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m12:18:48.434930 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m12:18:48.435846 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m12:18:48.444282 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m12:18:48.446495 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:18:48.447964 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:18:48.449143 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m12:18:48.450629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m12:18:48.451614 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:18:48.466913 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:18:48.477039 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:18:48.491045 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:18:48.501459 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:18:48.502724 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m12:18:48.503790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:48.527215 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:18:48.529340 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:18:48.530546 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m12:18:48.532701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:48.535826 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m12:18:48.536937 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m12:18:48.537823 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m12:18:48.547342 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m12:18:48.549745 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:18:48.551330 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:18:48.552515 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m12:18:48.554142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m12:18:48.555536 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:18:48.566577 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:18:48.576651 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:18:48.584896 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:18:48.596439 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:18:48.598949 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m12:18:48.600566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:48.625062 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:18:48.627492 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:18:48.629193 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m12:18:48.631949 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:48.635545 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m12:18:48.636736 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m12:18:48.637775 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m12:18:48.644533 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m12:18:48.646948 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:18:48.648345 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:18:48.649411 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m12:18:48.650828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m12:18:48.651997 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:18:48.664443 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:18:48.672242 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:18:48.679112 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:18:48.687679 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:18:48.689164 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m12:18:48.690335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:48.713080 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:18:48.714788 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:18:48.716052 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:18:48.740756 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:18:48.745849 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m12:18:48.747322 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m12:18:48.748617 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m12:18:48.758934 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.11s]
[0m12:18:48.761174 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:18:48.764312 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:48.765226 [debug] [MainThread]: On master: BEGIN
[0m12:18:48.766073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:48.788712 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m12:18:48.790609 [debug] [MainThread]: On master: COMMIT
[0m12:18:48.792058 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:48.793691 [debug] [MainThread]: On master: COMMIT
[0m12:18:48.795736 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:48.797080 [debug] [MainThread]: On master: Close
[0m12:18:48.804943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:48.806025 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:18:48.806934 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m12:18:48.807970 [info ] [MainThread]: 
[0m12:18:48.809375 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m12:18:48.814527 [debug] [MainThread]: Command end result
[0m12:18:48.919939 [info ] [MainThread]: 
[0m12:18:48.921099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:48.922889 [info ] [MainThread]: 
[0m12:18:48.924287 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:18:48.926609 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.1822767, "process_user_time": 3.091661, "process_kernel_time": 0.40814, "process_mem_max_rss": "190244", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:48.927864 [debug] [MainThread]: Command `dbt test` succeeded at 12:18:48.927725 after 4.18 seconds
[0m12:18:48.928852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a2064bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a19bae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a07578e0>]}
[0m12:18:48.929817 [debug] [MainThread]: Flushing usage events
[0m12:18:51.483333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3030668b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302eb6bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302eb6bbb0>]}


============================== 12:18:51.488319 | bb8d8619-7491-4439-a136-6bb9c74ce8e2 ==============================
[0m12:18:51.488319 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:18:51.490063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:51.799118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb8d8619-7491-4439-a136-6bb9c74ce8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b8a8d30>]}
[0m12:18:51.899023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb8d8619-7491-4439-a136-6bb9c74ce8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ed651b0>]}
[0m12:18:51.900737 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:18:51.966050 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m12:18:52.113950 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:18:52.115635 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m12:18:52.116819 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:18:52.117990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb8d8619-7491-4439-a136-6bb9c74ce8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302f7848b0>]}
[0m12:18:56.811749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:18:56.821857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb8d8619-7491-4439-a136-6bb9c74ce8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30238647f0>]}
[0m12:18:56.999987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb8d8619-7491-4439-a136-6bb9c74ce8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302362b8b0>]}
[0m12:18:57.001207 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:18:57.002871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb8d8619-7491-4439-a136-6bb9c74ce8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302361db70>]}
[0m12:18:57.004823 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m12:18:57.007015 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:57.007890 [debug] [MainThread]: On macro_publish: BEGIN
[0m12:18:57.008720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:57.031600 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m12:18:57.032801 [debug] [MainThread]: On macro_publish: COMMIT
[0m12:18:57.033651 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:57.034417 [debug] [MainThread]: On macro_publish: COMMIT
[0m12:18:57.035934 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:57.047745 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m12:18:57.093579 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:57.094852 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m12:18:57.096587 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:57.098683 [info ] [MainThread]: Schema dbt_green created or already exists
[0m12:18:57.099811 [info ] [MainThread]: Merging into green environment...
[0m12:18:57.101391 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:18:57.102254 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m12:18:57.302501 [debug] [MainThread]: SQL status: OK in 0.199 seconds
[0m12:18:57.305336 [info ] [MainThread]: Merge into green environment done
[0m12:18:57.307345 [debug] [MainThread]: On macro_publish: Close
[0m12:18:57.452762 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.0653477, "process_user_time": 4.986516, "process_kernel_time": 0.378975, "process_mem_max_rss": "217296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:57.454274 [debug] [MainThread]: Command `dbt run-operation` succeeded at 12:18:57.454133 after 6.07 seconds
[0m12:18:57.455293 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m12:18:57.456138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3030668b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302362af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3023628850>]}
[0m12:18:57.457104 [debug] [MainThread]: Flushing usage events
[0m12:26:30.237467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f403281ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4030c9d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4030c9d5a0>]}


============================== 12:26:30.240729 | e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d ==============================
[0m12:26:30.240729 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:26:30.242175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:30.549907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4032651e40>]}
[0m12:26:30.644545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4030e95cf0>]}
[0m12:26:30.647276 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:26:30.722186 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:26:30.867214 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:26:30.868739 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m12:26:30.869850 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:26:30.871053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40318c4070>]}
[0m12:26:35.649845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:26:35.658579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40258ffb80>]}
[0m12:26:35.846970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40257b45b0>]}
[0m12:26:35.848364 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:26:35.849333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40257b4a30>]}
[0m12:26:35.852808 [info ] [MainThread]: 
[0m12:26:35.854487 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:26:35.865727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:26:35.921260 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:26:35.922877 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:26:35.923869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:35.950133 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m12:26:35.953624 [debug] [ThreadPool]: On list_dev: Close
[0m12:26:35.962296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m12:26:35.963708 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m12:26:35.977702 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:26:35.978661 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:26:35.979502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:35.998807 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:26:36.002294 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:26:36.003290 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m12:26:36.004522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:26:36.005537 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:26:36.006420 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m12:26:36.008225 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:26:36.010253 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:26:36.011045 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:26:36.011744 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:26:36.013449 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:26:36.014227 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m12:26:36.019179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m12:26:36.027335 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:26:36.028122 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:26:36.028903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:36.046502 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:26:36.047509 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:26:36.048394 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:26:36.068843 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:26:36.074396 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:26:36.076019 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:26:36.076937 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:26:36.086291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40256f5ed0>]}
[0m12:26:36.087466 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:36.088190 [debug] [MainThread]: On master: BEGIN
[0m12:26:36.088951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:36.106845 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m12:26:36.107907 [debug] [MainThread]: On master: COMMIT
[0m12:26:36.108714 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:36.109454 [debug] [MainThread]: On master: COMMIT
[0m12:26:36.110426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:26:36.111186 [debug] [MainThread]: On master: Close
[0m12:26:36.114629 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:26:36.115755 [info ] [MainThread]: 
[0m12:26:36.119455 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m12:26:36.120652 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m12:26:36.121960 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m12:26:36.123053 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m12:26:36.140123 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m12:26:36.152627 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m12:26:36.212033 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m12:26:36.220076 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:26:36.221166 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m12:26:36.222079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:36.244493 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:26:36.246363 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:26:36.247242 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m12:26:36.298802 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m12:26:36.309007 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:26:36.310096 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m12:26:36.311915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:36.317003 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:26:36.317918 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m12:26:36.319726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:36.347386 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:26:36.348938 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:26:36.349810 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:26:36.380315 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m12:26:36.389682 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:26:36.390669 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m12:26:36.393923 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:36.397514 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m12:26:36.435534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025b89b40>]}
[0m12:26:36.437789 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.31s]
[0m12:26:36.439446 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m12:26:36.440571 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m12:26:36.441626 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m12:26:36.443485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m12:26:36.446021 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m12:26:36.451541 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m12:26:36.458365 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m12:26:36.467652 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m12:26:36.477051 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:26:36.479837 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m12:26:36.480982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:36.504933 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:26:36.506585 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:26:36.507874 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m12:26:36.560230 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m12:26:36.565929 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:26:36.566998 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m12:26:36.568538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:36.573654 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:26:36.575137 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:26:36.577068 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:36.579203 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:26:36.580155 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:26:36.580984 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:26:36.587216 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:26:36.591420 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:26:36.592534 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m12:26:36.595629 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:36.598410 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m12:26:36.642604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff1026e0>]}
[0m12:26:36.644464 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m12:26:36.647506 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m12:26:36.648764 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m12:26:36.650053 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m12:26:36.651432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m12:26:36.652392 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m12:26:36.657826 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m12:26:36.667433 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m12:26:36.681146 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m12:26:36.690670 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:26:36.692013 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m12:26:36.693212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:36.715766 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:26:36.717350 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:26:36.718311 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m12:26:36.734781 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:26:36.743167 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:26:36.744125 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m12:26:36.745630 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:36.751560 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:26:36.753022 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m12:26:36.754579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:26:36.756587 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:26:36.757421 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:26:36.758361 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:26:36.809001 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m12:26:36.815239 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:26:36.816393 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m12:26:36.819561 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:36.821693 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m12:26:36.856908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff1026e0>]}
[0m12:26:36.858727 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m12:26:36.860446 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m12:26:36.861799 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m12:26:36.863383 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m12:26:36.865245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m12:26:36.873504 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m12:26:36.882329 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m12:26:36.892035 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m12:26:36.920390 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m12:26:36.929381 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:26:36.930379 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m12:26:36.931172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:36.951219 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:26:36.952775 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:26:36.954090 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:26:37.153318 [debug] [Thread-1 (]: SQL status: OK in 0.198 seconds
[0m12:26:37.159551 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:26:37.160662 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m12:26:37.162302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:37.168433 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:26:37.169485 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m12:26:37.170802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:26:37.172753 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:26:37.173577 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:26:37.174465 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:26:37.191417 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:26:37.198426 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:26:37.199693 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m12:26:37.202444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:37.204512 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m12:26:37.218420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4025707af0>]}
[0m12:26:37.219715 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.35s]
[0m12:26:37.221237 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m12:26:37.224371 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m12:26:37.225803 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m12:26:37.227297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m12:26:37.228541 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m12:26:37.237011 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.248767 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m12:26:37.257471 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.273942 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.275865 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m12:26:37.276857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:37.305943 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m12:26:37.307483 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.308552 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m12:26:37.526373 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m12:26:37.532364 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.533342 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m12:26:37.534893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:37.540060 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.540989 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m12:26:37.542670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:37.545195 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:26:37.546270 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.547118 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:26:37.562668 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:26:37.567531 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:26:37.568470 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m12:26:37.571605 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:37.573899 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m12:26:37.592229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff5a2950>]}
[0m12:26:37.593842 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.36s]
[0m12:26:37.595496 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m12:26:37.597975 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m12:26:37.599274 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m12:26:37.600703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m12:26:37.601614 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m12:26:37.613166 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.620794 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m12:26:37.628438 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.638615 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.639946 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m12:26:37.640757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:37.664448 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:26:37.666250 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.667378 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m12:26:37.871111 [debug] [Thread-1 (]: SQL status: OK in 0.203 seconds
[0m12:26:37.878758 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.879772 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m12:26:37.881314 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:26:37.886080 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.887030 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m12:26:37.888211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:26:37.890062 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:26:37.890878 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.891882 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:26:37.906214 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:26:37.911317 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:26:37.912321 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m12:26:37.914951 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:37.916973 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m12:26:37.934126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff16cb80>]}
[0m12:26:37.935591 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.33s]
[0m12:26:37.937921 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m12:26:37.939847 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m12:26:37.941225 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m12:26:37.943440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m12:26:37.945333 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m12:26:37.962882 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:37.970785 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m12:26:37.979883 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:37.988402 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:37.989538 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m12:26:37.990392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:38.018005 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:26:38.019943 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:38.021097 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m12:26:38.222486 [debug] [Thread-1 (]: SQL status: OK in 0.200 seconds
[0m12:26:38.228164 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:38.229058 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m12:26:38.230342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:26:38.234955 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:38.235764 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m12:26:38.237192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:26:38.239054 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:26:38.239880 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:38.240704 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:26:38.257083 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:26:38.261819 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:26:38.262912 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m12:26:38.265602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:38.267759 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m12:26:38.289299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff17afb0>]}
[0m12:26:38.291430 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.35s]
[0m12:26:38.294483 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m12:26:38.296661 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m12:26:38.297853 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m12:26:38.299210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m12:26:38.300985 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m12:26:38.311699 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.320882 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m12:26:38.329713 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.339061 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.340246 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m12:26:38.341092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:38.368033 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:26:38.369783 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.371002 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m12:26:38.587235 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m12:26:38.595055 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.599207 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m12:26:38.601199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:38.606496 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.607709 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m12:26:38.609407 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:38.611366 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:26:38.612177 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.613004 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:26:38.616948 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:26:38.621049 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:26:38.621962 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m12:26:38.626309 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:26:38.633921 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m12:26:38.658149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffe8415d0>]}
[0m12:26:38.660129 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.36s]
[0m12:26:38.661898 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m12:26:38.663709 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m12:26:38.664866 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m12:26:38.666513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m12:26:38.667400 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m12:26:38.676558 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m12:26:38.684677 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m12:26:38.777151 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m12:26:38.784026 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:26:38.784892 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m12:26:38.785667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:38.804704 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m12:26:38.806077 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:26:38.807066 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m12:26:39.507943 [debug] [Thread-1 (]: SQL status: OK in 0.700 seconds
[0m12:26:39.514949 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:26:39.516379 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m12:26:39.517884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:39.522551 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:26:39.523420 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m12:26:39.524933 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:39.528679 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:26:39.529632 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:26:39.530536 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:26:39.580683 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m12:26:39.585367 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:26:39.586605 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m12:26:39.589451 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:39.591539 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m12:26:39.653824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fffb3f-eb5b-4ecb-b4f8-3199ad58b24d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff1b0b20>]}
[0m12:26:39.655154 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 0.99s]
[0m12:26:39.656776 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m12:26:39.659779 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:39.660939 [debug] [MainThread]: On master: BEGIN
[0m12:26:39.661812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:39.685606 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m12:26:39.687292 [debug] [MainThread]: On master: COMMIT
[0m12:26:39.688066 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:39.688885 [debug] [MainThread]: On master: COMMIT
[0m12:26:39.690007 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:26:39.691060 [debug] [MainThread]: On master: Close
[0m12:26:39.698878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:39.700463 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:26:39.701595 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m12:26:39.702910 [info ] [MainThread]: 
[0m12:26:39.704005 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m12:26:39.707202 [debug] [MainThread]: Command end result
[0m12:26:39.819397 [info ] [MainThread]: 
[0m12:26:39.820955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:39.822496 [info ] [MainThread]: 
[0m12:26:39.823781 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:26:39.826256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.675361, "process_user_time": 6.792004, "process_kernel_time": 0.770227, "process_mem_max_rss": "238280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:39.827539 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:39.827373 after 9.68 seconds
[0m12:26:39.828537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f403281ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40325a07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40318c4c10>]}
[0m12:26:39.829538 [debug] [MainThread]: Flushing usage events
[0m12:26:42.650461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bf1bcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd6cfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd6cff10>]}


============================== 12:26:42.653967 | 52c3e011-cdb4-4f3f-997f-037ffe07d59c ==============================
[0m12:26:42.653967 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:26:42.655355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m12:26:42.953560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52c3e011-cdb4-4f3f-997f-037ffe07d59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bf059ed0>]}
[0m12:26:43.045838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52c3e011-cdb4-4f3f-997f-037ffe07d59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bd74ad40>]}
[0m12:26:43.047491 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:26:43.122881 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:26:45.493813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:45.494864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:45.505884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:26:45.576284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52c3e011-cdb4-4f3f-997f-037ffe07d59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b19f4e50>]}
[0m12:26:45.764591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52c3e011-cdb4-4f3f-997f-037ffe07d59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b1bb4520>]}
[0m12:26:45.765632 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:26:45.766655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c3e011-cdb4-4f3f-997f-037ffe07d59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b1bd8d30>]}
[0m12:26:45.770122 [info ] [MainThread]: 
[0m12:26:45.771699 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:26:45.781821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m12:26:45.917293 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:26:45.918362 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:26:45.919133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:45.939562 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:26:45.940806 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:26:45.941624 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:26:45.963893 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:26:45.971677 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:26:45.973083 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:26:45.974393 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:26:45.982623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c3e011-cdb4-4f3f-997f-037ffe07d59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b1bb4f10>]}
[0m12:26:45.983707 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:45.984492 [debug] [MainThread]: On master: BEGIN
[0m12:26:45.985193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:46.003459 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m12:26:46.004616 [debug] [MainThread]: On master: COMMIT
[0m12:26:46.005434 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:46.006344 [debug] [MainThread]: On master: COMMIT
[0m12:26:46.007434 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:26:46.008188 [debug] [MainThread]: On master: Close
[0m12:26:46.011476 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:26:46.012540 [info ] [MainThread]: 
[0m12:26:46.016258 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:26:46.017195 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m12:26:46.018540 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:26:46.019579 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:26:46.061425 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:26:46.070199 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:26:46.102923 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:26:46.112088 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:26:46.113238 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m12:26:46.114097 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:46.136079 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:26:46.137764 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:26:46.138698 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:26:46.141055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:46.148676 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m12:26:46.150007 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:26:46.150837 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m12:26:46.157676 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.14s]
[0m12:26:46.159368 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:26:46.160898 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:26:46.162114 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m12:26:46.163615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m12:26:46.164580 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:26:46.172777 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:26:46.181132 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:26:46.187254 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:26:46.197999 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:26:46.199473 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m12:26:46.200377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:46.224759 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:26:46.227092 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:26:46.228389 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:26:46.231095 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:46.234334 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m12:26:46.235488 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m12:26:46.236437 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m12:26:46.244245 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m12:26:46.246127 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:26:46.247203 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:26:46.248218 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m12:26:46.249627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m12:26:46.250536 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:26:46.264535 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:26:46.273587 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:26:46.283844 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:26:46.293277 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:26:46.294899 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m12:26:46.296319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:46.319316 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:26:46.320822 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:26:46.321743 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m12:26:46.323595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:46.327037 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m12:26:46.328350 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m12:26:46.329184 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m12:26:46.335710 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m12:26:46.337374 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:26:46.338566 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:26:46.339547 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m12:26:46.341055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m12:26:46.342016 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:26:46.350910 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:26:46.358608 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:26:46.366060 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:26:46.375095 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:26:46.376761 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m12:26:46.377983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:46.400959 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:26:46.402602 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:26:46.403877 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m12:26:46.406180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:46.409853 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m12:26:46.412095 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m12:26:46.413064 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m12:26:46.420229 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m12:26:46.422251 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:26:46.423514 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:26:46.424663 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m12:26:46.426196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m12:26:46.427222 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:26:46.438951 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:26:46.448934 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:26:46.455770 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:26:46.466314 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:26:46.467833 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m12:26:46.468848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:46.491821 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m12:26:46.493556 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:26:46.494837 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:26:46.522973 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m12:26:46.528984 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m12:26:46.530561 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m12:26:46.531680 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m12:26:46.541014 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.11s]
[0m12:26:46.543480 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:26:46.547232 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:46.548466 [debug] [MainThread]: On master: BEGIN
[0m12:26:46.549309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:46.572224 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m12:26:46.573984 [debug] [MainThread]: On master: COMMIT
[0m12:26:46.575267 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:46.576433 [debug] [MainThread]: On master: COMMIT
[0m12:26:46.578085 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:26:46.579050 [debug] [MainThread]: On master: Close
[0m12:26:46.587838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:46.589963 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:26:46.591438 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m12:26:46.593074 [info ] [MainThread]: 
[0m12:26:46.594724 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m12:26:46.597101 [debug] [MainThread]: Command end result
[0m12:26:46.707674 [info ] [MainThread]: 
[0m12:26:46.709654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:46.711360 [info ] [MainThread]: 
[0m12:26:46.712568 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:26:46.714558 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.163819, "process_user_time": 3.025247, "process_kernel_time": 0.388107, "process_mem_max_rss": "192388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:46.715946 [debug] [MainThread]: Command `dbt test` succeeded at 12:26:46.715749 after 4.17 seconds
[0m12:26:46.716889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57bf1bcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b1cb71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57be2e5f30>]}
[0m12:26:46.717760 [debug] [MainThread]: Flushing usage events
[0m12:26:49.265040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddbc78b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda1315d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda131570>]}


============================== 12:26:49.268429 | e59b510f-c15b-461c-a9ad-49ea656df75a ==============================
[0m12:26:49.268429 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:26:49.269735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:49.611803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e59b510f-c15b-461c-a9ad-49ea656df75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dd6ec66e0>]}
[0m12:26:49.707797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e59b510f-c15b-461c-a9ad-49ea656df75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dda3efd60>]}
[0m12:26:49.709780 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:26:49.773797 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m12:26:49.915438 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:26:49.916885 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m12:26:49.917952 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:26:49.919190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e59b510f-c15b-461c-a9ad-49ea656df75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddada08b0>]}
[0m12:26:54.004088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:26:54.018061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e59b510f-c15b-461c-a9ad-49ea656df75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dcee9c7c0>]}
[0m12:26:54.205288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e59b510f-c15b-461c-a9ad-49ea656df75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dcec10130>]}
[0m12:26:54.206715 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:26:54.209056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59b510f-c15b-461c-a9ad-49ea656df75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dcebf6c80>]}
[0m12:26:54.210865 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m12:26:54.211810 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:26:54.212679 [debug] [MainThread]: On macro_publish: BEGIN
[0m12:26:54.213521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:54.242561 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m12:26:54.245389 [debug] [MainThread]: On macro_publish: COMMIT
[0m12:26:54.246814 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:26:54.247971 [debug] [MainThread]: On macro_publish: COMMIT
[0m12:26:54.250507 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:26:54.264759 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m12:26:54.322879 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:26:54.324586 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m12:26:54.326735 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:26:54.329419 [info ] [MainThread]: Schema dbt_green created or already exists
[0m12:26:54.331374 [info ] [MainThread]: Merging into green environment...
[0m12:26:54.333285 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m12:26:54.334808 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m12:26:54.542676 [debug] [MainThread]: SQL status: OK in 0.207 seconds
[0m12:26:54.544818 [info ] [MainThread]: Merge into green environment done
[0m12:26:54.545919 [debug] [MainThread]: On macro_publish: Close
[0m12:26:54.683178 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 5.5116596, "process_user_time": 4.928584, "process_kernel_time": 0.382216, "process_mem_max_rss": "212336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:54.684907 [debug] [MainThread]: Command `dbt run-operation` succeeded at 12:26:54.684732 after 5.51 seconds
[0m12:26:54.685926 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m12:26:54.687104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddbc78b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dcec25f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dcec26b30>]}
[0m12:26:54.688179 [debug] [MainThread]: Flushing usage events
[0m12:59:41.530167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb046a0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb02ad56f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb02ad5690>]}


============================== 12:59:41.534996 | a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0 ==============================
[0m12:59:41.534996 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:59:41.537226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:59:41.901148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb02aeb520>]}
[0m12:59:41.998957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaff8c74c0>]}
[0m12:59:42.001153 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:59:42.080684 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:59:42.230427 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:59:42.231665 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m12:59:42.232647 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:59:42.233816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb03748910>]}
[0m12:59:46.941397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:59:46.954040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf76e9930>]}
[0m12:59:47.158488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf76265f0>]}
[0m12:59:47.160050 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:59:47.161249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf76275e0>]}
[0m12:59:47.165575 [info ] [MainThread]: 
[0m12:59:47.167467 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:59:47.178575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:59:47.254049 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:59:47.255306 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:59:47.256414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:47.280098 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:59:47.282289 [debug] [ThreadPool]: On list_dev: Close
[0m12:59:47.286714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m12:59:47.288011 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m12:59:47.299487 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:59:47.300409 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:59:47.301598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:47.319235 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:59:47.321451 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:59:47.322481 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m12:59:47.324411 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:47.325555 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:59:47.326464 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m12:59:47.328339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:47.330150 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:59:47.330910 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m12:59:47.331618 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m12:59:47.333286 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:59:47.334230 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m12:59:47.339707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m12:59:47.347630 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:59:47.348654 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:59:47.349662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:47.366108 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:59:47.367164 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:59:47.368078 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:59:47.391964 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:59:47.398610 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:59:47.400268 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:59:47.401071 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:59:47.408196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb04715960>]}
[0m12:59:47.409283 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:47.410030 [debug] [MainThread]: On master: BEGIN
[0m12:59:47.410740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:47.426667 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m12:59:47.427645 [debug] [MainThread]: On master: COMMIT
[0m12:59:47.428342 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:47.429018 [debug] [MainThread]: On master: COMMIT
[0m12:59:47.429986 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:47.430738 [debug] [MainThread]: On master: Close
[0m12:59:47.434150 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:59:47.435313 [info ] [MainThread]: 
[0m12:59:47.442140 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m12:59:47.443599 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m12:59:47.445074 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m12:59:47.446247 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m12:59:47.462754 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m12:59:47.472938 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m12:59:47.537604 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m12:59:47.545758 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:59:47.546782 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m12:59:47.547554 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:47.567422 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:59:47.568883 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:59:47.569765 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m12:59:47.622436 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m12:59:47.634083 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:59:47.635307 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m12:59:47.637322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:47.643937 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:59:47.644890 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m12:59:47.646327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:47.672255 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:59:47.673496 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:59:47.674418 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m12:59:47.695117 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m12:59:47.704436 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m12:59:47.705923 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m12:59:47.709484 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:59:47.713715 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m12:59:47.751553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf5201600>]}
[0m12:59:47.753239 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.31s]
[0m12:59:47.756206 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m12:59:47.757475 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m12:59:47.758775 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m12:59:47.760220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m12:59:47.761093 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m12:59:47.767059 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m12:59:47.775520 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m12:59:47.787431 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m12:59:47.797015 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:59:47.798197 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m12:59:47.799100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:47.823452 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:59:47.825622 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:59:47.826820 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m12:59:47.876449 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m12:59:47.881939 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:59:47.883051 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m12:59:47.884603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:47.891259 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:59:47.892292 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:59:47.893710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:47.895774 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:59:47.896876 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:59:47.897928 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m12:59:47.904333 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:59:47.909066 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m12:59:47.909959 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m12:59:47.912660 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:47.914540 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m12:59:47.964130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf54a5d20>]}
[0m12:59:47.965634 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m12:59:47.967371 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m12:59:47.968518 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m12:59:47.969860 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m12:59:47.971604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m12:59:47.972534 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m12:59:47.979710 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m12:59:47.987500 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m12:59:47.999028 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m12:59:48.011113 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:59:48.012515 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m12:59:48.013347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:48.042718 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m12:59:48.044001 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:59:48.044964 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m12:59:48.064101 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m12:59:48.073027 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:59:48.074413 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m12:59:48.076725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:48.082640 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:59:48.083820 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m12:59:48.085591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:48.088699 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:59:48.089766 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:59:48.090935 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m12:59:48.150166 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m12:59:48.156421 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m12:59:48.157524 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m12:59:48.162155 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:59:48.164569 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m12:59:48.199238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf48da7d0>]}
[0m12:59:48.201488 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.23s]
[0m12:59:48.205052 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m12:59:48.206605 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m12:59:48.208048 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m12:59:48.209631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m12:59:48.210588 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m12:59:48.217324 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.226215 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m12:59:48.261905 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.270351 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.271988 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m12:59:48.272901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:48.301088 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m12:59:48.305853 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.307569 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m12:59:48.523311 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m12:59:48.530514 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.531851 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m12:59:48.533654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:48.539616 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.540469 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m12:59:48.541778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:48.543768 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:59:48.544605 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.545494 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m12:59:48.550439 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:59:48.556532 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m12:59:48.557606 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m12:59:48.560662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:48.563204 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m12:59:48.579798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf511a500>]}
[0m12:59:48.581115 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.37s]
[0m12:59:48.582785 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m12:59:48.584672 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m12:59:48.585757 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m12:59:48.587862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m12:59:48.589045 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m12:59:48.598572 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.610198 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m12:59:48.618322 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.627139 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.628476 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m12:59:48.629532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:48.712341 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m12:59:48.713658 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.714518 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m12:59:48.933088 [debug] [Thread-1 (]: SQL status: OK in 0.217 seconds
[0m12:59:48.940954 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.942424 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m12:59:48.944505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:48.950491 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.951437 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m12:59:48.953418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:48.956498 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:59:48.957816 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.958626 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m12:59:48.963976 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:59:48.970281 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m12:59:48.971761 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m12:59:48.975458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:59:48.978172 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m12:59:49.004123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf78afb80>]}
[0m12:59:49.007246 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.41s]
[0m12:59:49.009620 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m12:59:49.012411 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m12:59:49.013787 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m12:59:49.015300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m12:59:49.016613 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m12:59:49.030169 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.041794 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m12:59:49.052791 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.063465 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.064496 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m12:59:49.065641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:49.091989 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m12:59:49.093253 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.094476 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m12:59:49.337942 [debug] [Thread-1 (]: SQL status: OK in 0.242 seconds
[0m12:59:49.346715 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.347955 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m12:59:49.350060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:49.357943 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.359668 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m12:59:49.362061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:49.365040 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:59:49.366301 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.367282 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m12:59:49.383164 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m12:59:49.390282 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m12:59:49.391780 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m12:59:49.395484 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:59:49.398500 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m12:59:49.421285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaff8c7be0>]}
[0m12:59:49.423756 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.41s]
[0m12:59:49.425891 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m12:59:49.428916 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m12:59:49.430264 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m12:59:49.431822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m12:59:49.432970 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m12:59:49.447488 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.458087 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m12:59:49.466164 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.477223 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.478522 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m12:59:49.479352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:49.501801 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:59:49.504647 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.506199 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m12:59:49.722832 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m12:59:49.731277 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.732451 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m12:59:49.733979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:49.739343 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.740461 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m12:59:49.741856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:49.743752 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:59:49.744581 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.745364 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m12:59:49.760609 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:59:49.768487 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m12:59:49.769951 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m12:59:49.772755 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:49.775088 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m12:59:49.792624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf78acc10>]}
[0m12:59:49.794045 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.36s]
[0m12:59:49.795700 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m12:59:49.797742 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m12:59:49.799040 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m12:59:49.800495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m12:59:49.802147 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m12:59:49.815742 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m12:59:49.829975 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m12:59:49.839391 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m12:59:49.847914 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:59:49.849029 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m12:59:49.849873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:49.874821 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:59:49.876752 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:59:49.877919 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m12:59:50.101589 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m12:59:50.107533 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:59:50.108880 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m12:59:50.110257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:50.115330 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:59:50.116247 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m12:59:50.117752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:50.120120 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:59:50.120986 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:59:50.121841 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m12:59:50.136816 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:59:50.142530 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m12:59:50.143627 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m12:59:50.146496 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:50.149210 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m12:59:50.166582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf516f280>]}
[0m12:59:50.168204 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.37s]
[0m12:59:50.170413 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m12:59:50.173263 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m12:59:50.174453 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m12:59:50.176202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m12:59:50.177346 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m12:59:50.192176 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m12:59:50.202929 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m12:59:50.314526 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m12:59:50.322558 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:59:50.323707 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m12:59:50.324697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:50.346772 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:59:50.348208 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:59:50.349101 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m12:59:51.130547 [debug] [Thread-1 (]: SQL status: OK in 0.780 seconds
[0m12:59:51.137749 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:59:51.139056 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m12:59:51.141024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:51.147090 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:59:51.148102 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m12:59:51.149732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:51.152617 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:59:51.153776 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:59:51.154766 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m12:59:51.209640 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m12:59:51.214965 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m12:59:51.216171 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m12:59:51.219147 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:51.221156 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m12:59:51.283820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a31a98-c9f4-42b8-bfa6-f060cb1d8fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf5190d60>]}
[0m12:59:51.285482 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.11s]
[0m12:59:51.288365 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m12:59:51.290758 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:51.291632 [debug] [MainThread]: On master: BEGIN
[0m12:59:51.292457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:51.314003 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m12:59:51.315627 [debug] [MainThread]: On master: COMMIT
[0m12:59:51.316757 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:51.318086 [debug] [MainThread]: On master: COMMIT
[0m12:59:51.320314 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:59:51.321610 [debug] [MainThread]: On master: Close
[0m12:59:51.328959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:51.330011 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:59:51.330912 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m12:59:51.331988 [info ] [MainThread]: 
[0m12:59:51.333084 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m12:59:51.337849 [debug] [MainThread]: Command end result
[0m12:59:51.444544 [info ] [MainThread]: 
[0m12:59:51.446518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:51.448133 [info ] [MainThread]: 
[0m12:59:51.449461 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:59:51.452112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.014566, "process_user_time": 7.342986, "process_kernel_time": 0.822414, "process_mem_max_rss": "237480", "process_in_blocks": "46192", "process_out_blocks": "0"}
[0m12:59:51.453155 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:51.453032 after 10.02 seconds
[0m12:59:51.454052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb046a0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb03e99cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf5132a70>]}
[0m12:59:51.454951 [debug] [MainThread]: Flushing usage events
[0m12:59:54.223877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b78288b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b76735750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b767356f0>]}


============================== 12:59:54.227388 | 82d3a961-fe0e-4610-b610-35cbbcba2f24 ==============================
[0m12:59:54.227388 [info ] [MainThread]: Running with dbt=1.8.4
[0m12:59:54.229372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:59:54.561107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82d3a961-fe0e-4610-b610-35cbbcba2f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b78119f90>]}
[0m12:59:54.653494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82d3a961-fe0e-4610-b610-35cbbcba2f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b734c5c00>]}
[0m12:59:54.655330 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m12:59:54.728783 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m12:59:57.122130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:57.123293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:57.132466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m12:59:57.196358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82d3a961-fe0e-4610-b610-35cbbcba2f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b2ecf10>]}
[0m12:59:57.391585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82d3a961-fe0e-4610-b610-35cbbcba2f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b29d6f0>]}
[0m12:59:57.393041 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m12:59:57.394475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82d3a961-fe0e-4610-b610-35cbbcba2f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b2e33d0>]}
[0m12:59:57.397283 [info ] [MainThread]: 
[0m12:59:57.398900 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:59:57.408817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m12:59:57.540835 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:59:57.542110 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m12:59:57.543038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:57.563338 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:59:57.564341 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m12:59:57.565216 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m12:59:57.587891 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:59:57.594512 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m12:59:57.595965 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m12:59:57.597552 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m12:59:57.607387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82d3a961-fe0e-4610-b610-35cbbcba2f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b2b5060>]}
[0m12:59:57.609023 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:57.609807 [debug] [MainThread]: On master: BEGIN
[0m12:59:57.610504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:57.629519 [debug] [MainThread]: SQL status: OK in 0.019 seconds
[0m12:59:57.630600 [debug] [MainThread]: On master: COMMIT
[0m12:59:57.631514 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:57.632293 [debug] [MainThread]: On master: COMMIT
[0m12:59:57.633445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:57.634330 [debug] [MainThread]: On master: Close
[0m12:59:57.640377 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m12:59:57.641654 [info ] [MainThread]: 
[0m12:59:57.646722 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:59:57.647751 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m12:59:57.649377 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:59:57.650546 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:59:57.691021 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:59:57.704628 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:59:57.735579 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:59:57.744078 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:59:57.745244 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m12:59:57.746051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:57.767742 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m12:59:57.769402 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m12:59:57.770464 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:59:57.783365 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:59:57.790112 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m12:59:57.791640 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m12:59:57.792696 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m12:59:57.797940 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.15s]
[0m12:59:57.799967 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m12:59:57.801060 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:59:57.801980 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m12:59:57.803289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m12:59:57.804346 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:59:57.811849 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:59:57.820989 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:59:57.827547 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:59:57.838460 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:59:57.840116 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m12:59:57.841255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:57.866952 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m12:59:57.869794 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m12:59:57.871124 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:59:57.874021 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:57.877271 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m12:59:57.878415 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m12:59:57.879387 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m12:59:57.889228 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m12:59:57.891969 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m12:59:57.893482 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:59:57.894710 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m12:59:57.896263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m12:59:57.897328 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:59:57.912839 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:59:57.922494 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:59:57.933130 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:59:57.943785 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:59:57.945099 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m12:59:57.945920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:57.970590 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m12:59:57.972649 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m12:59:57.973792 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m12:59:57.975981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:59:57.979081 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m12:59:57.980193 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m12:59:57.980994 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m12:59:57.988671 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m12:59:57.990909 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m12:59:57.992191 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:59:57.993212 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m12:59:57.994806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m12:59:57.995768 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:59:58.005472 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:59:58.013866 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:59:58.020184 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:59:58.029658 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:59:58.030752 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m12:59:58.031775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:58.064146 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m12:59:58.066028 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m12:59:58.067363 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m12:59:58.071323 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:59:58.075565 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m12:59:58.076989 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m12:59:58.077964 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m12:59:58.086631 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m12:59:58.088458 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m12:59:58.089915 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:59:58.090970 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m12:59:58.092485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m12:59:58.093450 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:59:58.106208 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:59:58.113499 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:59:58.119122 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:59:58.129261 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:59:58.130629 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m12:59:58.131929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:58.157781 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m12:59:58.159408 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m12:59:58.160582 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:59:58.192735 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m12:59:58.197318 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m12:59:58.200100 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m12:59:58.201199 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m12:59:58.210630 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m12:59:58.212529 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m12:59:58.215133 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:58.216102 [debug] [MainThread]: On master: BEGIN
[0m12:59:58.217056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:58.239841 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m12:59:58.241441 [debug] [MainThread]: On master: COMMIT
[0m12:59:58.242483 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:58.243382 [debug] [MainThread]: On master: COMMIT
[0m12:59:58.244547 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:59:58.245415 [debug] [MainThread]: On master: Close
[0m12:59:58.252773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:58.254138 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m12:59:58.255360 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m12:59:58.256372 [info ] [MainThread]: 
[0m12:59:58.257538 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m12:59:58.260556 [debug] [MainThread]: Command end result
[0m12:59:58.379944 [info ] [MainThread]: 
[0m12:59:58.381341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:58.382670 [info ] [MainThread]: 
[0m12:59:58.383818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:59:58.385609 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.255226, "process_user_time": 2.999851, "process_kernel_time": 0.432765, "process_mem_max_rss": "192616", "process_in_blocks": "1848", "process_out_blocks": "0"}
[0m12:59:58.386877 [debug] [MainThread]: Command `dbt test` succeeded at 12:59:58.386717 after 4.26 seconds
[0m12:59:58.387878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b78288b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b77adf280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b76f1b6a0>]}
[0m12:59:58.388926 [debug] [MainThread]: Flushing usage events
[0m13:00:00.976234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6619bcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd65fea3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd65fea3c10>]}


============================== 13:00:00.980000 | 4a13d14d-e76e-46b0-b3c8-885b108448cd ==============================
[0m13:00:00.980000 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:00:00.982713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:00:01.299657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a13d14d-e76e-46b0-b3c8-885b108448cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd654d1a6e0>]}
[0m13:00:01.395846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a13d14d-e76e-46b0-b3c8-885b108448cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd660103d60>]}
[0m13:00:01.397988 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:00:01.470101 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m13:00:01.617268 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:01.618975 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m13:00:01.620219 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:00:01.621561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a13d14d-e76e-46b0-b3c8-885b108448cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd660ab08b0>]}
[0m13:00:06.280112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:00:06.290471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a13d14d-e76e-46b0-b3c8-885b108448cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd654b4ccd0>]}
[0m13:00:06.472768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a13d14d-e76e-46b0-b3c8-885b108448cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd654908130>]}
[0m13:00:06.473793 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:00:06.474864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a13d14d-e76e-46b0-b3c8-885b108448cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd65499ec80>]}
[0m13:00:06.476354 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m13:00:06.477271 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:00:06.478112 [debug] [MainThread]: On macro_publish: BEGIN
[0m13:00:06.479314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:06.505834 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m13:00:06.507696 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:00:06.508681 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:00:06.509495 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:00:06.511581 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:00:06.526209 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m13:00:06.587443 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:00:06.589295 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m13:00:06.591545 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:00:06.593487 [info ] [MainThread]: Schema dbt_green created or already exists
[0m13:00:06.595008 [info ] [MainThread]: Merging into green environment...
[0m13:00:06.596703 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:00:06.600133 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m13:00:06.811799 [debug] [MainThread]: SQL status: OK in 0.209 seconds
[0m13:00:06.815213 [info ] [MainThread]: Merge into green environment done
[0m13:00:06.817167 [debug] [MainThread]: On macro_publish: Close
[0m13:00:06.953935 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.075199, "process_user_time": 5.05911, "process_kernel_time": 0.323783, "process_mem_max_rss": "215352", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m13:00:06.955785 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:00:06.955539 after 6.08 seconds
[0m13:00:06.956775 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m13:00:06.957624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6619bcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd654917790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd654917cd0>]}
[0m13:00:06.958520 [debug] [MainThread]: Flushing usage events
[0m13:12:10.118730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753fd98b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753e287a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753e287a90>]}


============================== 13:12:10.123629 | 1770c0fe-bb59-4af2-9dc0-d4939f8b727c ==============================
[0m13:12:10.123629 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:12:10.125594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:12:10.491460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753fc1df90>]}
[0m13:12:10.578758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753310dc00>]}
[0m13:12:10.580614 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:12:10.649488 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:12:10.797001 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:12:10.798323 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m13:12:10.799371 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:12:10.800602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753ee958d0>]}
[0m13:12:15.213606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:12:15.222302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7532de17b0>]}
[0m13:12:15.435370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7532d22e30>]}
[0m13:12:15.436873 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:12:15.438047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7532d23a00>]}
[0m13:12:15.442100 [info ] [MainThread]: 
[0m13:12:15.443719 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:15.454140 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:12:15.522254 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:12:15.523874 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:12:15.524748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:15.549034 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:12:15.551377 [debug] [ThreadPool]: On list_dev: Close
[0m13:12:15.555608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m13:12:15.556611 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m13:12:15.566734 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:12:15.567733 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m13:12:15.568591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:15.590806 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:12:15.594039 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:12:15.594989 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m13:12:15.597177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:15.598516 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:12:15.599393 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m13:12:15.602015 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:12:15.604131 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m13:12:15.604954 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:12:15.605861 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m13:12:15.607846 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:15.608783 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m13:12:15.618795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m13:12:15.629948 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:12:15.631072 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:12:15.632194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:15.654211 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:12:15.655682 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:12:15.656552 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m13:12:15.682212 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:12:15.692223 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m13:12:15.694443 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m13:12:15.695306 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m13:12:15.706477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753f766740>]}
[0m13:12:15.708040 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:15.708898 [debug] [MainThread]: On master: BEGIN
[0m13:12:15.709654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:15.730114 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m13:12:15.731907 [debug] [MainThread]: On master: COMMIT
[0m13:12:15.733190 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:15.734069 [debug] [MainThread]: On master: COMMIT
[0m13:12:15.735346 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:15.736196 [debug] [MainThread]: On master: Close
[0m13:12:15.742597 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m13:12:15.743748 [info ] [MainThread]: 
[0m13:12:15.750181 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m13:12:15.751617 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m13:12:15.753591 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m13:12:15.754629 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m13:12:15.771956 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m13:12:15.791443 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m13:12:15.847118 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m13:12:15.854763 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:12:15.855916 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m13:12:15.856718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:15.876201 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:12:15.877279 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:12:15.878171 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m13:12:15.934662 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m13:12:15.944649 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:12:15.945896 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m13:12:15.947380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:15.952571 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:12:15.953502 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m13:12:15.954904 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:15.981125 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m13:12:15.982264 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:12:15.983028 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m13:12:16.000340 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m13:12:16.010030 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:12:16.011668 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m13:12:16.015466 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:16.019123 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m13:12:16.058033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75308f8e50>]}
[0m13:12:16.059335 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.30s]
[0m13:12:16.060977 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m13:12:16.062022 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m13:12:16.063108 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m13:12:16.064272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m13:12:16.065145 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m13:12:16.070073 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m13:12:16.075460 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m13:12:16.084308 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m13:12:16.091541 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:12:16.092681 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m13:12:16.093384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:16.119293 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:12:16.120505 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:12:16.121397 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m13:12:16.170629 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m13:12:16.179078 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:12:16.180244 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m13:12:16.181934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:16.187262 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:12:16.188292 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:12:16.189688 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:16.191701 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m13:12:16.192570 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:12:16.193407 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m13:12:16.207379 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:12:16.212617 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:12:16.214245 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m13:12:16.218249 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:16.221526 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m13:12:16.264938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ebef2830>]}
[0m13:12:16.266690 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m13:12:16.268418 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m13:12:16.269524 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m13:12:16.270713 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m13:12:16.272122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m13:12:16.273038 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m13:12:16.280199 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m13:12:16.289032 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m13:12:16.303076 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m13:12:16.311112 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:12:16.312292 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m13:12:16.313328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:16.337730 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:16.339573 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:12:16.340823 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m13:12:16.361392 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:12:16.370686 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:12:16.372157 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m13:12:16.374220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:16.381054 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:12:16.382143 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m13:12:16.383667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:16.386832 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m13:12:16.387847 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:12:16.389073 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m13:12:16.446631 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m13:12:16.453073 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:12:16.454092 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m13:12:16.457672 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:16.459922 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m13:12:16.493691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7532effb20>]}
[0m13:12:16.495128 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.22s]
[0m13:12:16.496622 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m13:12:16.497956 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m13:12:16.499240 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m13:12:16.500941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m13:12:16.501812 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m13:12:16.508940 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.516765 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m13:12:16.554898 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.562588 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.564018 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m13:12:16.565218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:16.589317 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:16.590895 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.592063 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m13:12:16.838257 [debug] [Thread-1 (]: SQL status: OK in 0.245 seconds
[0m13:12:16.846916 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.848888 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m13:12:16.851242 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:16.858455 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.859857 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m13:12:16.861631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:16.864339 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m13:12:16.865834 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.866800 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m13:12:16.882625 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m13:12:16.891339 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:12:16.892522 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m13:12:16.896044 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:16.899187 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m13:12:16.924170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7532f5f220>]}
[0m13:12:16.926538 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.42s]
[0m13:12:16.928802 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m13:12:16.934258 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m13:12:16.935850 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m13:12:16.937566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m13:12:16.938695 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m13:12:16.951478 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m13:12:16.960178 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m13:12:16.969678 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m13:12:16.978550 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:12:16.979838 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m13:12:16.980797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:17.004538 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:12:17.006280 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:12:17.007229 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m13:12:17.294075 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m13:12:17.300257 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:12:17.301604 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m13:12:17.303188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:17.308798 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:12:17.310063 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m13:12:17.311557 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:17.313918 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m13:12:17.314791 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:12:17.315640 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m13:12:17.320015 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:17.324194 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:12:17.325501 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m13:12:17.328344 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:17.330271 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m13:12:17.355873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7530b9c730>]}
[0m13:12:17.358354 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.42s]
[0m13:12:17.360269 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m13:12:17.362758 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m13:12:17.364048 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m13:12:17.365735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m13:12:17.366957 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m13:12:17.378507 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.387580 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m13:12:17.397172 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.405395 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.407310 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m13:12:17.408746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:17.433724 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:17.436278 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.438541 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m13:12:17.674150 [debug] [Thread-1 (]: SQL status: OK in 0.234 seconds
[0m13:12:17.679857 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.681115 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m13:12:17.683849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:17.689650 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.690868 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m13:12:17.692196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:17.694050 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m13:12:17.694885 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.695779 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m13:12:17.711015 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:12:17.715925 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:12:17.716996 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m13:12:17.720255 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:17.722931 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m13:12:17.738943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75308fa380>]}
[0m13:12:17.740534 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.37s]
[0m13:12:17.742281 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m13:12:17.744060 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m13:12:17.745244 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m13:12:17.746678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m13:12:17.748050 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m13:12:17.759823 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:17.771062 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m13:12:17.779686 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:17.790012 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:17.792436 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m13:12:17.794351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:17.823388 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:12:17.825037 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:17.826316 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m13:12:18.056404 [debug] [Thread-1 (]: SQL status: OK in 0.229 seconds
[0m13:12:18.062110 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:18.063291 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m13:12:18.064838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:18.070456 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:18.071423 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m13:12:18.073029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:18.075698 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m13:12:18.077022 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:18.077984 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m13:12:18.103706 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:18.109641 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:12:18.110665 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m13:12:18.113235 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:18.117052 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m13:12:18.138073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75308fa380>]}
[0m13:12:18.139533 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.39s]
[0m13:12:18.141077 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m13:12:18.143077 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m13:12:18.144185 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m13:12:18.145605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m13:12:18.147261 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m13:12:18.158529 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.168581 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m13:12:18.178172 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.187116 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.188717 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m13:12:18.190455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:18.214621 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:18.216822 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.219136 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m13:12:18.467471 [debug] [Thread-1 (]: SQL status: OK in 0.246 seconds
[0m13:12:18.475960 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.477244 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m13:12:18.478954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:18.486440 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.487615 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m13:12:18.489027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:18.491043 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m13:12:18.491833 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.492580 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m13:12:18.497053 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:18.502569 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:12:18.503851 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m13:12:18.507925 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:18.510526 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m13:12:18.528133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7532effb20>]}
[0m13:12:18.529487 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.38s]
[0m13:12:18.531052 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m13:12:18.532854 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m13:12:18.534024 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m13:12:18.535340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m13:12:18.536257 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m13:12:18.543506 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m13:12:18.550515 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m13:12:18.692374 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m13:12:18.701638 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:12:18.702843 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m13:12:18.703741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:18.725410 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m13:12:18.727392 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:12:18.728838 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m13:12:19.591211 [debug] [Thread-1 (]: SQL status: OK in 0.861 seconds
[0m13:12:19.597329 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:12:19.598654 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m13:12:19.601598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:19.607193 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:12:19.608110 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m13:12:19.609604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:19.611719 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m13:12:19.612560 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:12:19.613721 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m13:12:19.666030 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m13:12:19.673021 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:12:19.674440 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m13:12:19.678474 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:19.681617 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m13:12:19.748556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1770c0fe-bb59-4af2-9dc0-d4939f8b727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7530876590>]}
[0m13:12:19.749984 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.21s]
[0m13:12:19.751448 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m13:12:19.753763 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:19.754587 [debug] [MainThread]: On master: BEGIN
[0m13:12:19.755505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:19.776766 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m13:12:19.778029 [debug] [MainThread]: On master: COMMIT
[0m13:12:19.778871 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:19.779651 [debug] [MainThread]: On master: COMMIT
[0m13:12:19.780977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:19.782213 [debug] [MainThread]: On master: Close
[0m13:12:19.789990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:19.791187 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:12:19.792001 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m13:12:19.793343 [info ] [MainThread]: 
[0m13:12:19.794634 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m13:12:19.798241 [debug] [MainThread]: Command end result
[0m13:12:19.932208 [info ] [MainThread]: 
[0m13:12:19.933555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:19.934687 [info ] [MainThread]: 
[0m13:12:19.935676 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:12:19.938133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.913024, "process_user_time": 7.215777, "process_kernel_time": 0.747853, "process_mem_max_rss": "235280", "process_in_blocks": "46248", "process_out_blocks": "0"}
[0m13:12:19.939229 [debug] [MainThread]: Command `dbt run` succeeded at 13:12:19.939090 after 9.91 seconds
[0m13:12:19.940054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753fd98b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f753f5df280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75308399c0>]}
[0m13:12:19.940810 [debug] [MainThread]: Flushing usage events
[0m13:12:22.804826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9a64af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad7f656c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad7f65660>]}


============================== 13:12:22.809427 | cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3 ==============================
[0m13:12:22.809427 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:12:22.811040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:12:23.118425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad4cafd60>]}
[0m13:12:23.219880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad81d3970>]}
[0m13:12:23.221522 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:12:23.302125 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:12:25.666205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:25.667619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:25.679465 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:12:25.745509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaccaece80>]}
[0m13:12:25.970116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaccc20310>]}
[0m13:12:25.971573 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:12:25.972690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaccad4d00>]}
[0m13:12:25.976900 [info ] [MainThread]: 
[0m13:12:25.978680 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:25.992463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m13:12:26.137267 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:12:26.138553 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:12:26.139680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:26.160240 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:12:26.162423 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:12:26.163763 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m13:12:26.186848 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:12:26.193163 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m13:12:26.194914 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m13:12:26.195910 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m13:12:26.203444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd0bcdf-2d4f-4ff0-9855-0ff37da852e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaccab03a0>]}
[0m13:12:26.204632 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:26.205469 [debug] [MainThread]: On master: BEGIN
[0m13:12:26.206220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:26.226087 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m13:12:26.227121 [debug] [MainThread]: On master: COMMIT
[0m13:12:26.227967 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:26.228742 [debug] [MainThread]: On master: COMMIT
[0m13:12:26.229781 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:26.230706 [debug] [MainThread]: On master: Close
[0m13:12:26.234106 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m13:12:26.235323 [info ] [MainThread]: 
[0m13:12:26.239067 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:12:26.240117 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m13:12:26.241521 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m13:12:26.242568 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:12:26.289353 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:12:26.298487 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:12:26.333286 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:12:26.342387 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:12:26.343514 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m13:12:26.344744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:26.368134 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:12:26.370035 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:12:26.371188 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m13:12:26.385130 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:12:26.392920 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m13:12:26.394338 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m13:12:26.395528 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m13:12:26.401899 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.16s]
[0m13:12:26.403754 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:12:26.405064 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:12:26.406097 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m13:12:26.407420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m13:12:26.408320 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:12:26.416616 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:12:26.424180 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:12:26.428226 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:12:26.437860 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:12:26.439109 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m13:12:26.439906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:26.464673 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:26.467168 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:12:26.468312 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m13:12:26.470861 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:26.474328 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m13:12:26.475488 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m13:12:26.476464 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m13:12:26.486742 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m13:12:26.489287 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:12:26.490725 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:12:26.491827 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m13:12:26.493274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m13:12:26.494443 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:12:26.507832 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:12:26.521889 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:12:26.534614 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:12:26.543859 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:12:26.545147 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m13:12:26.546129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:26.571673 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:12:26.573336 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:12:26.574591 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m13:12:26.576901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:26.580886 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m13:12:26.583725 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m13:12:26.584734 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m13:12:26.592102 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m13:12:26.593902 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:12:26.595417 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:12:26.596412 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m13:12:26.597761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m13:12:26.598681 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:12:26.607451 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:12:26.615618 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:12:26.622994 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:12:26.632199 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:12:26.633764 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m13:12:26.635073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:26.659504 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:12:26.661387 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:12:26.663006 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m13:12:26.667015 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:26.670661 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m13:12:26.671901 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m13:12:26.672923 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m13:12:26.680803 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m13:12:26.682727 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:12:26.684177 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:12:26.685169 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m13:12:26.686541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m13:12:26.687499 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:12:26.699815 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:12:26.707353 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:12:26.711768 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:12:26.721116 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:12:26.722322 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m13:12:26.723140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:26.746817 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:12:26.749002 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:12:26.750623 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:12:26.791660 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m13:12:26.796579 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m13:12:26.798144 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m13:12:26.799315 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m13:12:26.807879 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m13:12:26.809429 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:12:26.811841 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:26.812712 [debug] [MainThread]: On master: BEGIN
[0m13:12:26.813593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:26.834150 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m13:12:26.835668 [debug] [MainThread]: On master: COMMIT
[0m13:12:26.836945 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:26.837845 [debug] [MainThread]: On master: COMMIT
[0m13:12:26.839010 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:26.839890 [debug] [MainThread]: On master: Close
[0m13:12:26.848438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:26.850358 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:12:26.851451 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m13:12:26.852471 [info ] [MainThread]: 
[0m13:12:26.853752 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m13:12:26.856173 [debug] [MainThread]: Command end result
[0m13:12:26.965296 [info ] [MainThread]: 
[0m13:12:26.966913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:26.968357 [info ] [MainThread]: 
[0m13:12:26.969600 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:12:26.971750 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2619886, "process_user_time": 3.164782, "process_kernel_time": 0.382999, "process_mem_max_rss": "197392", "process_in_blocks": "1848", "process_out_blocks": "0"}
[0m13:12:26.973182 [debug] [MainThread]: Command `dbt test` succeeded at 13:12:26.973028 after 4.26 seconds
[0m13:12:26.974272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9a64af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaccc20310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaccdb9ed0>]}
[0m13:12:26.975234 [debug] [MainThread]: Flushing usage events
[0m13:12:29.578930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcad28af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fc922bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fc922bc10>]}


============================== 13:12:29.583047 | 4bb58a9e-16e2-42ef-993e-383ae9d98ab2 ==============================
[0m13:12:29.583047 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:12:29.584524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:29.927474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb58a9e-16e2-42ef-993e-383ae9d98ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fbe12c0d0>]}
[0m13:12:30.020385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb58a9e-16e2-42ef-993e-383ae9d98ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fc9429990>]}
[0m13:12:30.021925 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:12:30.090455 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m13:12:30.240041 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:12:30.242561 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m13:12:30.243912 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:12:30.246371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4bb58a9e-16e2-42ef-993e-383ae9d98ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fc9e45720>]}
[0m13:12:35.007454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:12:35.019588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb58a9e-16e2-42ef-993e-383ae9d98ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fbdf49b10>]}
[0m13:12:35.301733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb58a9e-16e2-42ef-993e-383ae9d98ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fbdcfe560>]}
[0m13:12:35.303894 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:12:35.306014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb58a9e-16e2-42ef-993e-383ae9d98ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fbdd14550>]}
[0m13:12:35.307434 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m13:12:35.308401 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:12:35.309671 [debug] [MainThread]: On macro_publish: BEGIN
[0m13:12:35.310790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:35.339644 [debug] [MainThread]: SQL status: OK in 0.029 seconds
[0m13:12:35.341421 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:12:35.342744 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:12:35.344017 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:12:35.346127 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:35.356177 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m13:12:35.409885 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:12:35.411378 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m13:12:35.415539 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:12:35.419187 [info ] [MainThread]: Schema dbt_green created or already exists
[0m13:12:35.420364 [info ] [MainThread]: Merging into green environment...
[0m13:12:35.421927 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:12:35.422891 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m13:12:35.673068 [debug] [MainThread]: SQL status: OK in 0.249 seconds
[0m13:12:35.676530 [info ] [MainThread]: Merge into green environment done
[0m13:12:35.678415 [debug] [MainThread]: On macro_publish: Close
[0m13:12:35.829171 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.3542824, "process_user_time": 5.185294, "process_kernel_time": 0.34233, "process_mem_max_rss": "211736", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m13:12:35.832207 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:12:35.831829 after 6.36 seconds
[0m13:12:35.833204 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m13:12:35.834246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcad28af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fbdd33f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fbdd32230>]}
[0m13:12:35.835281 [debug] [MainThread]: Flushing usage events
[0m13:14:23.070386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4493fa0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449242d6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449242d660>]}


============================== 13:14:23.075605 | 6dc48892-e3d8-4b02-8863-c56e213c73ce ==============================
[0m13:14:23.075605 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:14:23.077309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:23.398178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4493dcdf30>]}
[0m13:14:23.495735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44924afa90>]}
[0m13:14:23.497325 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:14:23.576771 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:14:23.717731 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:14:23.720224 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m13:14:23.721402 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:14:23.723678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44930588b0>]}
[0m13:14:28.390477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:14:28.399404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44871ee5f0>]}
[0m13:14:28.590480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4486f2c250>]}
[0m13:14:28.591448 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:14:28.592560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4486f2c8b0>]}
[0m13:14:28.595624 [info ] [MainThread]: 
[0m13:14:28.597675 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:14:28.608051 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:14:28.675789 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:14:28.677558 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:14:28.679115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:28.699834 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:14:28.702015 [debug] [ThreadPool]: On list_dev: Close
[0m13:14:28.706659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m13:14:28.708284 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m13:14:28.721562 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:14:28.725021 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m13:14:28.726653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:28.744398 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:14:28.746787 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:14:28.747722 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m13:14:28.749188 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:28.749925 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:14:28.750624 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m13:14:28.752120 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:28.753791 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m13:14:28.754679 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:14:28.755509 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m13:14:28.757531 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:28.758611 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m13:14:28.768271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m13:14:28.778435 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:14:28.779780 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:14:28.780725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:28.797531 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:14:28.798769 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:14:28.799647 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m13:14:28.821322 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:14:28.827182 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m13:14:28.828768 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m13:14:28.830035 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m13:14:28.837601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449265d180>]}
[0m13:14:28.838905 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:28.839734 [debug] [MainThread]: On master: BEGIN
[0m13:14:28.840475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:28.860467 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m13:14:28.861885 [debug] [MainThread]: On master: COMMIT
[0m13:14:28.862744 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:28.863561 [debug] [MainThread]: On master: COMMIT
[0m13:14:28.864657 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:28.865410 [debug] [MainThread]: On master: Close
[0m13:14:28.871849 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m13:14:28.873419 [info ] [MainThread]: 
[0m13:14:28.878839 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m13:14:28.880206 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m13:14:28.881531 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m13:14:28.882558 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m13:14:28.898110 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m13:14:28.907770 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m13:14:28.969488 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m13:14:28.976924 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:14:28.977811 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m13:14:28.978689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:28.996613 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m13:14:28.997766 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:14:28.998940 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m13:14:29.046516 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:14:29.057750 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:14:29.058938 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m13:14:29.060932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:29.066201 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:14:29.067114 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m13:14:29.068397 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:29.095176 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m13:14:29.096563 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:14:29.097649 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m13:14:29.117638 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:14:29.129853 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:14:29.130983 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m13:14:29.134103 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:29.137886 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m13:14:29.177804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4484cfc940>]}
[0m13:14:29.179234 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.30s]
[0m13:14:29.180731 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m13:14:29.181821 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m13:14:29.183081 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m13:14:29.184535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m13:14:29.185424 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m13:14:29.191107 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m13:14:29.197623 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m13:14:29.207065 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m13:14:29.216039 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:14:29.217388 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m13:14:29.218257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:29.244954 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:14:29.246714 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:14:29.247970 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m13:14:29.305541 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m13:14:29.312109 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:14:29.313107 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m13:14:29.314632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:29.319763 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:14:29.320771 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:14:29.322113 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:29.324067 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m13:14:29.324882 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:14:29.325739 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m13:14:29.332399 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:14:29.337809 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:14:29.338662 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m13:14:29.341414 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:29.343395 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m13:14:29.388602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4493092ef0>]}
[0m13:14:29.390228 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m13:14:29.391589 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m13:14:29.392755 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m13:14:29.394054 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m13:14:29.395269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m13:14:29.396510 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m13:14:29.401709 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m13:14:29.413130 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m13:14:29.425912 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m13:14:29.441466 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:14:29.442644 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m13:14:29.443604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:29.464789 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m13:14:29.466415 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:14:29.467681 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m13:14:29.488212 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:14:29.496933 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:14:29.498204 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m13:14:29.499844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:29.505043 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:14:29.506022 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m13:14:29.507620 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:29.510242 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m13:14:29.511196 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:14:29.512187 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m13:14:29.557359 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m13:14:29.564068 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:14:29.565183 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m13:14:29.568056 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:29.570288 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m13:14:29.603898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4487143b20>]}
[0m13:14:29.607148 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m13:14:29.610388 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m13:14:29.611837 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m13:14:29.613137 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m13:14:29.614802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m13:14:29.616013 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m13:14:29.627233 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m13:14:29.639066 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m13:14:29.677807 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m13:14:29.684787 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:14:29.685805 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m13:14:29.686891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:29.710803 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:14:29.712500 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:14:29.713606 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m13:14:29.973295 [debug] [Thread-1 (]: SQL status: OK in 0.259 seconds
[0m13:14:29.978937 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:14:29.979894 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m13:14:29.981442 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:29.986715 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:14:29.994576 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m13:14:29.996676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:29.999606 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m13:14:30.000791 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:14:30.001885 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m13:14:30.010143 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:14:30.015269 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:14:30.016622 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m13:14:30.019627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:30.022191 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m13:14:30.041958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4484c28310>]}
[0m13:14:30.044277 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.43s]
[0m13:14:30.045961 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m13:14:30.048427 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m13:14:30.049751 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m13:14:30.051100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m13:14:30.052176 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m13:14:30.060234 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.068310 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m13:14:30.076858 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.085123 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.087328 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m13:14:30.089727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:30.113213 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:14:30.114939 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.116034 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m13:14:30.362009 [debug] [Thread-1 (]: SQL status: OK in 0.245 seconds
[0m13:14:30.367716 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.369129 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m13:14:30.370713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:30.375670 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.376614 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m13:14:30.377969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:30.379933 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m13:14:30.380794 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.381608 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m13:14:30.386274 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:14:30.390422 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:14:30.391299 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m13:14:30.395209 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:14:30.397129 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m13:14:30.424582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44871630a0>]}
[0m13:14:30.426217 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.37s]
[0m13:14:30.428163 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m13:14:30.430496 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m13:14:30.431689 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m13:14:30.432987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m13:14:30.434305 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m13:14:30.446622 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.461400 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m13:14:30.476421 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.489322 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.492352 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m13:14:30.493730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:30.519854 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:14:30.521905 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.524496 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m13:14:30.787345 [debug] [Thread-1 (]: SQL status: OK in 0.262 seconds
[0m13:14:30.794708 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.796265 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m13:14:30.798002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:30.803058 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.804122 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m13:14:30.806828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:30.808746 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m13:14:30.809666 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.810436 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m13:14:30.814832 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:14:30.819247 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:14:30.821006 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m13:14:30.824289 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:30.827135 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m13:14:30.845356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f448727aaa0>]}
[0m13:14:30.846700 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.41s]
[0m13:14:30.848401 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m13:14:30.850320 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m13:14:30.851496 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m13:14:30.853048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m13:14:30.854231 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m13:14:30.863439 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:30.874881 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m13:14:30.884301 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:30.893172 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:30.894635 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m13:14:30.895786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:30.917679 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m13:14:30.919592 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:30.921052 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m13:14:31.179696 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m13:14:31.185890 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:31.186899 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m13:14:31.188460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:31.193799 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:31.194989 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m13:14:31.196188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:31.198072 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m13:14:31.199164 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:31.200263 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m13:14:31.205953 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:14:31.210316 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:14:31.211302 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m13:14:31.213951 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:31.215899 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m13:14:31.236415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f449265c910>]}
[0m13:14:31.238546 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.38s]
[0m13:14:31.240374 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m13:14:31.242161 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m13:14:31.243356 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m13:14:31.244687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m13:14:31.245609 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m13:14:31.252920 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.260397 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m13:14:31.268007 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.277983 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.279406 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m13:14:31.280387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:31.305623 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:14:31.308125 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.309302 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m13:14:31.561952 [debug] [Thread-1 (]: SQL status: OK in 0.251 seconds
[0m13:14:31.570554 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.571774 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m13:14:31.573273 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:31.578132 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.579224 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m13:14:31.580850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:31.582690 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m13:14:31.583679 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.584815 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m13:14:31.599316 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:14:31.603908 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:14:31.606016 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m13:14:31.608593 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:31.610650 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m13:14:31.630520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4487385600>]}
[0m13:14:31.632640 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.39s]
[0m13:14:31.634382 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m13:14:31.636404 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m13:14:31.637546 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m13:14:31.639133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m13:14:31.640308 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m13:14:31.649126 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m13:14:31.658964 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m13:14:31.772282 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m13:14:31.779963 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:14:31.780722 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m13:14:31.781438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:31.796487 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m13:14:31.797594 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:14:31.798411 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m13:14:32.677788 [debug] [Thread-1 (]: SQL status: OK in 0.878 seconds
[0m13:14:32.683703 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:14:32.684836 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m13:14:32.686595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:32.692011 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:14:32.693060 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m13:14:32.694377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:32.696777 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m13:14:32.697600 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:14:32.698386 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m13:14:32.760126 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m13:14:32.768009 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:14:32.769382 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m13:14:32.773239 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:14:32.775310 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m13:14:32.838419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc48892-e3d8-4b02-8863-c56e213c73ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4484963850>]}
[0m13:14:32.839907 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.20s]
[0m13:14:32.841558 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m13:14:32.843729 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:32.844545 [debug] [MainThread]: On master: BEGIN
[0m13:14:32.845336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:32.865250 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m13:14:32.866398 [debug] [MainThread]: On master: COMMIT
[0m13:14:32.867310 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:32.868097 [debug] [MainThread]: On master: COMMIT
[0m13:14:32.869363 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:14:32.870434 [debug] [MainThread]: On master: Close
[0m13:14:32.880064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:32.881460 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:14:32.882355 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m13:14:32.883440 [info ] [MainThread]: 
[0m13:14:32.885354 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m13:14:32.890269 [debug] [MainThread]: Command end result
[0m13:14:33.001700 [info ] [MainThread]: 
[0m13:14:33.003631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:33.005462 [info ] [MainThread]: 
[0m13:14:33.006913 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:14:33.009293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.035193, "process_user_time": 6.929625, "process_kernel_time": 0.624472, "process_mem_max_rss": "237760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:14:33.010626 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:33.010482 after 10.04 seconds
[0m13:14:33.011674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4493fa0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4484e21e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4493cf9b40>]}
[0m13:14:33.012614 [debug] [MainThread]: Flushing usage events
[0m13:14:35.812517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b7e8cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b63997b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b6399750>]}


============================== 13:14:35.816861 | 02aba6ca-be9a-4a95-8a91-1241c322f6be ==============================
[0m13:14:35.816861 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:14:35.818013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:36.128591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02aba6ca-be9a-4a95-8a91-1241c322f6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b7d15ff0>]}
[0m13:14:36.227602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02aba6ca-be9a-4a95-8a91-1241c322f6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b30bbd30>]}
[0m13:14:36.229318 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:14:36.317105 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:14:38.713538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:38.714479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:38.724683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:14:38.784004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02aba6ca-be9a-4a95-8a91-1241c322f6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aacf4f70>]}
[0m13:14:38.982092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02aba6ca-be9a-4a95-8a91-1241c322f6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aaedcdc0>]}
[0m13:14:38.983125 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:14:38.984151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02aba6ca-be9a-4a95-8a91-1241c322f6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ab1bda50>]}
[0m13:14:38.987095 [info ] [MainThread]: 
[0m13:14:38.988485 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:14:38.996746 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m13:14:39.132784 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:14:39.134081 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:14:39.135208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:39.157622 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:14:39.159244 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:14:39.160075 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m13:14:39.180700 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:14:39.187369 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m13:14:39.188532 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m13:14:39.189524 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m13:14:39.196040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02aba6ca-be9a-4a95-8a91-1241c322f6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aaeb4ee0>]}
[0m13:14:39.197423 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:39.198401 [debug] [MainThread]: On master: BEGIN
[0m13:14:39.199211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:39.217797 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m13:14:39.218994 [debug] [MainThread]: On master: COMMIT
[0m13:14:39.220138 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:39.220984 [debug] [MainThread]: On master: COMMIT
[0m13:14:39.222207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:39.223081 [debug] [MainThread]: On master: Close
[0m13:14:39.229685 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m13:14:39.231309 [info ] [MainThread]: 
[0m13:14:39.236787 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:14:39.238080 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m13:14:39.239537 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m13:14:39.240599 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:14:39.282998 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:14:39.294048 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:14:39.328618 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:14:39.338265 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:14:39.339793 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m13:14:39.341121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:39.365173 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:14:39.366836 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:14:39.368140 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m13:14:39.373489 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:14:39.379537 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m13:14:39.380921 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m13:14:39.381886 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m13:14:39.385902 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.15s]
[0m13:14:39.387711 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:14:39.389135 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:14:39.390281 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m13:14:39.391799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m13:14:39.392780 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:14:39.400654 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:14:39.411147 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:14:39.417875 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:14:39.431987 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:14:39.433662 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m13:14:39.435137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:39.460833 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:14:39.462482 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:14:39.463561 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m13:14:39.465850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:39.469524 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m13:14:39.471401 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m13:14:39.472665 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m13:14:39.480009 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m13:14:39.481669 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:14:39.483530 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:14:39.484877 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m13:14:39.486916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m13:14:39.488255 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:14:39.502613 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:14:39.512809 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:14:39.524887 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:14:39.534459 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:14:39.536057 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m13:14:39.537309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:39.562586 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:14:39.564167 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:14:39.565275 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m13:14:39.567362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:39.570870 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m13:14:39.572418 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m13:14:39.573286 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m13:14:39.580318 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m13:14:39.582078 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:14:39.583414 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:14:39.584559 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m13:14:39.586259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m13:14:39.587353 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:14:39.593708 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:14:39.601659 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:14:39.609157 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:14:39.618657 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:14:39.620114 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m13:14:39.621326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:39.646939 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:14:39.648429 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:14:39.649447 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m13:14:39.652000 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:39.656396 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m13:14:39.657916 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m13:14:39.659000 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m13:14:39.665696 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m13:14:39.667123 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:14:39.668489 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:14:39.669726 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m13:14:39.671200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m13:14:39.672331 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:14:39.685467 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:14:39.696792 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:14:39.704347 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:14:39.713674 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:14:39.714714 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m13:14:39.715605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:39.741708 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:14:39.743532 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:14:39.744717 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:14:39.777345 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m13:14:39.781812 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m13:14:39.783324 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m13:14:39.784300 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m13:14:39.794563 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m13:14:39.796417 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:14:39.799556 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:39.800499 [debug] [MainThread]: On master: BEGIN
[0m13:14:39.801462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:39.827123 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m13:14:39.828905 [debug] [MainThread]: On master: COMMIT
[0m13:14:39.830017 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:39.830888 [debug] [MainThread]: On master: COMMIT
[0m13:14:39.832230 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:39.833084 [debug] [MainThread]: On master: Close
[0m13:14:39.841371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:39.842820 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:14:39.844046 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m13:14:39.845487 [info ] [MainThread]: 
[0m13:14:39.846534 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m13:14:39.849723 [debug] [MainThread]: Command end result
[0m13:14:39.970037 [info ] [MainThread]: 
[0m13:14:39.971436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:39.973008 [info ] [MainThread]: 
[0m13:14:39.974448 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:14:39.976923 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.256191, "process_user_time": 2.998076, "process_kernel_time": 0.488058, "process_mem_max_rss": "195356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:14:39.978625 [debug] [MainThread]: Command `dbt test` succeeded at 13:14:39.978403 after 4.26 seconds
[0m13:14:39.979964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b7e8cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b76ef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9aaedcf10>]}
[0m13:14:39.981040 [debug] [MainThread]: Flushing usage events
[0m13:14:42.506715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0913d0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08f8095d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08f809570>]}


============================== 13:14:42.510338 | 55dff322-d71c-4d4e-a170-f404d97a2765 ==============================
[0m13:14:42.510338 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:14:42.511789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:14:42.834550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55dff322-d71c-4d4e-a170-f404d97a2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0847185b0>]}
[0m13:14:42.928745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55dff322-d71c-4d4e-a170-f404d97a2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08fa49990>]}
[0m13:14:42.930866 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:14:43.000089 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m13:14:43.144042 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:14:43.145297 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m13:14:43.146384 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:14:43.147444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55dff322-d71c-4d4e-a170-f404d97a2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb090479a20>]}
[0m13:14:47.820347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:14:47.832972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55dff322-d71c-4d4e-a170-f404d97a2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0845e4730>]}
[0m13:14:48.003192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55dff322-d71c-4d4e-a170-f404d97a2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0842fa560>]}
[0m13:14:48.004231 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:14:48.005319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55dff322-d71c-4d4e-a170-f404d97a2765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb084310550>]}
[0m13:14:48.006814 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m13:14:48.007865 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:14:48.008935 [debug] [MainThread]: On macro_publish: BEGIN
[0m13:14:48.009900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:48.032448 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m13:14:48.034597 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:14:48.035968 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:14:48.036911 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:14:48.039432 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:14:48.050200 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m13:14:48.098755 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:14:48.100546 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m13:14:48.103618 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:14:48.106514 [info ] [MainThread]: Schema dbt_green created or already exists
[0m13:14:48.108032 [info ] [MainThread]: Merging into green environment...
[0m13:14:48.110233 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:14:48.111150 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m13:14:48.314625 [debug] [MainThread]: SQL status: OK in 0.202 seconds
[0m13:14:48.316616 [info ] [MainThread]: Merge into green environment done
[0m13:14:48.318776 [debug] [MainThread]: On macro_publish: Close
[0m13:14:48.465643 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.0553875, "process_user_time": 5.001237, "process_kernel_time": 0.345935, "process_mem_max_rss": "216744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:14:48.466941 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:14:48.466754 after 6.06 seconds
[0m13:14:48.467999 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m13:14:48.468776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0913d0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08431cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb08431e950>]}
[0m13:14:48.469672 [debug] [MainThread]: Flushing usage events
[0m13:16:11.908057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0977254b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0975757a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0975757a90>]}


============================== 13:16:11.911453 | a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c ==============================
[0m13:16:11.911453 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:16:11.913149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:16:12.265409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09770e5f90>]}
[0m13:16:12.356627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0972495c00>]}
[0m13:16:12.358629 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:16:12.427161 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:16:12.578078 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:16:12.579849 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m13:16:12.580800 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:16:12.582829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09763718d0>]}
[0m13:16:17.420396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:16:17.437235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096a46d1b0>]}
[0m13:16:17.688612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096a22fa30>]}
[0m13:16:17.690412 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:16:17.691937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01a6146-5ed0-4b28-9bb8-d7e5015bdf6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096a22f610>]}
[0m13:16:17.695935 [info ] [MainThread]: 
[0m13:16:17.697728 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:16:17.707207 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:16:17.767500 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:16:17.769547 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:16:17.770794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:17.796995 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:16:17.798792 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:16:17.801474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:17.803625 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:16:17.804545 [info ] [MainThread]: 
[0m13:16:17.805562 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m13:16:17.807008 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:16:17.809120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.990951, "process_user_time": 5.095618, "process_kernel_time": 0.388902, "process_mem_max_rss": "148840", "process_in_blocks": "5136", "command_success": false, "process_out_blocks": "0"}
[0m13:16:17.810486 [debug] [MainThread]: Command `dbt run` failed at 13:16:17.810350 after 5.99 seconds
[0m13:16:17.811429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0977254b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096a22f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f096a24f6d0>]}
[0m13:16:17.812447 [debug] [MainThread]: Flushing usage events
[0m13:16:20.996165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98a300b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff988793e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff988793eb0>]}


============================== 13:16:21.001173 | 65b862c2-e6b5-4557-b74a-11d7604814b3 ==============================
[0m13:16:21.001173 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:16:21.002649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:21.343727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b862c2-e6b5-4557-b74a-11d7604814b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98875b520>]}
[0m13:16:21.443007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65b862c2-e6b5-4557-b74a-11d7604814b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98552f4c0>]}
[0m13:16:21.445411 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:16:21.535956 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:16:23.957757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:23.958716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:23.968311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:16:24.031460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65b862c2-e6b5-4557-b74a-11d7604814b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97d2e0eb0>]}
[0m13:16:24.222656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65b862c2-e6b5-4557-b74a-11d7604814b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97d414340>]}
[0m13:16:24.224244 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:16:24.225537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b862c2-e6b5-4557-b74a-11d7604814b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97d2d0df0>]}
[0m13:16:24.230547 [info ] [MainThread]: 
[0m13:16:24.232948 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:16:24.247971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m13:16:24.373876 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:16:24.375359 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:16:24.376314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:24.384965 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m13:16:24.385804 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:16:24.387196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:24.387926 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:16:24.388751 [info ] [MainThread]: 
[0m13:16:24.389719 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:16:24.391046 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:16:24.392793 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.513203, "process_user_time": 2.879038, "process_kernel_time": 0.32326, "process_mem_max_rss": "143156", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:16:24.393867 [debug] [MainThread]: Command `dbt test` failed at 13:16:24.393749 after 3.51 seconds
[0m13:16:24.394881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98a300b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97d414340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9855402b0>]}
[0m13:16:24.395772 [debug] [MainThread]: Flushing usage events
[0m13:17:04.365600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456765cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4565ae9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4565ae9720>]}


============================== 13:17:04.369119 | 87001eb1-2526-4169-bba0-fb4b1f535f0a ==============================
[0m13:17:04.369119 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:17:04.371868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:17:04.686496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87001eb1-2526-4169-bba0-fb4b1f535f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4567489fc0>]}
[0m13:17:04.777224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87001eb1-2526-4169-bba0-fb4b1f535f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4565d4feb0>]}
[0m13:17:04.778916 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:17:04.863838 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:17:07.244082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:07.245129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:07.254529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:17:07.315630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87001eb1-2526-4169-bba0-fb4b1f535f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f455a6e4f40>]}
[0m13:17:07.496665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87001eb1-2526-4169-bba0-fb4b1f535f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f455a6f4d00>]}
[0m13:17:07.497894 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:17:07.499050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87001eb1-2526-4169-bba0-fb4b1f535f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f455a6e7f10>]}
[0m13:17:07.502432 [info ] [MainThread]: 
[0m13:17:07.504114 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:17:07.517825 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:17:07.670056 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:17:07.671591 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:17:07.673770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:07.682367 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:17:07.683585 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:17:07.685149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:07.685917 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:17:07.686619 [info ] [MainThread]: 
[0m13:17:07.687744 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:17:07.689052 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:17:07.690604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4151, "process_user_time": 2.742843, "process_kernel_time": 0.30696, "process_mem_max_rss": "142028", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:17:07.691660 [debug] [MainThread]: Command `dbt run` failed at 13:17:07.691541 after 3.42 seconds
[0m13:17:07.692489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456765cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f455a9aead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f455a9aca90>]}
[0m13:17:07.693515 [debug] [MainThread]: Flushing usage events
[0m13:17:10.373798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554cc80b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b151720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b1516c0>]}


============================== 13:17:10.378644 | 5804f0ad-a41b-400f-a637-1dc397fa4850 ==============================
[0m13:17:10.378644 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:17:10.379978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:17:10.726926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5804f0ad-a41b-400f-a637-1dc397fa4850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5547ec3d30>]}
[0m13:17:10.829735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5804f0ad-a41b-400f-a637-1dc397fa4850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5547eed990>]}
[0m13:17:10.831402 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:17:10.901336 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:17:13.357815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:13.359286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:13.370453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:17:13.429175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5804f0ad-a41b-400f-a637-1dc397fa4850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553fcd8ee0>]}
[0m13:17:13.638670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5804f0ad-a41b-400f-a637-1dc397fa4850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553fe0c100>]}
[0m13:17:13.640331 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:17:13.641598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5804f0ad-a41b-400f-a637-1dc397fa4850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553fccf2b0>]}
[0m13:17:13.646293 [info ] [MainThread]: 
[0m13:17:13.647915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:17:13.662395 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m13:17:13.866279 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:17:13.867589 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:17:13.868595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:13.882246 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m13:17:13.883954 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:17:13.886170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:13.887342 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:17:13.888741 [info ] [MainThread]: 
[0m13:17:13.890263 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:17:13.894061 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:17:13.896428 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.6261818, "process_user_time": 2.811347, "process_kernel_time": 0.394397, "process_mem_max_rss": "143520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:17:13.897976 [debug] [MainThread]: Command `dbt test` failed at 13:17:13.897763 after 3.63 seconds
[0m13:17:13.899117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554cc80b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553fe0c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5547ed8e20>]}
[0m13:17:13.900193 [debug] [MainThread]: Flushing usage events
[0m13:17:39.517620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c9cdcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c81dba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c81dbaf0>]}


============================== 13:17:39.521257 | da58d5c4-ec74-4845-9c43-6c9ec679fba6 ==============================
[0m13:17:39.521257 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:17:39.522753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:39.836669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da58d5c4-ec74-4845-9c43-6c9ec679fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c81a3520>]}
[0m13:17:39.927880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da58d5c4-ec74-4845-9c43-6c9ec679fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c4f834c0>]}
[0m13:17:39.929900 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:17:40.001020 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:17:42.345032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:42.346077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:42.355423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:17:42.423319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da58d5c4-ec74-4845-9c43-6c9ec679fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bcaf4eb0>]}
[0m13:17:42.605351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da58d5c4-ec74-4845-9c43-6c9ec679fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bccfcd00>]}
[0m13:17:42.607147 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:17:42.608792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da58d5c4-ec74-4845-9c43-6c9ec679fba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bcaf7e50>]}
[0m13:17:42.618243 [info ] [MainThread]: 
[0m13:17:42.622855 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:17:42.632345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:17:42.765472 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:17:42.767766 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:17:42.768561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:42.777460 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:17:42.778253 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:17:42.779703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:42.780745 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:17:42.781541 [info ] [MainThread]: 
[0m13:17:42.782749 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:17:42.784604 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:17:42.786569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3695323, "process_user_time": 2.608503, "process_kernel_time": 0.295302, "process_mem_max_rss": "141860", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:17:42.787798 [debug] [MainThread]: Command `dbt run` failed at 13:17:42.787653 after 3.37 seconds
[0m13:17:42.788726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c9cdcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bcf62800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bcf634f0>]}
[0m13:17:42.789622 [debug] [MainThread]: Flushing usage events
[0m13:20:32.797253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3446dd4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445211690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445211630>]}


============================== 13:20:32.801554 | 31cf6b5b-5c3d-48c8-85a5-15244e10b7ea ==============================
[0m13:20:32.801554 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:20:32.802890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:33.108383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31cf6b5b-5c3d-48c8-85a5-15244e10b7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343a1190f0>]}
[0m13:20:33.204996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31cf6b5b-5c3d-48c8-85a5-15244e10b7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445309810>]}
[0m13:20:33.207017 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:20:33.266717 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:20:35.595545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:35.596599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:35.607393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:20:35.663365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31cf6b5b-5c3d-48c8-85a5-15244e10b7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3439de4e50>]}
[0m13:20:35.844799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31cf6b5b-5c3d-48c8-85a5-15244e10b7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3445309cc0>]}
[0m13:20:35.846148 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:20:35.848515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31cf6b5b-5c3d-48c8-85a5-15244e10b7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3439de7ee0>]}
[0m13:20:35.852700 [info ] [MainThread]: 
[0m13:20:35.854455 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:35.863643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:20:35.998840 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:20:35.999887 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:20:36.000688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:36.008946 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:20:36.009807 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:20:36.011324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:36.012061 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:20:36.012817 [info ] [MainThread]: 
[0m13:20:36.013979 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:20:36.015736 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:20:36.017816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3172255, "process_user_time": 2.529422, "process_kernel_time": 0.239945, "process_mem_max_rss": "142540", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:36.019051 [debug] [MainThread]: Command `dbt run` failed at 13:20:36.018932 after 3.32 seconds
[0m13:20:36.019982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3446dd4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3439dccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343a0acc40>]}
[0m13:20:36.020931 [debug] [MainThread]: Flushing usage events
[0m13:20:38.686291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1acd90b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ab1f5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ab1f56c0>]}


============================== 13:20:38.690238 | 4cc1cd38-3c36-4851-9c6a-fa846c30fbcb ==============================
[0m13:20:38.690238 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:20:38.691537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:20:38.999659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cc1cd38-3c36-4851-9c6a-fa846c30fbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0117d30>]}
[0m13:20:39.096117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cc1cd38-3c36-4851-9c6a-fa846c30fbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0155990>]}
[0m13:20:39.098024 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:20:39.178573 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:20:41.518587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:41.520185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:41.530581 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:20:41.594110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cc1cd38-3c36-4851-9c6a-fa846c30fbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd19fde0ee0>]}
[0m13:20:41.771725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cc1cd38-3c36-4851-9c6a-fa846c30fbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd19ff14100>]}
[0m13:20:41.773099 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:20:41.774461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cc1cd38-3c36-4851-9c6a-fa846c30fbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd19fdd72b0>]}
[0m13:20:41.781388 [info ] [MainThread]: 
[0m13:20:41.783526 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:41.799521 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m13:20:41.925193 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:20:41.926600 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:20:41.927555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:41.936175 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m13:20:41.937015 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:20:41.938726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:41.939438 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:20:41.940290 [info ] [MainThread]: 
[0m13:20:41.941285 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:20:41.942592 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/etl_project/taxis_chicago/dev.duckdb": Conflicting lock is held in /usr/local/bin/python3.10 (PID 3034). However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m13:20:41.944864 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.3519795, "process_user_time": 2.600525, "process_kernel_time": 0.233641, "process_mem_max_rss": "143816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:41.946264 [debug] [MainThread]: Command `dbt test` failed at 13:20:41.946106 after 3.35 seconds
[0m13:20:41.947277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1acd90b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd19ff14070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0188e20>]}
[0m13:20:41.948173 [debug] [MainThread]: Flushing usage events
[0m13:22:27.520807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067ddf0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067c30da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067c30d9c0>]}


============================== 13:22:27.524576 | bb1f6a92-5168-49ed-8341-a7d6e32994de ==============================
[0m13:22:27.524576 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:22:27.527439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:22:27.833671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067c3834f0>]}
[0m13:22:27.933628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06790749a0>]}
[0m13:22:27.935418 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:22:28.009665 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:22:30.333387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:30.334328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:30.345877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:22:30.410339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06708e9270>]}
[0m13:22:30.613777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06708ed1b0>]}
[0m13:22:30.615248 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:22:30.616505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06708efb50>]}
[0m13:22:30.619716 [info ] [MainThread]: 
[0m13:22:30.621211 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:22:30.629226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:22:30.742840 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:22:30.744073 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:22:30.744953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:30.768351 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:22:30.771341 [debug] [ThreadPool]: On list_dev: Close
[0m13:22:30.776662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m13:22:30.777746 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m13:22:30.789585 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:22:30.790685 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m13:22:30.791445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:30.808695 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:22:30.812803 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:22:30.813914 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m13:22:30.815135 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:22:30.815925 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:22:30.816896 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m13:22:30.818830 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:22:30.820732 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m13:22:30.822074 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m13:22:30.823090 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m13:22:30.824762 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:22:30.825630 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m13:22:30.834270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m13:22:30.842752 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:22:30.843660 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:22:30.844450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:30.860291 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:22:30.861337 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:22:30.862228 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m13:22:30.884348 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:22:30.890737 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m13:22:30.891883 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m13:22:30.892797 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m13:22:30.898510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067e37e200>]}
[0m13:22:30.899517 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:30.900314 [debug] [MainThread]: On master: BEGIN
[0m13:22:30.901028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:30.917115 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m13:22:30.918130 [debug] [MainThread]: On master: COMMIT
[0m13:22:30.918915 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:30.919741 [debug] [MainThread]: On master: COMMIT
[0m13:22:30.920793 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:22:30.921676 [debug] [MainThread]: On master: Close
[0m13:22:30.928455 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m13:22:30.929872 [info ] [MainThread]: 
[0m13:22:30.940694 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m13:22:30.941859 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m13:22:30.943271 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m13:22:30.944200 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m13:22:30.958575 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m13:22:30.966704 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m13:22:31.027096 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m13:22:31.034283 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:22:31.035247 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m13:22:31.036411 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:31.056905 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m13:22:31.058288 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:22:31.059139 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m13:22:31.105798 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m13:22:31.117376 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:22:31.118549 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m13:22:31.120839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:31.127582 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:22:31.128540 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m13:22:31.130192 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:31.154407 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m13:22:31.155398 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:22:31.156145 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m13:22:31.175707 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:22:31.184382 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m13:22:31.186029 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m13:22:31.190015 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:22:31.193326 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m13:22:31.234279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dc44d30>]}
[0m13:22:31.236331 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.29s]
[0m13:22:31.237938 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m13:22:31.239344 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m13:22:31.240495 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m13:22:31.241740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m13:22:31.242759 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m13:22:31.247757 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m13:22:31.253847 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m13:22:31.261706 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m13:22:31.268800 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:22:31.269776 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m13:22:31.270668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:31.300010 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:22:31.303016 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:22:31.304260 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m13:22:31.357609 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m13:22:31.362811 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:22:31.363864 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m13:22:31.365367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:31.370725 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:22:31.371542 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:22:31.372707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:31.374702 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m13:22:31.375448 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:22:31.376337 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m13:22:31.381816 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:22:31.387067 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m13:22:31.387940 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m13:22:31.390301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:31.392141 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m13:22:31.444054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0618c2a2c0>]}
[0m13:22:31.445639 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.20s]
[0m13:22:31.447147 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m13:22:31.448370 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m13:22:31.449637 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m13:22:31.451073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m13:22:31.452324 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m13:22:31.458755 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m13:22:31.466809 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m13:22:31.477338 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m13:22:31.485487 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:22:31.486798 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m13:22:31.487825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:31.511521 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:22:31.514173 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:22:31.515611 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m13:22:31.534118 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m13:22:31.541969 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:22:31.543281 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m13:22:31.545052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:31.549568 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:22:31.550649 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m13:22:31.552173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:31.554326 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m13:22:31.555286 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:22:31.556088 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m13:22:31.601053 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m13:22:31.607884 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m13:22:31.609227 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m13:22:31.612801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:22:31.615301 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m13:22:31.651891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066fbdc9a0>]}
[0m13:22:31.653841 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.20s]
[0m13:22:31.655336 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m13:22:31.656553 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m13:22:31.657777 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m13:22:31.659025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m13:22:31.659997 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m13:22:31.666493 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m13:22:31.673960 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m13:22:31.704057 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m13:22:31.715012 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:22:31.716482 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m13:22:31.717648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:31.745567 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m13:22:31.747143 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:22:31.748076 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m13:22:31.999105 [debug] [Thread-1 (]: SQL status: OK in 0.250 seconds
[0m13:22:32.004487 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:22:32.005624 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m13:22:32.008618 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:32.014725 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:22:32.015585 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m13:22:32.016832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:32.018822 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m13:22:32.020003 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:22:32.021433 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m13:22:32.040109 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m13:22:32.046435 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m13:22:32.047556 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m13:22:32.050347 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:32.052483 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m13:22:32.066555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066fbd1600>]}
[0m13:22:32.068168 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.41s]
[0m13:22:32.069669 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m13:22:32.072004 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m13:22:32.073296 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m13:22:32.075931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m13:22:32.077254 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m13:22:32.083398 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.093745 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m13:22:32.101699 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.109999 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.111557 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m13:22:32.112950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:32.136745 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:22:32.138690 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.139875 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m13:22:32.408731 [debug] [Thread-1 (]: SQL status: OK in 0.268 seconds
[0m13:22:32.414028 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.415575 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m13:22:32.417160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:32.422235 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.423326 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m13:22:32.424641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:32.426884 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m13:22:32.427765 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.428584 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m13:22:32.433418 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:22:32.439255 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m13:22:32.440252 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m13:22:32.442984 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:32.445357 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m13:22:32.463779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0618cc81f0>]}
[0m13:22:32.465148 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.39s]
[0m13:22:32.466600 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m13:22:32.468396 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m13:22:32.469634 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m13:22:32.471111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m13:22:32.472261 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m13:22:32.480881 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.488211 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m13:22:32.494867 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.503117 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.504331 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m13:22:32.505359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:32.532440 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m13:22:32.534180 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.535342 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m13:22:32.797271 [debug] [Thread-1 (]: SQL status: OK in 0.261 seconds
[0m13:22:32.805771 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.807584 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m13:22:32.810636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:32.816898 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.818234 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m13:22:32.819481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:32.821688 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m13:22:32.822598 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.823364 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m13:22:32.837974 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:22:32.845052 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m13:22:32.846606 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m13:22:32.849321 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:32.851461 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m13:22:32.871508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067045b190>]}
[0m13:22:32.872908 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.40s]
[0m13:22:32.874367 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m13:22:32.876130 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m13:22:32.877346 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m13:22:32.878639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m13:22:32.879518 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m13:22:32.884538 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:32.892129 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m13:22:32.900284 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:32.908815 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:32.910004 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m13:22:32.911149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:32.937123 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m13:22:32.939142 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:32.940650 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m13:22:33.208546 [debug] [Thread-1 (]: SQL status: OK in 0.266 seconds
[0m13:22:33.213766 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:33.215087 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m13:22:33.216447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:33.220817 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:33.221738 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m13:22:33.223136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:33.225079 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m13:22:33.225904 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:33.226850 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m13:22:33.231678 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:22:33.238033 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m13:22:33.238925 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m13:22:33.241450 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:33.243475 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m13:22:33.258985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067045b190>]}
[0m13:22:33.260372 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.38s]
[0m13:22:33.261815 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m13:22:33.263539 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m13:22:33.264670 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m13:22:33.265849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m13:22:33.266802 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m13:22:33.272749 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.281889 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m13:22:33.289900 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.298691 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.299712 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m13:22:33.300526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:33.325099 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:22:33.326734 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.327878 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m13:22:33.595662 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m13:22:33.600977 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.602068 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m13:22:33.603432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:33.609627 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.610669 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m13:22:33.612131 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:33.614034 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m13:22:33.614943 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.615914 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m13:22:33.619870 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:22:33.625195 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m13:22:33.626022 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m13:22:33.628508 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:33.630378 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m13:22:33.649358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0670488250>]}
[0m13:22:33.651577 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.38s]
[0m13:22:33.653318 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m13:22:33.655519 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m13:22:33.657221 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m13:22:33.658592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m13:22:33.659665 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m13:22:33.667117 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m13:22:33.675745 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m13:22:33.683899 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m13:22:33.693087 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:22:33.694386 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m13:22:33.695669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:33.718796 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m13:22:33.720421 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:22:33.721602 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m13:22:34.672785 [debug] [Thread-1 (]: SQL status: OK in 0.950 seconds
[0m13:22:34.679486 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:22:34.680816 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m13:22:34.682335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:34.687873 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:22:34.688823 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m13:22:34.690286 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:34.692310 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m13:22:34.693140 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:22:34.694000 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m13:22:34.753506 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m13:22:34.761460 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m13:22:34.763281 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m13:22:34.767158 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:22:34.769715 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m13:22:34.839766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb1f6a92-5168-49ed-8341-a7d6e32994de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f061b21fd30>]}
[0m13:22:34.841414 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.18s]
[0m13:22:34.843101 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m13:22:34.845626 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:34.846630 [debug] [MainThread]: On master: BEGIN
[0m13:22:34.847420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:34.869405 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m13:22:34.871491 [debug] [MainThread]: On master: COMMIT
[0m13:22:34.873005 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:34.874197 [debug] [MainThread]: On master: COMMIT
[0m13:22:34.876380 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:22:34.878567 [debug] [MainThread]: On master: Close
[0m13:22:34.887010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:34.888479 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:22:34.889423 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m13:22:34.890763 [info ] [MainThread]: 
[0m13:22:34.892963 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m13:22:34.896631 [debug] [MainThread]: Command end result
[0m13:22:35.098399 [info ] [MainThread]: 
[0m13:22:35.099537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:35.100857 [info ] [MainThread]: 
[0m13:22:35.102125 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:22:35.104305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6795387, "process_user_time": 4.575766, "process_kernel_time": 0.727736, "process_mem_max_rss": "237668", "process_in_blocks": "1616", "process_out_blocks": "840"}
[0m13:22:35.105610 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:35.105433 after 7.68 seconds
[0m13:22:35.107006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067ddf0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06708d7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dbd0ca0>]}
[0m13:22:35.108268 [debug] [MainThread]: Flushing usage events
[0m13:22:37.829752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12e530b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12c9ed6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12c9ed660>]}


============================== 13:22:37.833062 | 12a5aa2b-53e7-41bc-8c5f-0a64f32c9220 ==============================
[0m13:22:37.833062 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:22:37.834499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:38.150015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12a5aa2b-53e7-41bc-8c5f-0a64f32c9220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12e3cdf30>]}
[0m13:22:38.243889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12a5aa2b-53e7-41bc-8c5f-0a64f32c9220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12cac3a90>]}
[0m13:22:38.245598 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:22:38.320588 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m13:22:40.709563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:40.710507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:40.719486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:22:40.775631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12a5aa2b-53e7-41bc-8c5f-0a64f32c9220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1213f4e80>]}
[0m13:22:40.965660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12a5aa2b-53e7-41bc-8c5f-0a64f32c9220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1218bfe80>]}
[0m13:22:40.966801 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:22:40.971355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a5aa2b-53e7-41bc-8c5f-0a64f32c9220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1215e0d00>]}
[0m13:22:40.974788 [info ] [MainThread]: 
[0m13:22:40.977319 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:22:40.987953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m13:22:41.105954 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:22:41.107790 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m13:22:41.108673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:41.132964 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:22:41.134253 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m13:22:41.135003 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m13:22:41.156873 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:22:41.165048 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m13:22:41.167103 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m13:22:41.167977 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m13:22:41.175728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a5aa2b-53e7-41bc-8c5f-0a64f32c9220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1215b5d80>]}
[0m13:22:41.177157 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:41.178043 [debug] [MainThread]: On master: BEGIN
[0m13:22:41.178790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:41.195478 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m13:22:41.196566 [debug] [MainThread]: On master: COMMIT
[0m13:22:41.197360 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:41.198118 [debug] [MainThread]: On master: COMMIT
[0m13:22:41.199113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:22:41.199820 [debug] [MainThread]: On master: Close
[0m13:22:41.203322 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m13:22:41.204562 [info ] [MainThread]: 
[0m13:22:41.211455 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:22:41.212834 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m13:22:41.214450 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m13:22:41.215591 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:22:41.258315 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:22:41.267124 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:22:41.297788 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:22:41.311411 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:22:41.312833 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m13:22:41.313736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:41.335958 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m13:22:41.337522 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m13:22:41.338429 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m13:22:41.340677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:41.348626 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m13:22:41.349741 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m13:22:41.350755 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m13:22:41.355028 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.14s]
[0m13:22:41.357220 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m13:22:41.358551 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:22:41.359625 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m13:22:41.361291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m13:22:41.362367 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:22:41.371393 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:22:41.381155 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:22:41.388237 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:22:41.398022 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:22:41.399240 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m13:22:41.400137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:41.422738 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m13:22:41.424911 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m13:22:41.426962 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m13:22:41.430352 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:41.433682 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m13:22:41.434827 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m13:22:41.435707 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m13:22:41.445622 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m13:22:41.448458 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m13:22:41.450180 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:22:41.451497 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m13:22:41.454134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m13:22:41.460005 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:22:41.478583 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:22:41.488730 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:22:41.497889 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:22:41.507878 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:22:41.509376 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m13:22:41.510386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:41.535411 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:22:41.537748 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m13:22:41.539384 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m13:22:41.542341 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:41.545706 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m13:22:41.547191 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m13:22:41.548101 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m13:22:41.555113 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m13:22:41.557052 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m13:22:41.558189 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:22:41.559177 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m13:22:41.560597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m13:22:41.561503 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:22:41.568683 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:22:41.578091 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:22:41.585121 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:22:41.595046 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:22:41.597038 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m13:22:41.597877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:41.623535 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m13:22:41.626018 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m13:22:41.627397 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m13:22:41.629994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:22:41.633664 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m13:22:41.634917 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m13:22:41.635854 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m13:22:41.640627 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.08s]
[0m13:22:41.642552 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m13:22:41.643703 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:22:41.644679 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m13:22:41.646120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m13:22:41.647167 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:22:41.659656 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:22:41.667285 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:22:41.672071 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:22:41.681765 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:22:41.682962 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m13:22:41.683846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:41.708438 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m13:22:41.710131 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m13:22:41.711233 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:22:41.743291 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m13:22:41.747779 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m13:22:41.749087 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m13:22:41.750101 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m13:22:41.757449 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.11s]
[0m13:22:41.759807 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m13:22:41.762946 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:41.763949 [debug] [MainThread]: On master: BEGIN
[0m13:22:41.764773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:41.789721 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m13:22:41.791655 [debug] [MainThread]: On master: COMMIT
[0m13:22:41.792714 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:41.793605 [debug] [MainThread]: On master: COMMIT
[0m13:22:41.794952 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:22:41.795926 [debug] [MainThread]: On master: Close
[0m13:22:41.802159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:41.803362 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m13:22:41.804572 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m13:22:41.806627 [info ] [MainThread]: 
[0m13:22:41.808515 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m13:22:41.811474 [debug] [MainThread]: Command end result
[0m13:22:41.921917 [info ] [MainThread]: 
[0m13:22:41.923674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:41.924985 [info ] [MainThread]: 
[0m13:22:41.926117 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:22:41.928323 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.191339, "process_user_time": 3.059053, "process_kernel_time": 0.364655, "process_mem_max_rss": "190780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:22:41.929637 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:41.929494 after 4.19 seconds
[0m13:22:41.930696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12e530b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12dd91cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1218bffa0>]}
[0m13:22:41.931709 [debug] [MainThread]: Flushing usage events
[0m13:22:44.625775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279ad40af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27991c55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27991c5570>]}


============================== 13:22:44.629180 | c5213746-d73d-491f-8d3e-4dda1d0b3e55 ==============================
[0m13:22:44.629180 [info ] [MainThread]: Running with dbt=1.8.4
[0m13:22:44.630831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/etl_project/taxis_chicago/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:44.950852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5213746-d73d-491f-8d3e-4dda1d0b3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2795f0c0d0>]}
[0m13:22:45.040136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5213746-d73d-491f-8d3e-4dda1d0b3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27993b9990>]}
[0m13:22:45.041973 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m13:22:45.128184 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m13:22:45.275355 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:22:45.277321 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m13:22:45.278345 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:22:45.279913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5213746-d73d-491f-8d3e-4dda1d0b3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2799df1720>]}
[0m13:22:49.932363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m13:22:49.946267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5213746-d73d-491f-8d3e-4dda1d0b3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278de54730>]}
[0m13:22:50.148746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5213746-d73d-491f-8d3e-4dda1d0b3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278dc06560>]}
[0m13:22:50.150245 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m13:22:50.151977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5213746-d73d-491f-8d3e-4dda1d0b3e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278dc13a90>]}
[0m13:22:50.154115 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m13:22:50.155401 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:22:50.156528 [debug] [MainThread]: On macro_publish: BEGIN
[0m13:22:50.157443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:50.180060 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m13:22:50.181654 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:22:50.182515 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:22:50.183392 [debug] [MainThread]: On macro_publish: COMMIT
[0m13:22:50.184864 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:22:50.195876 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m13:22:50.250657 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:22:50.252062 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m13:22:50.255155 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:22:50.258973 [info ] [MainThread]: Schema dbt_green created or already exists
[0m13:22:50.260239 [info ] [MainThread]: Merging into green environment...
[0m13:22:50.261969 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m13:22:50.262872 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m13:22:50.505789 [debug] [MainThread]: SQL status: OK in 0.242 seconds
[0m13:22:50.509548 [info ] [MainThread]: Merge into green environment done
[0m13:22:50.511027 [debug] [MainThread]: On macro_publish: Close
[0m13:22:50.655252 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.1210237, "process_user_time": 5.187431, "process_kernel_time": 0.222897, "process_mem_max_rss": "219200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:22:50.656733 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:22:50.656572 after 6.12 seconds
[0m13:22:50.657630 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m13:22:50.658460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f279ad40af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278dc2e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278dc2cb50>]}
[0m13:22:50.659291 [debug] [MainThread]: Flushing usage events
[0m14:08:34.133372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9429cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b927d1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b927d19c0>]}


============================== 14:08:34.138395 | 035f2e43-2d3b-4710-8a1a-9fd460178d10 ==============================
[0m14:08:34.138395 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:08:34.139983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:34.590186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9283bc70>]}
[0m14:08:34.691367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8f5249a0>]}
[0m14:08:34.693391 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:08:34.762126 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m14:08:34.904102 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:08:34.905536 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m14:08:34.906436 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:08:34.907447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b933d49a0>]}
[0m14:08:39.225510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:08:39.235213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b872e2710>]}
[0m14:08:39.451990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8f574cd0>]}
[0m14:08:39.453117 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:08:39.455812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8f574220>]}
[0m14:08:39.459748 [info ] [MainThread]: 
[0m14:08:39.461533 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:39.485830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:08:39.556193 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:08:39.557294 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:08:39.558136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:39.588145 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m14:08:39.591615 [debug] [ThreadPool]: On list_dev: Close
[0m14:08:39.599537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m14:08:39.600590 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m14:08:39.613731 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:08:39.614969 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m14:08:39.615889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:39.633192 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:08:39.635331 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:08:39.636040 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m14:08:39.637830 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:39.639024 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:08:39.639859 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m14:08:39.643362 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:08:39.645396 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m14:08:39.646273 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:08:39.647244 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m14:08:39.649063 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:39.649943 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m14:08:39.661018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m14:08:39.672740 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:08:39.673707 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m14:08:39.674490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:39.692276 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:08:39.693572 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:08:39.694464 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m14:08:39.717771 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:08:39.727746 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m14:08:39.730547 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m14:08:39.731380 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m14:08:39.740738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b84fbf070>]}
[0m14:08:39.742348 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:39.743235 [debug] [MainThread]: On master: BEGIN
[0m14:08:39.743999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:39.764719 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m14:08:39.766061 [debug] [MainThread]: On master: COMMIT
[0m14:08:39.766931 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:39.767731 [debug] [MainThread]: On master: COMMIT
[0m14:08:39.768956 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:39.769735 [debug] [MainThread]: On master: Close
[0m14:08:39.774093 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m14:08:39.775458 [info ] [MainThread]: 
[0m14:08:39.784502 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m14:08:39.785683 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m14:08:39.787221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m14:08:39.788296 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m14:08:39.803838 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m14:08:39.815190 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m14:08:39.874659 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m14:08:39.882426 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:08:39.883417 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m14:08:39.884250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:39.905599 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:08:39.907222 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:08:39.908198 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m14:08:39.963186 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:08:39.976865 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:08:39.978390 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m14:08:39.980495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:39.986857 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:08:39.988466 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m14:08:39.990984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:40.025589 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m14:08:40.027057 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:08:40.028121 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m14:08:40.054688 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:08:40.065558 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:08:40.066925 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m14:08:40.072814 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:08:40.077444 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m14:08:40.125642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b84d16230>]}
[0m14:08:40.128041 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.34s]
[0m14:08:40.130239 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m14:08:40.131568 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m14:08:40.133443 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m14:08:40.134968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m14:08:40.136060 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m14:08:40.148774 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m14:08:40.159761 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m14:08:40.168741 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m14:08:40.179926 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:08:40.181362 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m14:08:40.182449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:40.206174 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:08:40.209727 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:08:40.211027 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m14:08:40.264378 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m14:08:40.270904 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:08:40.272329 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m14:08:40.274002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:40.280460 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:08:40.281371 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:08:40.282730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:40.284793 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m14:08:40.285729 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:08:40.286897 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m14:08:40.294133 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:08:40.300468 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:08:40.301529 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m14:08:40.305283 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:40.308279 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m14:08:40.367233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8f56ff40>]}
[0m14:08:40.369808 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.23s]
[0m14:08:40.372821 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m14:08:40.374269 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m14:08:40.375607 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m14:08:40.376863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m14:08:40.377800 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m14:08:40.385115 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m14:08:40.394098 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m14:08:40.403428 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m14:08:40.413987 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:08:40.415372 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m14:08:40.416593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:40.440697 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:08:40.443663 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:08:40.444957 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m14:08:40.463958 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m14:08:40.471695 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:08:40.474810 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m14:08:40.477500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:40.486208 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:08:40.488071 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m14:08:40.491486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:40.494806 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m14:08:40.495863 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:08:40.496674 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m14:08:40.550639 [debug] [Thread-1 (]: SQL status: OK in 0.053 seconds
[0m14:08:40.557683 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:08:40.559015 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m14:08:40.562671 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:40.565281 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m14:08:40.599822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8f56ff40>]}
[0m14:08:40.601330 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.22s]
[0m14:08:40.602768 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m14:08:40.603944 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m14:08:40.605313 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m14:08:40.606871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m14:08:40.608133 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m14:08:40.617737 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.629681 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m14:08:40.660400 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.669006 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.670166 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m14:08:40.671150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:40.694946 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:08:40.696993 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.698295 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m14:08:40.962637 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m14:08:40.972743 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.973766 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m14:08:40.975629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:40.981430 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.982433 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m14:08:40.983810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:08:40.986213 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m14:08:40.987367 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.988246 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m14:08:40.992842 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:40.997060 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:08:40.997988 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m14:08:41.000476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:41.002685 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m14:08:41.027063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b84deb2e0>]}
[0m14:08:41.029446 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.42s]
[0m14:08:41.032256 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m14:08:41.034953 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m14:08:41.036357 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m14:08:41.038805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m14:08:41.039993 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m14:08:41.053023 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.065733 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m14:08:41.074697 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.083531 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.084721 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m14:08:41.085579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:41.110351 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:08:41.112121 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.113322 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m14:08:41.384656 [debug] [Thread-1 (]: SQL status: OK in 0.270 seconds
[0m14:08:41.391499 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.393055 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m14:08:41.395276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:41.401847 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.402892 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m14:08:41.404448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:08:41.406651 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m14:08:41.407584 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.408452 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m14:08:41.423296 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m14:08:41.428036 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:08:41.429233 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m14:08:41.432024 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:41.434066 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m14:08:41.457832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8517ebf0>]}
[0m14:08:41.460271 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.42s]
[0m14:08:41.462571 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m14:08:41.465389 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m14:08:41.466769 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m14:08:41.468173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m14:08:41.469249 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m14:08:41.478374 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.486505 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m14:08:41.497441 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.514399 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.515760 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m14:08:41.521718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:41.548266 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:08:41.550003 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.551023 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m14:08:41.814603 [debug] [Thread-1 (]: SQL status: OK in 0.262 seconds
[0m14:08:41.825328 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.826879 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m14:08:41.828986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:41.835555 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.836619 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m14:08:41.838631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:41.841438 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m14:08:41.842403 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.843233 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m14:08:41.859287 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:08:41.867201 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:08:41.868389 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m14:08:41.872468 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:41.875308 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m14:08:41.895337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8517ebf0>]}
[0m14:08:41.896823 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.43s]
[0m14:08:41.898274 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m14:08:41.900204 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m14:08:41.901394 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m14:08:41.902812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m14:08:41.903847 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m14:08:41.913578 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:41.925786 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m14:08:41.935940 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:41.946471 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:41.948308 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m14:08:41.949162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:41.973321 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:08:41.976062 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:41.977460 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m14:08:42.241366 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m14:08:42.249032 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:42.249894 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m14:08:42.251241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:08:42.258135 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:42.259518 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m14:08:42.261623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:42.263932 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m14:08:42.264759 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:42.265588 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m14:08:42.272646 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:08:42.278086 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:08:42.279174 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m14:08:42.282908 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:42.285731 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m14:08:42.306726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b87214640>]}
[0m14:08:42.309172 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.40s]
[0m14:08:42.311017 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m14:08:42.313667 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m14:08:42.314952 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m14:08:42.316485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m14:08:42.317494 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m14:08:42.332213 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.342640 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m14:08:42.350536 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.361322 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.362802 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m14:08:42.363784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:42.390135 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:08:42.392329 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.393432 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m14:08:42.656898 [debug] [Thread-1 (]: SQL status: OK in 0.262 seconds
[0m14:08:42.664644 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.665899 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m14:08:42.667218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:08:42.672666 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.673687 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m14:08:42.675418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:42.677677 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m14:08:42.678554 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.679397 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m14:08:42.695570 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:08:42.701452 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:08:42.702870 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m14:08:42.706065 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:42.708258 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m14:08:42.724611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b87214970>]}
[0m14:08:42.726901 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.41s]
[0m14:08:42.728829 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m14:08:42.731148 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m14:08:42.732475 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m14:08:42.733956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m14:08:42.734858 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m14:08:42.855837 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m14:08:42.863430 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m14:08:42.870817 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m14:08:42.878104 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:08:42.879009 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m14:08:42.879837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:42.895770 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:08:42.896774 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:08:42.897715 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m14:08:43.866825 [debug] [Thread-1 (]: SQL status: OK in 0.968 seconds
[0m14:08:43.875483 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:08:43.876874 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m14:08:43.878862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:43.884946 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:08:43.886015 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m14:08:43.887762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:43.890336 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m14:08:43.891195 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:08:43.892105 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m14:08:43.958273 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m14:08:43.965074 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:08:43.966544 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m14:08:43.969929 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:43.972441 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m14:08:44.054323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035f2e43-2d3b-4710-8a1a-9fd460178d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b872a42b0>]}
[0m14:08:44.056703 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.32s]
[0m14:08:44.059021 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m14:08:44.062532 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:44.063675 [debug] [MainThread]: On master: BEGIN
[0m14:08:44.064490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:44.087713 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m14:08:44.089483 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.090855 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:44.092126 [debug] [MainThread]: On master: COMMIT
[0m14:08:44.093645 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:44.094685 [debug] [MainThread]: On master: Close
[0m14:08:44.102712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:44.104230 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m14:08:44.105192 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m14:08:44.106592 [info ] [MainThread]: 
[0m14:08:44.108700 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m14:08:44.113027 [debug] [MainThread]: Command end result
[0m14:08:44.230715 [info ] [MainThread]: 
[0m14:08:44.232210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:44.233416 [info ] [MainThread]: 
[0m14:08:44.234680 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:08:44.238160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.198991, "process_user_time": 7.417288, "process_kernel_time": 0.786682, "process_mem_max_rss": "236832", "process_in_blocks": "104600", "process_out_blocks": "840"}
[0m14:08:44.239526 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:44.239386 after 10.20 seconds
[0m14:08:44.240543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9283bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b87527d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b87526ad0>]}
[0m14:08:44.241584 [debug] [MainThread]: Flushing usage events
[0m14:08:47.317096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5285cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a50c8d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a50c8d6c0>]}


============================== 14:08:47.322809 | 7a1308b4-e778-4fb0-a14c-8209b1d5d9c6 ==============================
[0m14:08:47.322809 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:08:47.325521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:47.645583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a1308b4-e778-4fb0-a14c-8209b1d5d9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5267df90>]}
[0m14:08:47.743501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a1308b4-e778-4fb0-a14c-8209b1d5d9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a50d85a80>]}
[0m14:08:47.745282 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:08:47.820697 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m14:08:50.179113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:50.180807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:50.191977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:08:50.252749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a1308b4-e778-4fb0-a14c-8209b1d5d9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a457e0ee0>]}
[0m14:08:50.471379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a1308b4-e778-4fb0-a14c-8209b1d5d9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a45792350>]}
[0m14:08:50.472773 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:08:50.474084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a1308b4-e778-4fb0-a14c-8209b1d5d9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a457d63e0>]}
[0m14:08:50.479073 [info ] [MainThread]: 
[0m14:08:50.480917 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:50.496263 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m14:08:50.629475 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:08:50.630800 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m14:08:50.631802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:50.655202 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:08:50.656836 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:08:50.657812 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m14:08:50.678882 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m14:08:50.686046 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m14:08:50.687554 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m14:08:50.688443 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m14:08:50.699479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a1308b4-e778-4fb0-a14c-8209b1d5d9c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a457ec460>]}
[0m14:08:50.700688 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:50.701511 [debug] [MainThread]: On master: BEGIN
[0m14:08:50.702469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:50.719449 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m14:08:50.721155 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.722327 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:50.723168 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.724463 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:50.725247 [debug] [MainThread]: On master: Close
[0m14:08:50.731649 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m14:08:50.733554 [info ] [MainThread]: 
[0m14:08:50.740225 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:08:50.742041 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m14:08:50.743845 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m14:08:50.745047 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:08:50.792455 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:08:50.801311 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:08:50.833324 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:08:50.843452 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:08:50.844674 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m14:08:50.845474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:50.868607 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:08:50.870485 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:08:50.871616 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:08:50.874771 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:50.882397 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m14:08:50.884694 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m14:08:50.885918 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m14:08:50.891819 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.15s]
[0m14:08:50.893760 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:08:50.895068 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:08:50.896182 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m14:08:50.897461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m14:08:50.898518 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:08:50.908178 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:08:50.917109 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:08:50.924270 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:08:50.933243 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:08:50.934284 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m14:08:50.935073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:50.961536 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:08:50.963321 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:08:50.964367 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:08:50.966623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:50.970305 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m14:08:50.972288 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m14:08:50.973695 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m14:08:50.980521 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.08s]
[0m14:08:50.982287 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:08:50.983625 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:08:50.984673 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m14:08:50.986655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m14:08:50.988204 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:08:51.003395 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:08:51.014468 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:08:51.023761 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:08:51.032577 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:08:51.033821 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m14:08:51.035103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:51.058040 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m14:08:51.059735 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:08:51.060779 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m14:08:51.062892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:51.066132 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m14:08:51.067344 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m14:08:51.068212 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m14:08:51.075609 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m14:08:51.077218 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:08:51.078469 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:08:51.079420 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m14:08:51.080718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m14:08:51.081774 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:08:51.091708 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:08:51.100333 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:08:51.106524 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:08:51.115974 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:08:51.117181 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m14:08:51.118282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:51.146596 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m14:08:51.148305 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:08:51.149445 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m14:08:51.151685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:51.157362 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m14:08:51.159022 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m14:08:51.160040 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m14:08:51.167924 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m14:08:51.170974 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:08:51.172571 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:08:51.173725 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m14:08:51.175298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m14:08:51.176512 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:08:51.189584 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:08:51.199582 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:08:51.207265 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:08:51.217898 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:08:51.219718 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m14:08:51.221263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:51.246514 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:08:51.248137 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:08:51.249375 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:08:51.287213 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m14:08:51.293273 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m14:08:51.294849 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m14:08:51.295933 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m14:08:51.305686 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.13s]
[0m14:08:51.307782 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:08:51.310732 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:51.311683 [debug] [MainThread]: On master: BEGIN
[0m14:08:51.312526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:51.335486 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m14:08:51.337476 [debug] [MainThread]: On master: COMMIT
[0m14:08:51.339034 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:51.340542 [debug] [MainThread]: On master: COMMIT
[0m14:08:51.342184 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:51.343197 [debug] [MainThread]: On master: Close
[0m14:08:51.349731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:51.350687 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m14:08:51.351700 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m14:08:51.353356 [info ] [MainThread]: 
[0m14:08:51.354789 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m14:08:51.357956 [debug] [MainThread]: Command end result
[0m14:08:51.471347 [info ] [MainThread]: 
[0m14:08:51.472953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:51.474408 [info ] [MainThread]: 
[0m14:08:51.475603 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:08:51.477582 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.2598257, "process_user_time": 3.250841, "process_kernel_time": 0.354453, "process_mem_max_rss": "195048", "process_in_blocks": "1848", "process_out_blocks": "0"}
[0m14:08:51.478810 [debug] [MainThread]: Command `dbt test` succeeded at 14:08:51.478673 after 4.26 seconds
[0m14:08:51.479737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5285cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a518e4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a457921d0>]}
[0m14:08:51.480657 [debug] [MainThread]: Flushing usage events
[0m14:08:54.217141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48274c8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48259655d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4825965570>]}


============================== 14:08:54.221735 | f5b0705e-0403-42a3-9d5c-7b721935fba9 ==============================
[0m14:08:54.221735 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:08:54.223141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:54.563922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b0705e-0403-42a3-9d5c-7b721935fba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48226f66e0>]}
[0m14:08:54.658612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5b0705e-0403-42a3-9d5c-7b721935fba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4825c0fd60>]}
[0m14:08:54.660801 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:08:54.734306 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m14:08:54.880763 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:08:54.882388 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m14:08:54.883418 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:08:54.884962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5b0705e-0403-42a3-9d5c-7b721935fba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48265b88b0>]}
[0m14:08:59.640053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:08:59.657810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b0705e-0403-42a3-9d5c-7b721935fba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481a4ec7c0>]}
[0m14:08:59.841031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b0705e-0403-42a3-9d5c-7b721935fba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481a408130>]}
[0m14:08:59.842395 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:08:59.843604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b0705e-0403-42a3-9d5c-7b721935fba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481a4a2c80>]}
[0m14:08:59.844979 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m14:08:59.845792 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:08:59.846550 [debug] [MainThread]: On macro_publish: BEGIN
[0m14:08:59.847269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:59.868292 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m14:08:59.870667 [debug] [MainThread]: On macro_publish: COMMIT
[0m14:08:59.871696 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:08:59.872553 [debug] [MainThread]: On macro_publish: COMMIT
[0m14:08:59.874604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:08:59.888257 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m14:08:59.939503 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:08:59.940890 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m14:08:59.943609 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:08:59.945911 [info ] [MainThread]: Schema dbt_green created or already exists
[0m14:08:59.947036 [info ] [MainThread]: Merging into green environment...
[0m14:08:59.949275 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:08:59.956431 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m14:09:00.190288 [debug] [MainThread]: SQL status: OK in 0.232 seconds
[0m14:09:00.192421 [info ] [MainThread]: Merge into green environment done
[0m14:09:00.193622 [debug] [MainThread]: On macro_publish: Close
[0m14:09:00.343945 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.226063, "process_user_time": 5.272532, "process_kernel_time": 0.2918, "process_mem_max_rss": "215936", "process_in_blocks": "64", "process_out_blocks": "0"}
[0m14:09:00.345480 [debug] [MainThread]: Command `dbt run-operation` succeeded at 14:09:00.345349 after 6.23 seconds
[0m14:09:00.346378 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m14:09:00.347272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48274c8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481a4167a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481a4173a0>]}
[0m14:09:00.348161 [debug] [MainThread]: Flushing usage events
[0m14:10:10.149362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6c9ecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6aef9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6aef9630>]}


============================== 14:10:10.154893 | 8558943f-e623-43a7-aeee-726171457f2e ==============================
[0m14:10:10.154893 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:10:10.157194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:10.475961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67c450f0>]}
[0m14:10:10.574445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67c19810>]}
[0m14:10:10.576264 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:10:10.666545 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m14:10:10.818283 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:10:10.820080 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m14:10:10.821293 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:10:10.822414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6bb0da20>]}
[0m14:10:15.666458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:10:15.686641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5fc7d900>]}
[0m14:10:15.884520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5fa2cfa0>]}
[0m14:10:15.885811 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:10:15.887154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6c7dec80>]}
[0m14:10:15.891252 [info ] [MainThread]: 
[0m14:10:15.892859 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:15.903035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:10:15.969230 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:10:15.971140 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:10:15.972540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:15.998334 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:10:16.001500 [debug] [ThreadPool]: On list_dev: Close
[0m14:10:16.010685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m14:10:16.012573 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m14:10:16.027153 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:10:16.028437 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m14:10:16.029557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:16.048882 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:10:16.051842 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:10:16.053053 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m14:10:16.054833 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:10:16.055898 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:10:16.056755 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m14:10:16.058860 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:10:16.060867 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m14:10:16.061670 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:10:16.062487 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m14:10:16.063624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:10:16.064446 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m14:10:16.071659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m14:10:16.083238 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:10:16.085074 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m14:10:16.086059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:16.103375 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:10:16.104586 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:10:16.105603 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m14:10:16.130095 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:10:16.138605 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m14:10:16.139889 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m14:10:16.140640 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m14:10:16.150949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5fa80e80>]}
[0m14:10:16.152318 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:16.153198 [debug] [MainThread]: On master: BEGIN
[0m14:10:16.154017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:16.176116 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m14:10:16.177745 [debug] [MainThread]: On master: COMMIT
[0m14:10:16.178929 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:16.179713 [debug] [MainThread]: On master: COMMIT
[0m14:10:16.180967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:10:16.181828 [debug] [MainThread]: On master: Close
[0m14:10:16.190302 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m14:10:16.192460 [info ] [MainThread]: 
[0m14:10:16.198988 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m14:10:16.200668 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m14:10:16.203638 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m14:10:16.206424 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m14:10:16.223835 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m14:10:16.233391 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m14:10:16.299748 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m14:10:16.308179 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:10:16.309369 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m14:10:16.310268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:16.332271 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m14:10:16.333978 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:10:16.335762 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m14:10:16.389812 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m14:10:16.405153 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:10:16.407034 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m14:10:16.409440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:16.416559 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:10:16.419071 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m14:10:16.422345 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:16.449587 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m14:10:16.451750 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:10:16.453735 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m14:10:16.488394 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m14:10:16.500282 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:10:16.501811 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m14:10:16.505618 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:10:16.510407 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m14:10:16.560340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5d629f00>]}
[0m14:10:16.562301 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.36s]
[0m14:10:16.564128 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m14:10:16.565536 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m14:10:16.567093 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m14:10:16.569406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m14:10:16.570310 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m14:10:16.576789 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m14:10:16.584009 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m14:10:16.594434 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m14:10:16.604563 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:10:16.606783 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m14:10:16.610882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.635933 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:10:16.638159 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:10:16.639434 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m14:10:16.700324 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m14:10:16.708149 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:10:16.709391 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m14:10:16.711270 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:16.719426 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:10:16.720956 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:10:16.723290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:16.726215 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m14:10:16.727311 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:10:16.728263 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m14:10:16.736813 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:10:16.742511 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:10:16.743615 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m14:10:16.746612 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:16.748760 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m14:10:16.798801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6bb0d270>]}
[0m14:10:16.800335 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.23s]
[0m14:10:16.802171 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m14:10:16.803559 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m14:10:16.804934 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m14:10:16.806473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m14:10:16.807615 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m14:10:16.814671 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m14:10:16.826035 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m14:10:16.837712 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m14:10:16.845591 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:10:16.846830 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m14:10:16.848345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.871458 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:10:16.873113 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:10:16.874417 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m14:10:16.893977 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m14:10:16.903486 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:10:16.904813 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m14:10:16.907063 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:16.914696 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:10:16.915981 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m14:10:16.919068 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:16.922123 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m14:10:16.923411 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:10:16.924590 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m14:10:16.979510 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m14:10:16.987392 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:10:16.989142 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m14:10:16.993129 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:10:16.995947 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m14:10:17.041109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5d52c430>]}
[0m14:10:17.043299 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.23s]
[0m14:10:17.045644 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m14:10:17.047342 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m14:10:17.049187 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m14:10:17.050710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m14:10:17.052290 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m14:10:17.060130 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.068118 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m14:10:17.106383 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.115493 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.116852 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m14:10:17.118536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:17.142709 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:10:17.144461 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.145960 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m14:10:17.447325 [debug] [Thread-1 (]: SQL status: OK in 0.300 seconds
[0m14:10:17.453255 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.454218 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m14:10:17.455980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:17.462126 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.463214 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m14:10:17.464775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:10:17.466752 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m14:10:17.467626 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.468878 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m14:10:17.473952 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:10:17.480164 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:10:17.481412 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m14:10:17.484383 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:17.486536 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m14:10:17.501463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67c9f910>]}
[0m14:10:17.503217 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.45s]
[0m14:10:17.505492 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m14:10:17.508261 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m14:10:17.509676 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m14:10:17.511207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m14:10:17.512385 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m14:10:17.525420 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.533658 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m14:10:17.545117 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.557154 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.559113 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m14:10:17.560059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:17.580993 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:10:17.582609 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.583695 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m14:10:17.895283 [debug] [Thread-1 (]: SQL status: OK in 0.310 seconds
[0m14:10:17.905125 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.906445 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m14:10:17.908314 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:17.914587 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.915903 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m14:10:17.917998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:17.921305 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m14:10:17.922850 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.924045 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m14:10:17.930099 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:10:17.936480 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:10:17.938097 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m14:10:17.941691 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:10:17.945139 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m14:10:17.971137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67cbe6e0>]}
[0m14:10:17.973070 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.46s]
[0m14:10:17.975012 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m14:10:17.976932 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m14:10:17.978271 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m14:10:17.979637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m14:10:17.980919 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m14:10:17.992271 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.000210 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m14:10:18.009943 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.018737 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.021011 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m14:10:18.022677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:18.047057 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:10:18.048828 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.050035 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m14:10:18.329436 [debug] [Thread-1 (]: SQL status: OK in 0.278 seconds
[0m14:10:18.337810 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.338962 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m14:10:18.340404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:10:18.345616 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.346750 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m14:10:18.348443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:18.350828 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m14:10:18.351888 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.353380 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m14:10:18.370191 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:10:18.376879 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:10:18.377918 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m14:10:18.380938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:18.383889 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m14:10:18.403450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5d5dbcd0>]}
[0m14:10:18.405647 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.42s]
[0m14:10:18.407884 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m14:10:18.410758 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m14:10:18.412265 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m14:10:18.413734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m14:10:18.415033 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m14:10:18.430822 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.443024 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m14:10:18.453192 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.464319 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.465677 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m14:10:18.466742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:18.490358 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:10:18.492247 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.493333 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m14:10:18.779331 [debug] [Thread-1 (]: SQL status: OK in 0.285 seconds
[0m14:10:18.784959 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.786060 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m14:10:18.787710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:18.793774 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.794672 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m14:10:18.796065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:10:18.798103 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m14:10:18.799200 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.800273 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m14:10:18.807698 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:10:18.814710 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:10:18.816544 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m14:10:18.820183 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:18.823316 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m14:10:18.851309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff67cbfbb0>]}
[0m14:10:18.853412 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.44s]
[0m14:10:18.855017 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m14:10:18.857187 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m14:10:18.858681 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m14:10:18.860029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m14:10:18.861033 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m14:10:18.875235 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m14:10:18.883139 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m14:10:18.893078 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m14:10:18.900373 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:10:18.901847 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m14:10:18.903267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:18.930503 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m14:10:18.932252 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:10:18.933381 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m14:10:19.221406 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m14:10:19.230011 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:10:19.231366 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m14:10:19.232953 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:19.239272 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:10:19.240473 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m14:10:19.242186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:19.244390 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m14:10:19.245240 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:10:19.246157 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m14:10:19.263134 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:10:19.268231 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:10:19.269612 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m14:10:19.272568 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:19.275262 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m14:10:19.298648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5fc94220>]}
[0m14:10:19.300972 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.44s]
[0m14:10:19.303933 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m14:10:19.306556 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m14:10:19.308167 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m14:10:19.309791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m14:10:19.310989 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m14:10:19.328191 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m14:10:19.341368 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m14:10:19.447642 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m14:10:19.455648 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:10:19.456796 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m14:10:19.457559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:19.477749 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m14:10:19.479294 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:10:19.480286 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m14:10:20.507180 [debug] [Thread-1 (]: SQL status: OK in 1.026 seconds
[0m14:10:20.513014 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:10:20.514295 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m14:10:20.515761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:20.522174 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:10:20.523251 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m14:10:20.524738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:20.527099 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m14:10:20.527984 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:10:20.528923 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m14:10:20.594240 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m14:10:20.601457 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:10:20.602774 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m14:10:20.606145 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:20.608687 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m14:10:20.699276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8558943f-e623-43a7-aeee-726171457f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5d257820>]}
[0m14:10:20.702146 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.39s]
[0m14:10:20.704344 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m14:10:20.707294 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:20.708508 [debug] [MainThread]: On master: BEGIN
[0m14:10:20.709442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:20.736574 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m14:10:20.738138 [debug] [MainThread]: On master: COMMIT
[0m14:10:20.739352 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:20.740592 [debug] [MainThread]: On master: COMMIT
[0m14:10:20.742916 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:10:20.744289 [debug] [MainThread]: On master: Close
[0m14:10:20.752604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:20.754231 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m14:10:20.755319 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m14:10:20.756409 [info ] [MainThread]: 
[0m14:10:20.757509 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m14:10:20.760899 [debug] [MainThread]: Command end result
[0m14:10:20.868775 [info ] [MainThread]: 
[0m14:10:20.870074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:20.871296 [info ] [MainThread]: 
[0m14:10:20.872462 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:10:20.874792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.823495, "process_user_time": 7.527561, "process_kernel_time": 0.714514, "process_mem_max_rss": "239352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:20.876350 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:20.876170 after 10.83 seconds
[0m14:10:20.877464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6c9ecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6c24df00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6c7a1ea0>]}
[0m14:10:20.878553 [debug] [MainThread]: Flushing usage events
[0m14:10:23.831782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25f338b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25d7e9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25d7e96f0>]}


============================== 14:10:23.836672 | 3fcc6f00-63b4-4e94-9382-640bb1f66382 ==============================
[0m14:10:23.836672 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:10:23.838194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:24.152690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fcc6f00-63b4-4e94-9382-640bb1f66382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25f1cdf90>]}
[0m14:10:24.252220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fcc6f00-63b4-4e94-9382-640bb1f66382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd252729c00>]}
[0m14:10:24.254016 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:10:24.335158 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m14:10:26.479321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:10:26.480409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:10:26.491696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:10:26.547206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fcc6f00-63b4-4e94-9382-640bb1f66382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2521f4f10>]}
[0m14:10:26.745095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fcc6f00-63b4-4e94-9382-640bb1f66382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2523a16f0>]}
[0m14:10:26.746393 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:10:26.747626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcc6f00-63b4-4e94-9382-640bb1f66382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2523dcc40>]}
[0m14:10:26.751768 [info ] [MainThread]: 
[0m14:10:26.755386 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:26.772113 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m14:10:26.910329 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:10:26.912223 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m14:10:26.913555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:26.935383 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:10:26.937296 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:10:26.938173 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m14:10:26.959473 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m14:10:26.968187 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m14:10:26.970231 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m14:10:26.971198 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m14:10:26.983052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fcc6f00-63b4-4e94-9382-640bb1f66382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2523b5060>]}
[0m14:10:26.984536 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:26.985379 [debug] [MainThread]: On master: BEGIN
[0m14:10:26.986220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:27.007003 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m14:10:27.008033 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.008926 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:27.009745 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.010789 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:10:27.011566 [debug] [MainThread]: On master: Close
[0m14:10:27.015807 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m14:10:27.017255 [info ] [MainThread]: 
[0m14:10:27.022434 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:10:27.023666 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m14:10:27.025380 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m14:10:27.026497 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:10:27.070751 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:10:27.079813 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:10:27.109813 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:10:27.120300 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:10:27.121638 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m14:10:27.122665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:27.143733 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:10:27.144879 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:10:27.145802 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:10:27.147658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:27.153974 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m14:10:27.155410 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m14:10:27.156237 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m14:10:27.160080 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.14s]
[0m14:10:27.161839 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:10:27.163074 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:10:27.164139 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m14:10:27.165667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m14:10:27.166991 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:10:27.177777 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:10:27.188973 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:10:27.195688 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:10:27.205723 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:10:27.207083 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m14:10:27.208253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:27.233209 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:10:27.235598 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:10:27.236923 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:10:27.239811 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:10:27.243177 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m14:10:27.244348 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m14:10:27.245319 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m14:10:27.252523 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m14:10:27.254713 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:10:27.256012 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:10:27.257106 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m14:10:27.258506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m14:10:27.259509 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:10:27.274205 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:10:27.284699 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:10:27.294622 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:10:27.305877 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:10:27.307397 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m14:10:27.308454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:27.333534 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:10:27.335708 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:10:27.336925 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m14:10:27.339065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:27.342264 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m14:10:27.343374 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m14:10:27.344270 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m14:10:27.352081 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.09s]
[0m14:10:27.354447 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:10:27.356405 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:10:27.357585 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m14:10:27.359052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m14:10:27.360180 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:10:27.369996 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:10:27.379629 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:10:27.388309 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:10:27.397855 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:10:27.399970 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m14:10:27.401374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:27.426769 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:10:27.429071 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:10:27.429949 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m14:10:27.431965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:10:27.435944 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m14:10:27.437611 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m14:10:27.438595 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m14:10:27.446260 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m14:10:27.448195 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:10:27.450133 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:10:27.451885 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m14:10:27.453395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m14:10:27.454457 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:10:27.466445 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:10:27.475792 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:10:27.483737 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:10:27.493846 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:10:27.495084 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m14:10:27.496097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:27.521453 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:10:27.523281 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:10:27.524542 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:10:27.557690 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m14:10:27.562181 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m14:10:27.563895 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m14:10:27.565198 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m14:10:27.574974 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.12s]
[0m14:10:27.577029 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:10:27.580212 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:27.581159 [debug] [MainThread]: On master: BEGIN
[0m14:10:27.582139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:27.602779 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m14:10:27.604429 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.605358 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:27.606121 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.607305 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:10:27.608107 [debug] [MainThread]: On master: Close
[0m14:10:27.613235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:27.614214 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m14:10:27.615530 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m14:10:27.617552 [info ] [MainThread]: 
[0m14:10:27.618868 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m14:10:27.621532 [debug] [MainThread]: Command end result
[0m14:10:27.730829 [info ] [MainThread]: 
[0m14:10:27.732663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:27.734086 [info ] [MainThread]: 
[0m14:10:27.735323 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:10:27.737267 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.0004454, "process_user_time": 3.129483, "process_kernel_time": 0.421842, "process_mem_max_rss": "194180", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:27.738531 [debug] [MainThread]: Command `dbt test` succeeded at 14:10:27.738394 after 4.00 seconds
[0m14:10:27.739549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25f338b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25eb93280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25dfcf6a0>]}
[0m14:10:27.740430 [debug] [MainThread]: Flushing usage events
[0m14:10:30.572977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18c5c0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18aa47bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18aa47c10>]}


============================== 14:10:30.578087 | f02d8fab-9f6e-4bd4-826d-49e41485be31 ==============================
[0m14:10:30.578087 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:10:30.580382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:30.911662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f02d8fab-9f6e-4bd4-826d-49e41485be31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17f9185b0>]}
[0m14:10:31.017942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f02d8fab-9f6e-4bd4-826d-49e41485be31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18ac39990>]}
[0m14:10:31.019679 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:10:31.098479 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m14:10:31.266642 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:10:31.268242 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m14:10:31.269459 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:10:31.272075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f02d8fab-9f6e-4bd4-826d-49e41485be31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18b671720>]}
[0m14:10:36.166298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:10:36.179316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f02d8fab-9f6e-4bd4-826d-49e41485be31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17f7e4730>]}
[0m14:10:36.379819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f02d8fab-9f6e-4bd4-826d-49e41485be31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17f502560>]}
[0m14:10:36.381816 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:10:36.383245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f02d8fab-9f6e-4bd4-826d-49e41485be31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17f50fa90>]}
[0m14:10:36.385063 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m14:10:36.385943 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:10:36.386695 [debug] [MainThread]: On macro_publish: BEGIN
[0m14:10:36.387545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:36.415123 [debug] [MainThread]: SQL status: OK in 0.027 seconds
[0m14:10:36.418078 [debug] [MainThread]: On macro_publish: COMMIT
[0m14:10:36.420173 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:10:36.421211 [debug] [MainThread]: On macro_publish: COMMIT
[0m14:10:36.423600 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:10:36.436433 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m14:10:36.484611 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:10:36.486152 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m14:10:36.489044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:10:36.491920 [info ] [MainThread]: Schema dbt_green created or already exists
[0m14:10:36.493872 [info ] [MainThread]: Merging into green environment...
[0m14:10:36.496055 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:10:36.501319 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m14:10:36.760104 [debug] [MainThread]: SQL status: OK in 0.252 seconds
[0m14:10:36.763127 [info ] [MainThread]: Merge into green environment done
[0m14:10:36.766402 [debug] [MainThread]: On macro_publish: Close
[0m14:10:36.925100 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.450872, "process_user_time": 5.375109, "process_kernel_time": 0.323314, "process_mem_max_rss": "211676", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:36.926195 [debug] [MainThread]: Command `dbt run-operation` succeeded at 14:10:36.926074 after 6.45 seconds
[0m14:10:36.927064 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m14:10:36.927943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18c5c0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17f528ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17f52bc40>]}
[0m14:10:36.928740 [debug] [MainThread]: Flushing usage events
[0m14:14:03.947452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a8db0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a7291720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a72916c0>]}


============================== 14:14:03.952833 | 81e6b276-8ea0-46b8-bc45-ea4e0bc6c469 ==============================
[0m14:14:03.952833 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:14:03.957236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/etl_project/taxis_chicago/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:04.273582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09c10fd30>]}
[0m14:14:04.377952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09c14d990>]}
[0m14:14:04.381877 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:14:04.461076 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m14:14:04.614138 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:04.615819 [debug] [MainThread]: previous checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, current checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8
[0m14:14:04.616800 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:14:04.617846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a7ea0760>]}
[0m14:14:09.431109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:14:09.447184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09bde5450>]}
[0m14:14:09.623897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09bd27fa0>]}
[0m14:14:09.625202 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:14:09.626291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09bd25e70>]}
[0m14:14:09.629283 [info ] [MainThread]: 
[0m14:14:09.630596 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:14:09.639226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:14:09.692838 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:14:09.694056 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:14:09.694858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:09.720154 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:14:09.724486 [debug] [ThreadPool]: On list_dev: Close
[0m14:14:09.733138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_dbt_blue)
[0m14:14:09.734651 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "dbt_blue"
"
[0m14:14:09.748714 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:14:09.750184 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m14:14:09.751193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:09.771475 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m14:14:09.774773 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:14:09.775948 [debug] [ThreadPool]: On create_dev_dbt_blue: BEGIN
[0m14:14:09.777978 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:09.778782 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:14:09.779504 [debug] [ThreadPool]: On create_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "create_dev_dbt_blue"} */

    
    
        create schema if not exists "dev"."dbt_blue"
    
[0m14:14:09.780999 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:09.782493 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m14:14:09.783251 [debug] [ThreadPool]: Using duckdb connection "create_dev_dbt_blue"
[0m14:14:09.784018 [debug] [ThreadPool]: On create_dev_dbt_blue: COMMIT
[0m14:14:09.785363 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:14:09.786138 [debug] [ThreadPool]: On create_dev_dbt_blue: Close
[0m14:14:09.793698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_dbt_blue, now list_dev_dbt_blue)
[0m14:14:09.805205 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:14:09.806468 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m14:14:09.807376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:09.827894 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m14:14:09.829308 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:14:09.830330 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m14:14:09.853498 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:14:09.860174 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m14:14:09.861388 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m14:14:09.862346 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m14:14:09.871881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09bf0bc40>]}
[0m14:14:09.873753 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:09.874808 [debug] [MainThread]: On master: BEGIN
[0m14:14:09.875616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:09.895715 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m14:14:09.896754 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.897608 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:09.898388 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.899430 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:09.900206 [debug] [MainThread]: On master: Close
[0m14:14:09.904587 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m14:14:09.905904 [info ] [MainThread]: 
[0m14:14:09.911164 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_community_areas
[0m14:14:09.912615 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_blue.dim_community_areas ...................... [RUN]
[0m14:14:09.914178 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.taxis_chicago.dim_community_areas'
[0m14:14:09.915053 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_community_areas
[0m14:14:09.930389 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_community_areas"
[0m14:14:09.942460 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_community_areas
[0m14:14:10.000873 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_community_areas"
[0m14:14:10.009689 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:14:10.011085 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: BEGIN
[0m14:14:10.012122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:10.033400 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:14:10.034860 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:14:10.036179 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_community_areas__dbt_tmp"
  
    as (
      

WITH CommAreas AS (
    SELECT *
FROM read_csv('./data/bronze/chicago_city/community_area/CommAreas.csv'))

SELECT 
    AREA_NUMBE as comm_area_id,
    COMMUNITY as comm_area_name,
    SHAPE_AREA as comm_area_shape,
    SHAPE_LEN as comm_area_len,
    the_geom as comm_area_geometry

FROM CommAreas
    );
  
  
[0m14:14:10.088822 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m14:14:10.101992 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:14:10.103532 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas" rename to "dim_community_areas__dbt_backup"
[0m14:14:10.105670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:10.112043 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:14:10.113434 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
alter table "dev"."dbt_blue"."dim_community_areas__dbt_tmp" rename to "dim_community_areas"
[0m14:14:10.115037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:14:10.142334 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m14:14:10.146787 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:14:10.148598 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: COMMIT
[0m14:14:10.168730 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m14:14:10.177147 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_community_areas"
[0m14:14:10.178787 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_community_areas"} */
drop table if exists "dev"."dbt_blue"."dim_community_areas__dbt_backup" cascade
[0m14:14:10.182332 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:14:10.185518 [debug] [Thread-1 (]: On model.taxis_chicago.dim_community_areas: Close
[0m14:14:10.228552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc099af8d00>]}
[0m14:14:10.230910 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_blue.dim_community_areas ................. [[32mOK[0m in 0.31s]
[0m14:14:10.232726 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_community_areas
[0m14:14:10.233839 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_date
[0m14:14:10.234904 [info ] [Thread-1 (]: 2 of 9 START sql table model dbt_blue.dim_date ................................. [RUN]
[0m14:14:10.236409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_community_areas, now model.taxis_chicago.dim_date)
[0m14:14:10.237550 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_date
[0m14:14:10.242598 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_date"
[0m14:14:10.249324 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_date
[0m14:14:10.257821 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_date"
[0m14:14:10.266144 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:14:10.267281 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: BEGIN
[0m14:14:10.268189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:10.295984 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m14:14:10.297312 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:14:10.298296 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_date__dbt_tmp"
  
    as (
      

WITH generate_date AS (
    SELECT CAST(RANGE AS DATE) AS date_key
    FROM RANGE (DATE '2023-01-01', DATE '2024-12-31', INTERVAL 1 DAY)
)

SELECT date_key AS ID,
    DAYOFYEAR(date_key) AS day_of_year,
    YEARWEEK(date_key) AS week_key,
    WEEKOFYEAR(date_key) AS week_of_year,
    DAYOFWEEK(date_key) AS day_of_week,
    ISODOW(date_key) AS iso_day_of_week,
    DAYNAME(date_key) AS day_name,
    DATE_TRUNC('week', date_key) + 6 AS last_day_of_week,
    YEAR(date_key) || RIGHT('0' || MONTH(date_key), 2) AS month_key,
    MONTH(date_key) AS month_of_year,
    DAYOFMONTH(date_key) AS day_of_month,
    LEFT(MONTHNAME(date_key), 3) AS month_name_short,
    MONTHNAME(date_key) AS month_name,
    DATE_TRUNC('month', date_key) AS first_day_of_month,
    LAST_DAY(date_key) AS last_day_of_month,
    CAST(YEAR(date_key) || QUARTER(date_key) AS INT) AS quarter_key,
    QUARTER(date_key) AS quarter_of_year,
    CAST(date_key - DATE_TRUNC('quarter', date_key) + 1 AS INT) AS day_of_quarter,
    ('Q' || QUARTER(date_key)) AS quarter_desc_short,
    ('Q' || QUARTER(date_key)) AS quarter_desc,
    DATE_TRUNC('quarter', date_key) AS first_day_of_quarter,
    DATE_TRUNC('year', date_key) + INTERVAL 2 YEAR AS last_day_of_quarter,
    CAST(YEAR(date_key) AS INT) AS year,
    CAST(date_key - DATE_TRUNC('year', date_key) + 1 AS INT) AS day_of_year,
    DATE_TRUNC('year', date_key) + INTERVAL 1 YEAR AS first_day_of_year,
    ROW_NUMBER() OVER (PARTITION BY YEAR(date_key), MONTH(date_key), DAYOFWEEK(date_key) ORDER BY date_key) AS ordinal_weekday_of_month
FROM generate_date
    );
  
  
[0m14:14:10.348015 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m14:14:10.355940 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:14:10.357011 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date" rename to "dim_date__dbt_backup"
[0m14:14:10.358908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:10.364696 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:14:10.366084 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
alter table "dev"."dbt_blue"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:14:10.367425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:14:10.369699 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m14:14:10.370575 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:14:10.371383 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: COMMIT
[0m14:14:10.378022 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:14:10.383333 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_date"
[0m14:14:10.384346 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_date"} */
drop table if exists "dev"."dbt_blue"."dim_date__dbt_backup" cascade
[0m14:14:10.387356 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:10.389490 [debug] [Thread-1 (]: On model.taxis_chicago.dim_date: Close
[0m14:14:10.448149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc099c8f940>]}
[0m14:14:10.450623 [info ] [Thread-1 (]: 2 of 9 OK created sql table model dbt_blue.dim_date ............................ [[32mOK[0m in 0.21s]
[0m14:14:10.453102 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_date
[0m14:14:10.454519 [debug] [Thread-1 (]: Began running node model.taxis_chicago.dim_time
[0m14:14:10.455960 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_blue.dim_time ................................. [RUN]
[0m14:14:10.457898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_date, now model.taxis_chicago.dim_time)
[0m14:14:10.459180 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.dim_time
[0m14:14:10.466679 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.dim_time"
[0m14:14:10.475089 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.dim_time
[0m14:14:10.485033 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.dim_time"
[0m14:14:10.493846 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:14:10.495312 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: BEGIN
[0m14:14:10.496962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:10.518484 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:14:10.520221 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:14:10.522269 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */

  
    
    

    create  table
      "dev"."dbt_blue"."dim_time__dbt_tmp"
  
    as (
      

WITH TimeSeries AS (
    SELECT 
        r.datetime_value::TIME AS ID,
        EXTRACT(HOUR FROM r.datetime_value) AS hour,
        EXTRACT(MINUTE FROM r.datetime_value) AS minute,
        EXTRACT(SECOND FROM r.datetime_value) AS second,
        CASE
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 6 THEN 'Night'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 12 THEN 'Morning'
            WHEN EXTRACT(HOUR FROM r.datetime_value) < 18 THEN 'Afternoon'
            ELSE 'Evening'
        END AS part_of_day
    FROM range(TIMESTAMP '2024-01-01 00:00:00', TIMESTAMP '2024-01-01 23:59:59', INTERVAL 1 SECOND) AS r(datetime_value)
)

SELECT * FROM TimeSeries
    );
  
  
[0m14:14:10.539167 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:14:10.545702 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:14:10.546945 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time" rename to "dim_time__dbt_backup"
[0m14:14:10.548541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:10.554663 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:14:10.555864 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
alter table "dev"."dbt_blue"."dim_time__dbt_tmp" rename to "dim_time"
[0m14:14:10.557862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:10.560650 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m14:14:10.561555 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:14:10.562540 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: COMMIT
[0m14:14:10.614962 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m14:14:10.622664 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.dim_time"
[0m14:14:10.623885 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.dim_time"} */
drop table if exists "dev"."dbt_blue"."dim_time__dbt_backup" cascade
[0m14:14:10.628827 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:14:10.631539 [debug] [Thread-1 (]: On model.taxis_chicago.dim_time: Close
[0m14:14:10.671827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc099cb4610>]}
[0m14:14:10.673788 [info ] [Thread-1 (]: 3 of 9 OK created sql table model dbt_blue.dim_time ............................ [[32mOK[0m in 0.21s]
[0m14:14:10.675362 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.dim_time
[0m14:14:10.676662 [debug] [Thread-1 (]: Began running node model.taxis_chicago.load_taxi_trips
[0m14:14:10.677978 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_blue.load_taxi_trips ........................... [RUN]
[0m14:14:10.679548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.dim_time, now model.taxis_chicago.load_taxi_trips)
[0m14:14:10.680547 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.load_taxi_trips
[0m14:14:10.687830 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.load_taxi_trips"
[0m14:14:10.696545 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.load_taxi_trips
[0m14:14:10.735525 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.load_taxi_trips"
[0m14:14:10.745922 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:14:10.747257 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: BEGIN
[0m14:14:10.748394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:10.770801 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m14:14:10.772267 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:14:10.773269 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */

  
  create view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" as (
    

WITH all_files AS (
    SELECT *
    FROM read_csv_auto('data/bronze/chicago_taxi/taxi_trips/**/*.csv')
)

SELECT
    trip_id,
    taxi_id,
    trip_start_timestamp,
    trip_end_timestamp,
    trip_seconds,
    trip_miles,
    pickup_census_tract,
    dropoff_census_tract,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total,
    payment_type,
    company,
    pickup_centroid_latitude,
    pickup_centroid_longitude,
    pickup_centroid_location,
    dropoff_centroid_latitude,
    dropoff_centroid_longitude,
    dropoff_centroid_location
FROM 
all_files
  );

[0m14:14:11.035244 [debug] [Thread-1 (]: SQL status: OK in 0.261 seconds
[0m14:14:11.041333 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:14:11.042691 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips" rename to "load_taxi_trips__dbt_backup"
[0m14:14:11.044388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:11.049861 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:14:11.050955 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
alter view "dev"."dbt_blue"."load_taxi_trips__dbt_tmp" rename to "load_taxi_trips"
[0m14:14:11.052317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:11.054705 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m14:14:11.056059 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:14:11.056945 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: COMMIT
[0m14:14:11.062520 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:14:11.068129 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.load_taxi_trips"
[0m14:14:11.069072 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.load_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."load_taxi_trips__dbt_backup" cascade
[0m14:14:11.073250 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:14:11.076702 [debug] [Thread-1 (]: On model.taxis_chicago.load_taxi_trips: Close
[0m14:14:11.096328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a7ea1210>]}
[0m14:14:11.097882 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_blue.load_taxi_trips ...................... [[32mOK[0m in 0.42s]
[0m14:14:11.099075 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.load_taxi_trips
[0m14:14:11.100981 [debug] [Thread-1 (]: Began running node model.taxis_chicago.stg_taxi_trips
[0m14:14:11.102120 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_blue.stg_taxi_trips ............................ [RUN]
[0m14:14:11.103463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.load_taxi_trips, now model.taxis_chicago.stg_taxi_trips)
[0m14:14:11.104461 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.stg_taxi_trips
[0m14:14:11.111375 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.118732 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.stg_taxi_trips
[0m14:14:11.128818 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.140229 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.142043 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: BEGIN
[0m14:14:11.143070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:11.165696 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m14:14:11.167591 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.168785 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */

  
  create view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" as (
    

select
    cast(trip_id as VARCHAR) as trip_id,
    cast(taxi_id as VARCHAR) as taxi_id,
    cast(trip_start_timestamp as TIMESTAMP) as start_timestamp,
    cast(trip_end_timestamp as TIMESTAMP) as end_timestamp,
    cast(trip_seconds as DOUBLE) as trip_seconds,
    cast(trip_miles as DOUBLE) as trip_miles,
    cast(pickup_community_area as INT) as pickup_community_area,
    cast(dropoff_community_area as INT) as dropoff_community_area,
    cast(fare as DOUBLE) as fare,
    cast(tips as DOUBLE) as tips,
    cast(tolls as DOUBLE) as tolls,
    cast(extras as DOUBLE) as extras,
    cast(trip_total as DOUBLE) as trip_total_amount,
    cast(payment_type as VARCHAR) as payment_type,
    cast(company as VARCHAR) as company,
    cast(pickup_centroid_latitude as DOUBLE) as pickup_centroid_latitude,
    cast(pickup_centroid_longitude as DOUBLE) as pickup_centroid_longitude,
    cast(dropoff_centroid_latitude as DOUBLE) as dropoff_centroid_latitude,
    cast(dropoff_centroid_longitude as DOUBLE) as dropoff_centroid_longitude
from "dev"."dbt_blue"."load_taxi_trips"
  );

[0m14:14:11.422913 [debug] [Thread-1 (]: SQL status: OK in 0.252 seconds
[0m14:14:11.430927 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.432217 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips" rename to "stg_taxi_trips__dbt_backup"
[0m14:14:11.434244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:11.441907 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.444377 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
alter view "dev"."dbt_blue"."stg_taxi_trips__dbt_tmp" rename to "stg_taxi_trips"
[0m14:14:11.446232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:11.448804 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m14:14:11.449670 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.450468 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: COMMIT
[0m14:14:11.466478 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:14:11.477735 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.stg_taxi_trips"
[0m14:14:11.479836 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.stg_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."stg_taxi_trips__dbt_backup" cascade
[0m14:14:11.484285 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:14:11.487809 [debug] [Thread-1 (]: On model.taxis_chicago.stg_taxi_trips: Close
[0m14:14:11.506877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09c04e800>]}
[0m14:14:11.508472 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_blue.stg_taxi_trips ....................... [[32mOK[0m in 0.40s]
[0m14:14:11.509751 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.stg_taxi_trips
[0m14:14:11.511405 [debug] [Thread-1 (]: Began running node model.taxis_chicago.cleaned_taxi_trips
[0m14:14:11.512529 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_blue.cleaned_taxi_trips ........................ [RUN]
[0m14:14:11.513675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.stg_taxi_trips, now model.taxis_chicago.cleaned_taxi_trips)
[0m14:14:11.514516 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.cleaned_taxi_trips
[0m14:14:11.522239 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.531124 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.cleaned_taxi_trips
[0m14:14:11.541395 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.549366 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.550374 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: BEGIN
[0m14:14:11.551224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:11.576428 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:14:11.578145 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.579091 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */

  
  create view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    trip_seconds,
    trip_miles,
    coalesce(pickup_community_area, 0) as pickup_community_area,
    coalesce(dropoff_community_area, 0) as dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount,
    coalesce(payment_type, 'Unknown') as payment_type,
    coalesce(company, 'Unknown') as company,
    coalesce(pickup_centroid_latitude, 0.0) as start_lat,
    coalesce(pickup_centroid_longitude, 0.0) as start_lng,
    coalesce(dropoff_centroid_latitude, 0.0) as end_lat,
    coalesce(dropoff_centroid_longitude, 0.0) as end_lng,
from "dev"."dbt_blue"."stg_taxi_trips"
  );

[0m14:14:11.868526 [debug] [Thread-1 (]: SQL status: OK in 0.288 seconds
[0m14:14:11.875606 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.876798 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips" rename to "cleaned_taxi_trips__dbt_backup"
[0m14:14:11.878500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:11.884484 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.887812 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
alter view "dev"."dbt_blue"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m14:14:11.890071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:11.892503 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m14:14:11.893360 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.894181 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: COMMIT
[0m14:14:11.910734 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:14:11.918556 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.cleaned_taxi_trips"
[0m14:14:11.920198 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.cleaned_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."cleaned_taxi_trips__dbt_backup" cascade
[0m14:14:11.924591 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:14:11.928050 [debug] [Thread-1 (]: On model.taxis_chicago.cleaned_taxi_trips: Close
[0m14:14:11.950611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09c04c040>]}
[0m14:14:11.953370 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_blue.cleaned_taxi_trips ................... [[32mOK[0m in 0.44s]
[0m14:14:11.956147 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.cleaned_taxi_trips
[0m14:14:11.959182 [debug] [Thread-1 (]: Began running node model.taxis_chicago.enriched_taxi_trips
[0m14:14:11.960565 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_blue.enriched_taxi_trips ....................... [RUN]
[0m14:14:11.962132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.cleaned_taxi_trips, now model.taxis_chicago.enriched_taxi_trips)
[0m14:14:11.963191 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.enriched_taxi_trips
[0m14:14:11.978056 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:11.985754 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.enriched_taxi_trips
[0m14:14:11.995465 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.008820 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.010483 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: BEGIN
[0m14:14:12.011743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:12.033581 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m14:14:12.035209 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.036671 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */

  
  create view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    start_timestamp::date as trip_start_date,
    start_timestamp::time as trip_start_time,
    end_timestamp,
    end_timestamp::date as trip_end_date,
    end_timestamp::time as trip_end_time,
    trip_seconds,
    trip_miles as trip_distance_miles,
    trip_distance_miles * 1.60934 AS trip_distance_km,
    pickup_community_area,
    dropoff_community_area,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount as trip_total_amount_dolar,
    trip_total_amount_dolar * 0.85 AS trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."cleaned_taxi_trips"
  );

[0m14:14:12.299608 [debug] [Thread-1 (]: SQL status: OK in 0.261 seconds
[0m14:14:12.308934 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.310260 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips" rename to "enriched_taxi_trips__dbt_backup"
[0m14:14:12.311602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:14:12.316496 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.317425 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
alter view "dev"."dbt_blue"."enriched_taxi_trips__dbt_tmp" rename to "enriched_taxi_trips"
[0m14:14:12.318812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:14:12.321482 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m14:14:12.323435 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.324441 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: COMMIT
[0m14:14:12.340253 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m14:14:12.345327 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.enriched_taxi_trips"
[0m14:14:12.346290 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.enriched_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."enriched_taxi_trips__dbt_backup" cascade
[0m14:14:12.349301 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:12.351882 [debug] [Thread-1 (]: On model.taxis_chicago.enriched_taxi_trips: Close
[0m14:14:12.374934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09bfd5120>]}
[0m14:14:12.376332 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_blue.enriched_taxi_trips .................. [[32mOK[0m in 0.41s]
[0m14:14:12.377998 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.enriched_taxi_trips
[0m14:14:12.380018 [debug] [Thread-1 (]: Began running node model.taxis_chicago.structural_taxi_trips
[0m14:14:12.381400 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_blue.structural_taxi_trips ..................... [RUN]
[0m14:14:12.382723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.enriched_taxi_trips, now model.taxis_chicago.structural_taxi_trips)
[0m14:14:12.383979 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.structural_taxi_trips
[0m14:14:12.402503 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.413257 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.structural_taxi_trips
[0m14:14:12.422294 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.439708 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.442191 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: BEGIN
[0m14:14:12.443145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:12.467040 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:14:12.469040 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.477207 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */

  
  create view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" as (
    

select
    trip_id,
    taxi_id,
    start_timestamp,
    end_timestamp,
    pickup_community_area as pickup_area_id,
    dropoff_community_area as dropoff_area_id,
    trip_start_date,
    trip_start_time,
    trip_end_date,
    trip_end_time,
    trip_seconds,
    trip_distance_miles,
    trip_distance_km,
    fare,
    tips,
    tolls,
    extras,
    trip_total_amount_dolar,
    trip_total_amount_eur,
    payment_type,
    company,
    start_lat,
    start_lng,
    end_lat,
    end_lng,
from "dev"."dbt_blue"."enriched_taxi_trips"
  );

[0m14:14:12.734683 [debug] [Thread-1 (]: SQL status: OK in 0.255 seconds
[0m14:14:12.746057 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.747593 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips" rename to "structural_taxi_trips__dbt_backup"
[0m14:14:12.749795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:12.757182 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.758934 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
alter view "dev"."dbt_blue"."structural_taxi_trips__dbt_tmp" rename to "structural_taxi_trips"
[0m14:14:12.760981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:12.763548 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m14:14:12.764479 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.765362 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: COMMIT
[0m14:14:12.782127 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:14:12.787442 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.structural_taxi_trips"
[0m14:14:12.789624 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.structural_taxi_trips"} */
drop view if exists "dev"."dbt_blue"."structural_taxi_trips__dbt_backup" cascade
[0m14:14:12.793224 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:12.796259 [debug] [Thread-1 (]: On model.taxis_chicago.structural_taxi_trips: Close
[0m14:14:12.819578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc09beff700>]}
[0m14:14:12.822179 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_blue.structural_taxi_trips ................ [[32mOK[0m in 0.44s]
[0m14:14:12.823837 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.structural_taxi_trips
[0m14:14:12.826172 [debug] [Thread-1 (]: Began running node model.taxis_chicago.fact_taxi_trips
[0m14:14:12.827658 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_blue.fact_taxi_trips .......................... [RUN]
[0m14:14:12.829030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxis_chicago.structural_taxi_trips, now model.taxis_chicago.fact_taxi_trips)
[0m14:14:12.829899 [debug] [Thread-1 (]: Began compiling node model.taxis_chicago.fact_taxi_trips
[0m14:14:12.837363 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxis_chicago.fact_taxi_trips"
[0m14:14:12.846053 [debug] [Thread-1 (]: Began executing node model.taxis_chicago.fact_taxi_trips
[0m14:14:12.984195 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxis_chicago.fact_taxi_trips"
[0m14:14:12.992444 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:14:12.993636 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: BEGIN
[0m14:14:12.994672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:13.015508 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:14:13.017027 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:14:13.018261 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */

  
    
    

    create  table
      "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp"
  
    as (
      

with tmp_data as (
    select *
        -- Campos de auditoria
        , NOW() audit_row_insert
        , 'dbt_demo' audit_process_id
    from "dev"."dbt_blue"."structural_taxi_trips"
)

select * from tmp_data
    );
  
  
[0m14:14:13.989826 [debug] [Thread-1 (]: SQL status: OK in 0.970 seconds
[0m14:14:13.996696 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:14:13.998062 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips" rename to "fact_taxi_trips__dbt_backup"
[0m14:14:13.999565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:14.005283 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:14:14.006584 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
alter table "dev"."dbt_blue"."fact_taxi_trips__dbt_tmp" rename to "fact_taxi_trips"
[0m14:14:14.008492 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:14.011325 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m14:14:14.012384 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:14:14.013464 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: COMMIT
[0m14:14:14.074742 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m14:14:14.081697 [debug] [Thread-1 (]: Using duckdb connection "model.taxis_chicago.fact_taxi_trips"
[0m14:14:14.082924 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "model.taxis_chicago.fact_taxi_trips"} */
drop table if exists "dev"."dbt_blue"."fact_taxi_trips__dbt_backup" cascade
[0m14:14:14.087132 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:14:14.089592 [debug] [Thread-1 (]: On model.taxis_chicago.fact_taxi_trips: Close
[0m14:14:14.176262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e6b276-8ea0-46b8-bc45-ea4e0bc6c469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0999338b0>]}
[0m14:14:14.178336 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_blue.fact_taxi_trips ..................... [[32mOK[0m in 1.35s]
[0m14:14:14.180309 [debug] [Thread-1 (]: Finished running node model.taxis_chicago.fact_taxi_trips
[0m14:14:14.183153 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:14.184042 [debug] [MainThread]: On master: BEGIN
[0m14:14:14.184914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:14.209654 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m14:14:14.211446 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.212584 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:14.213482 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.214947 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:14:14.215929 [debug] [MainThread]: On master: Close
[0m14:14:14.224927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:14.226722 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m14:14:14.227988 [debug] [MainThread]: Connection 'model.taxis_chicago.fact_taxi_trips' was properly closed.
[0m14:14:14.229723 [info ] [MainThread]: 
[0m14:14:14.230824 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m14:14:14.233805 [debug] [MainThread]: Command end result
[0m14:14:14.351124 [info ] [MainThread]: 
[0m14:14:14.353234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:14.354981 [info ] [MainThread]: 
[0m14:14:14.356501 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:14:14.358835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.509584, "process_user_time": 7.164431, "process_kernel_time": 0.711502, "process_mem_max_rss": "246680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:14.360236 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:14.360083 after 10.51 seconds
[0m14:14:14.361320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a8db0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a85e8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a7435120>]}
[0m14:14:14.362222 [debug] [MainThread]: Flushing usage events
[0m14:14:17.380935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4373dc8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4372275660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4372275600>]}


============================== 14:14:17.385379 | 29b10d47-64b9-4654-b67e-d4264318e8e5 ==============================
[0m14:14:17.385379 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:14:17.388060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/etl_project/taxis_chicago/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:17.752057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29b10d47-64b9-4654-b67e-d4264318e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4367199c00>]}
[0m14:14:17.847362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29b10d47-64b9-4654-b67e-d4264318e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43724c9c90>]}
[0m14:14:17.848986 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:14:17.934694 [debug] [MainThread]: checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a, vars: {}, profile: , target: , version: 1.8.4
[0m14:14:20.336430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:20.338003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:20.349350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:14:20.414801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b10d47-64b9-4654-b67e-d4264318e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4366bf4e20>]}
[0m14:14:20.622265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b10d47-64b9-4654-b67e-d4264318e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43670be9e0>]}
[0m14:14:20.623811 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:14:20.625121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b10d47-64b9-4654-b67e-d4264318e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4366de0e20>]}
[0m14:14:20.628380 [info ] [MainThread]: 
[0m14:14:20.629787 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:14:20.640779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_dbt_blue'
[0m14:14:20.764259 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:14:20.765734 [debug] [ThreadPool]: On list_dev_dbt_blue: BEGIN
[0m14:14:20.766741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:20.788749 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m14:14:20.790756 [debug] [ThreadPool]: Using duckdb connection "list_dev_dbt_blue"
[0m14:14:20.791651 [debug] [ThreadPool]: On list_dev_dbt_blue: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "connection_name": "list_dev_dbt_blue"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dbt_blue'
    and table_catalog = 'dev'
  
[0m14:14:20.812996 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m14:14:20.820580 [debug] [ThreadPool]: On list_dev_dbt_blue: ROLLBACK
[0m14:14:20.822288 [debug] [ThreadPool]: Failed to rollback 'list_dev_dbt_blue'
[0m14:14:20.823151 [debug] [ThreadPool]: On list_dev_dbt_blue: Close
[0m14:14:20.832687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b10d47-64b9-4654-b67e-d4264318e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4373e998a0>]}
[0m14:14:20.833864 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:20.834711 [debug] [MainThread]: On master: BEGIN
[0m14:14:20.835662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:20.857079 [debug] [MainThread]: SQL status: OK in 0.021 seconds
[0m14:14:20.858771 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.859599 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:20.860339 [debug] [MainThread]: On master: COMMIT
[0m14:14:20.861554 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:20.862502 [debug] [MainThread]: On master: Close
[0m14:14:20.868507 [info ] [MainThread]: Concurrency: 1 threads (target='blue')
[0m14:14:20.869806 [info ] [MainThread]: 
[0m14:14:20.874169 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:14:20.875145 [info ] [Thread-1 (]: 1 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [RUN]
[0m14:14:20.876327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m14:14:20.877242 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:14:20.921783 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:14:20.931290 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:14:20.966335 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:14:20.976425 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:14:20.977802 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: BEGIN
[0m14:14:20.978766 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:21.001470 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:14:21.002680 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"
[0m14:14:21.003625 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and dropoff_area_id >= 0 and dropoff_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:14:21.007804 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:14:21.016167 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: ROLLBACK
[0m14:14:21.017434 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34'
[0m14:14:21.018688 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34: Close
[0m14:14:21.026359 [info ] [Thread-1 (]: 1 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0  [[32mPASS[0m in 0.15s]
[0m14:14:21.028664 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34
[0m14:14:21.030086 [debug] [Thread-1 (]: Began running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:14:21.031126 [info ] [Thread-1 (]: 2 of 5 START test dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [RUN]
[0m14:14:21.032530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_dropoff_area_id__77__0.35279f8e34, now test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723)
[0m14:14:21.033469 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:14:21.044194 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:14:21.054806 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:14:21.061226 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:14:21.070968 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:14:21.073012 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: BEGIN
[0m14:14:21.074474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:21.100453 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:14:21.102455 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"
[0m14:14:21.103925 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and pickup_area_id >= 0 and pickup_area_id <= 77
)
 as expression


    from "dev"."dbt_blue"."fact_taxi_trips"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m14:14:21.107405 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:21.110806 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: ROLLBACK
[0m14:14:21.111937 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723'
[0m14:14:21.112843 [debug] [Thread-1 (]: On test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723: Close
[0m14:14:21.120595 [info ] [Thread-1 (]: 2 of 5 PASS dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0  [[32mPASS[0m in 0.09s]
[0m14:14:21.122616 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723
[0m14:14:21.123906 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:14:21.125137 [info ] [Thread-1 (]: 3 of 5 START test not_null_fact_taxi_trips_payment_type ........................ [RUN]
[0m14:14:21.126527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.dbt_expectations_expect_column_values_to_be_between_fact_taxi_trips_pickup_area_id__77__0.c1b60b7723, now test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7)
[0m14:14:21.127426 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:14:21.141421 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:14:21.150801 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:14:21.161005 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:14:21.172325 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:14:21.174292 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: BEGIN
[0m14:14:21.175369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:21.199585 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:14:21.201714 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"
[0m14:14:21.203319 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from "dev"."dbt_blue"."fact_taxi_trips"
where payment_type is null



      
    ) dbt_internal_test
[0m14:14:21.206931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:14:21.210452 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: ROLLBACK
[0m14:14:21.211840 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7'
[0m14:14:21.212737 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7: Close
[0m14:14:21.222214 [info ] [Thread-1 (]: 3 of 5 PASS not_null_fact_taxi_trips_payment_type .............................. [[32mPASS[0m in 0.10s]
[0m14:14:21.224110 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7
[0m14:14:21.225485 [debug] [Thread-1 (]: Began running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:14:21.226512 [info ] [Thread-1 (]: 4 of 5 START test not_null_fact_taxi_trips_taxi_id ............................. [RUN]
[0m14:14:21.228060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_payment_type.e0ef3464c7, now test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847)
[0m14:14:21.229040 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:14:21.238695 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:14:21.248232 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:14:21.255289 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:14:21.265330 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:14:21.267437 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: BEGIN
[0m14:14:21.269223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:21.295474 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:14:21.297108 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"
[0m14:14:21.298095 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taxi_id
from "dev"."dbt_blue"."fact_taxi_trips"
where taxi_id is null



      
    ) dbt_internal_test
[0m14:14:21.300083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:14:21.304713 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: ROLLBACK
[0m14:14:21.306560 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847'
[0m14:14:21.307638 [debug] [Thread-1 (]: On test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847: Close
[0m14:14:21.314008 [info ] [Thread-1 (]: 4 of 5 PASS not_null_fact_taxi_trips_taxi_id ................................... [[32mPASS[0m in 0.09s]
[0m14:14:21.315927 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847
[0m14:14:21.317214 [debug] [Thread-1 (]: Began running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:14:21.318625 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_taxi_trips_trip_id ............................... [RUN]
[0m14:14:21.322291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxis_chicago.not_null_fact_taxi_trips_taxi_id.c4905f3847, now test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad)
[0m14:14:21.323897 [debug] [Thread-1 (]: Began compiling node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:14:21.337431 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:14:21.347140 [debug] [Thread-1 (]: Began executing node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:14:21.354054 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:14:21.364854 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:14:21.366267 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: BEGIN
[0m14:14:21.367305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:21.393701 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m14:14:21.395636 [debug] [Thread-1 (]: Using duckdb connection "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"
[0m14:14:21.396720 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "blue", "node_id": "test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "dev"."dbt_blue"."fact_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:14:21.430938 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m14:14:21.435339 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: ROLLBACK
[0m14:14:21.436737 [debug] [Thread-1 (]: Failed to rollback 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad'
[0m14:14:21.437733 [debug] [Thread-1 (]: On test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad: Close
[0m14:14:21.448168 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_taxi_trips_trip_id ..................................... [[32mPASS[0m in 0.13s]
[0m14:14:21.449857 [debug] [Thread-1 (]: Finished running node test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad
[0m14:14:21.453006 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:21.454013 [debug] [MainThread]: On master: BEGIN
[0m14:14:21.454992 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:21.475147 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m14:14:21.476912 [debug] [MainThread]: On master: COMMIT
[0m14:14:21.478726 [debug] [MainThread]: Using duckdb connection "master"
[0m14:14:21.479668 [debug] [MainThread]: On master: COMMIT
[0m14:14:21.481027 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:14:21.481932 [debug] [MainThread]: On master: Close
[0m14:14:21.491769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:21.493515 [debug] [MainThread]: Connection 'list_dev_dbt_blue' was properly closed.
[0m14:14:21.494518 [debug] [MainThread]: Connection 'test.taxis_chicago.unique_fact_taxi_trips_trip_id.9bcb3949ad' was properly closed.
[0m14:14:21.495662 [info ] [MainThread]: 
[0m14:14:21.496897 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m14:14:21.499486 [debug] [MainThread]: Command end result
[0m14:14:21.615715 [info ] [MainThread]: 
[0m14:14:21.617384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:21.618962 [info ] [MainThread]: 
[0m14:14:21.620499 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:14:21.622968 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.34211, "process_user_time": 3.228454, "process_kernel_time": 0.421102, "process_mem_max_rss": "197868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:21.624456 [debug] [MainThread]: Command `dbt test` succeeded at 14:14:21.624259 after 4.34 seconds
[0m14:14:21.625461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4373dc8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4372eddf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43670bce50>]}
[0m14:14:21.626466 [debug] [MainThread]: Flushing usage events
[0m14:14:24.271413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbeed8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbd3c5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbd3c54e0>]}


============================== 14:14:24.276139 | 9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e ==============================
[0m14:14:24.276139 [info ] [MainThread]: Running with dbt=1.8.4
[0m14:14:24.277421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/etl_project/taxis_chicago/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation publish --profiles-dir . --target green', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:14:24.624769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dba186d40>]}
[0m14:14:24.721213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dba142c50>]}
[0m14:14:24.722813 [info ] [MainThread]: Registered adapter: duckdb=1.8.2
[0m14:14:24.792767 [debug] [MainThread]: checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, vars: {}, profile: , target: green, version: 1.8.4
[0m14:14:24.958894 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:24.960739 [debug] [MainThread]: previous checksum: e68177b27713edb214fe1bbf9490ee25e33487b6aba7dc6039a59000f275faa8, current checksum: 54398663eddc8e4ac172fdab397e09b2aa6984947a84e6ec7983096c3fae7b7a
[0m14:14:24.961993 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:14:24.963159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbdfd06d0>]}
[0m14:14:29.785679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxis_chicago.example
[0m14:14:29.795315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db18ed210>]}
[0m14:14:29.982364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db1807f40>]}
[0m14:14:29.983404 [info ] [MainThread]: Found 9 models, 5 data tests, 676 macros
[0m14:14:29.984482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7fbdcb-ff99-44bd-9a45-8d98089f6f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db17f96c0>]}
[0m14:14:29.985979 [debug] [MainThread]: Acquiring new duckdb connection 'macro_publish'
[0m14:14:29.987522 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:14:29.988514 [debug] [MainThread]: On macro_publish: BEGIN
[0m14:14:29.989425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:30.014645 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m14:14:30.022172 [debug] [MainThread]: On macro_publish: COMMIT
[0m14:14:30.023801 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:14:30.024711 [debug] [MainThread]: On macro_publish: COMMIT
[0m14:14:30.027007 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:14:30.039797 [info ] [MainThread]: Creating schema dbt_green if not exists...
[0m14:14:30.085095 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:14:30.086324 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE SCHEMA IF NOT EXISTS dbt_green;
    
  
[0m14:14:30.088796 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:14:30.092668 [info ] [MainThread]: Schema dbt_green created or already exists
[0m14:14:30.094115 [info ] [MainThread]: Merging into green environment...
[0m14:14:30.095925 [debug] [MainThread]: Using duckdb connection "macro_publish"
[0m14:14:30.096864 [debug] [MainThread]: On macro_publish: /* {"app": "dbt", "dbt_version": "1.8.4", "profile_name": "taxis_chicago", "target_name": "green", "connection_name": "macro_publish"} */

    
        CREATE OR REPLACE TABLE dbt_green.fact_taxi_trips AS SELECT * FROM dbt_blue.fact_taxi_trips;
        CREATE OR REPLACE TABLE dbt_green.dim_community_areas AS SELECT * FROM dbt_blue.dim_community_areas;
        CREATE OR REPLACE TABLE dbt_green.dim_date AS SELECT * FROM dbt_blue.dim_date;
        CREATE OR REPLACE TABLE dbt_green.dim_time AS SELECT * FROM dbt_blue.dim_time;
    
  
[0m14:14:30.333762 [debug] [MainThread]: SQL status: OK in 0.236 seconds
[0m14:14:30.336386 [info ] [MainThread]: Merge into green environment done
[0m14:14:30.337733 [debug] [MainThread]: On macro_publish: Close
[0m14:14:30.478348 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.299259, "process_user_time": 5.26708, "process_kernel_time": 0.343932, "process_mem_max_rss": "218296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:30.479723 [debug] [MainThread]: Command `dbt run-operation` succeeded at 14:14:30.479574 after 6.30 seconds
[0m14:14:30.480740 [debug] [MainThread]: Connection 'macro_publish' was properly closed.
[0m14:14:30.481600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbeed8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db185d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db185d2d0>]}
[0m14:14:30.482764 [debug] [MainThread]: Flushing usage events
